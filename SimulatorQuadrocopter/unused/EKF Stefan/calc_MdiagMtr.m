function E = calc_MdiagMtr(A,B,C,Sig,T,calc)
a11=A(1,1);
a12=A(1,1);
a13=A(1,1);
a21=A(2,1);
a22=A(2,2);
a23=A(2,3);
a31=A(3,1);
a32=A(3,2);
a33=A(3,3);

b11=B(1,1);
b12=B(1,1);
b13=B(1,1);
b21=B(2,1);
b22=B(2,2);
b23=B(2,3);
b31=B(3,1);
b32=B(3,2);
b33=B(3,3);

c11=C(1,1);
c12=C(1,1);
c13=C(1,1);
c21=C(2,1);
c22=C(2,2);
c23=C(2,3);
c31=C(3,1);
c32=C(3,2);
c33=C(3,3);

B11=Sig(1,1);
B22=Sig(2,2);
B33=Sig(3,3);

if calc==0
	%Maple generated code: A*(diag(sig^2))*A'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t9 = t8 * T;
	t15 = c11 * a11 + c12 * a21 + c13 * a31;
	t23 = t7 * t6 * T;
	t27 = t7 * t6;
	t30 = c11 * c11;
	t31 = t7 * T;
	t39 = c12 * b22 + c11 * b12 + c13 * b32;
	t46 = c11 * a12 + c13 * a32 + c12 * a22;
	t58 = c12 * c12;
	t66 = c12 * b23 + c11 * b13 + c13 * b33;
	t73 = c13 * a33 + c12 * a23 + c11 * a13;
	t85 = c13 * c13;
	t94 = c21 * b11 + c22 * b21 + c23 * b31;
	t102 = c21 * a11 + c22 * a21 + c23 * a31;
	t128 = c22 * b22 + c21 * b12 + c23 * b32;
	t136 = c21 * a12 + c23 * a32 + c22 * a22;
	t162 = c22 * b23 + c21 * b13 + c23 * b33;
	t170 = c23 * a33 + c22 * a23 + c21 * a13;
	t193 = B11 * (t4 * t94 * t9 / 0.5184e4 + (t15 * t94 / 0.144e3 + t4 * t102 / 0.144e3) * t8 / 0.8e1 + (-c11 * t94 / 0.48e2 + t15 * t102 / 0.36e2 - t4 * c21 / 0.48e2) * t23 / 0.7e1 + (-c11 * t102 / 0.6e1 - t15 * c21 / 0.6e1) * t27 / 0.12e2 + c11 * c21 * t31 / 0.20e2) + B22 * (t39 * t128 * t9 / 0.5184e4 + (t46 * t128 / 0.144e3 + t39 * t136 / 0.144e3) * t8 / 0.8e1 + (-c12 * t128 / 0.48e2 + t46 * t136 / 0.36e2 - t39 * c22 / 0.48e2) * t23 / 0.7e1 + (-c12 * t136 / 0.6e1 - t46 * c22 / 0.6e1) * t27 / 0.12e2 + c12 * c22 * t31 / 0.20e2) + B33 * (t66 * t162 * t9 / 0.5184e4 + (t73 * t162 / 0.144e3 + t66 * t170 / 0.144e3) * t8 / 0.8e1 + (-c13 * t162 / 0.48e2 + t73 * t170 / 0.36e2 - t66 * c23 / 0.48e2) * t23 / 0.7e1 + (-c13 * t170 / 0.6e1 - t73 * c23 / 0.6e1) * t27 / 0.12e2 + c13 * c23 * t31 / 0.20e2);
	t197 = c31 * b11 + c32 * b21 + c33 * b31;
	t205 = c31 * a11 + c32 * a21 + c33 * a31;
	t231 = c32 * b22 + c31 * b12 + c33 * b32;
	t239 = c31 * a12 + c33 * a32 + c32 * a22;
	t265 = c32 * b23 + c31 * b13 + c33 * b33;
	t273 = c33 * a33 + c32 * a23 + c31 * a13;
	t296 = B11 * (t4 * t197 * t9 / 0.5184e4 + (t15 * t197 / 0.144e3 + t4 * t205 / 0.144e3) * t8 / 0.8e1 + (-c11 * t197 / 0.48e2 + t15 * t205 / 0.36e2 - t4 * c31 / 0.48e2) * t23 / 0.7e1 + (-c11 * t205 / 0.6e1 - t15 * c31 / 0.6e1) * t27 / 0.12e2 + c11 * c31 * t31 / 0.20e2) + B22 * (t39 * t231 * t9 / 0.5184e4 + (t46 * t231 / 0.144e3 + t39 * t239 / 0.144e3) * t8 / 0.8e1 + (-c12 * t231 / 0.48e2 + t46 * t239 / 0.36e2 - t39 * c32 / 0.48e2) * t23 / 0.7e1 + (-c12 * t239 / 0.6e1 - t46 * c32 / 0.6e1) * t27 / 0.12e2 + c12 * c32 * t31 / 0.20e2) + B33 * (t66 * t265 * t9 / 0.5184e4 + (t73 * t265 / 0.144e3 + t66 * t273 / 0.144e3) * t8 / 0.8e1 + (-c13 * t265 / 0.48e2 + t73 * t273 / 0.36e2 - t66 * c33 / 0.48e2) * t23 / 0.7e1 + (-c13 * t273 / 0.6e1 - t73 * c33 / 0.6e1) * t27 / 0.12e2 + c13 * c33 * t31 / 0.20e2);
	t311 = c21 * c21;
	t330 = c22 * c22;
	t349 = c23 * c23;
	t433 = B11 * (t94 * t197 * t9 / 0.5184e4 + (t102 * t197 / 0.144e3 + t94 * t205 / 0.144e3) * t8 / 0.8e1 + (-c21 * t197 / 0.48e2 + t102 * t205 / 0.36e2 - t94 * c31 / 0.48e2) * t23 / 0.7e1 + (-c21 * t205 / 0.6e1 - t102 * c31 / 0.6e1) * t27 / 0.12e2 + c21 * c31 * t31 / 0.20e2) + B22 * (t128 * t231 * t9 / 0.5184e4 + (t136 * t231 / 0.144e3 + t128 * t239 / 0.144e3) * t8 / 0.8e1 + (-c22 * t231 / 0.48e2 + t136 * t239 / 0.36e2 - t128 * c32 / 0.48e2) * t23 / 0.7e1 + (-c22 * t239 / 0.6e1 - t136 * c32 / 0.6e1) * t27 / 0.12e2 + c22 * c32 * t31 / 0.20e2) + B33 * (t162 * t265 * t9 / 0.5184e4 + (t170 * t265 / 0.144e3 + t162 * t273 / 0.144e3) * t8 / 0.8e1 + (-c23 * t265 / 0.48e2 + t170 * t273 / 0.36e2 - t162 * c33 / 0.48e2) * t23 / 0.7e1 + (-c23 * t273 / 0.6e1 - t170 * c33 / 0.6e1) * t27 / 0.12e2 + c23 * c33 * t31 / 0.20e2);
	t448 = c31 * c31;
	t467 = c32 * c32;
	t486 = c33 * c33;
	X(1,1) = B11 * (t4 * t4 * t9 / 0.5184e4 + t15 * t4 * t8 / 0.576e3 + (-c11 * t4 / 0.24e2 + t15 * t15 / 0.36e2) * t23 / 0.7e1 - c11 * t15 * t27 / 0.36e2 + t30 * t31 / 0.20e2) + B22 * (t39 * t39 * t9 / 0.5184e4 + t46 * t39 * t8 / 0.576e3 + (-c12 * t39 / 0.24e2 + t46 * t46 / 0.36e2) * t23 / 0.7e1 - c12 * t46 * t27 / 0.36e2 + t58 * t31 / 0.20e2) + B33 * (t66 * t66 * t9 / 0.5184e4 + t73 * t66 * t8 / 0.576e3 + (-c13 * t66 / 0.24e2 + t73 * t73 / 0.36e2) * t23 / 0.7e1 - c13 * t73 * t27 / 0.36e2 + t85 * t31 / 0.20e2);
	X(2,3) = t193;
	X(1,3) = t296;
	X(2,1) = t193;
	X(2,2) = B11 * (t94 * t94 * t9 / 0.5184e4 + t102 * t94 * t8 / 0.576e3 + (-c21 * t94 / 0.24e2 + t102 * t102 / 0.36e2) * t23 / 0.7e1 - c21 * t102 * t27 / 0.36e2 + t311 * t31 / 0.20e2) + B22 * (t128 * t128 * t9 / 0.5184e4 + t136 * t128 * t8 / 0.576e3 + (-c22 * t128 / 0.24e2 + t136 * t136 / 0.36e2) * t23 / 0.7e1 - c22 * t136 * t27 / 0.36e2 + t330 * t31 / 0.20e2) + B33 * (t162 * t162 * t9 / 0.5184e4 + t170 * t162 * t8 / 0.576e3 + (-c23 * t162 / 0.24e2 + t170 * t170 / 0.36e2) * t23 / 0.7e1 - c23 * t170 * t27 / 0.36e2 + t349 * t31 / 0.20e2);
	X(2,3) = t433;
	X(3,1) = t296;
	X(3,2) = t433;
	X(3,3) = B11 * (t197 * t197 * t9 / 0.5184e4 + t205 * t197 * t8 / 0.576e3 + (-c31 * t197 / 0.24e2 + t205 * t205 / 0.36e2) * t23 / 0.7e1 - c31 * t205 * t27 / 0.36e2 + t448 * t31 / 0.20e2) + B22 * (t231 * t231 * t9 / 0.5184e4 + t239 * t231 * t8 / 0.576e3 + (-c32 * t231 / 0.24e2 + t239 * t239 / 0.36e2) * t23 / 0.7e1 - c32 * t239 * t27 / 0.36e2 + t467 * t31 / 0.20e2) + B33 * (t265 * t265 * t9 / 0.5184e4 + t273 * t265 * t8 / 0.576e3 + (-c33 * t265 / 0.24e2 + t273 * t273 / 0.36e2) * t23 / 0.7e1 - c33 * t273 * t27 / 0.36e2 + t486 * t31 / 0.20e2);

elseif calc==1
	%Maple generated code: B*(diag(sig^2))*B'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * T;
	t8 = t6 * t6;
	t9 = t8 * t8;
	t10 = t9 * t7;
	t16 = -c11 * a11 - c12 * a21 - c13 * a31;
	t18 = t9 * t6;
	t25 = t9 * T;
	t31 = c11 * c11;
	t32 = t8 * t7;
	t40 = c12 * b22 + c11 * b12 + c13 * b32;
	t47 = -c11 * a12 - c13 * a32 - c12 * a22;
	t60 = c12 * c12;
	t68 = c12 * b23 + c11 * b13 + c13 * b33;
	t75 = -c13 * a33 - c12 * a23 - c11 * a13;
	t88 = c13 * c13;
	t97 = c21 * b11 + c22 * b21 + c23 * b31;
	t105 = -c21 * a11 - c22 * a21 - c23 * a31;
	t131 = c22 * b22 + c21 * b12 + c23 * b32;
	t139 = -c21 * a12 - c23 * a32 - c22 * a22;
	t165 = c22 * b23 + c21 * b13 + c23 * b33;
	t173 = -c23 * a33 - c22 * a23 - c21 * a13;
	t196 = B11 * (t4 * t97 * t10 / 0.158400e6 + (t16 * t97 / 0.2880e4 + t4 * t105 / 0.2880e4) * t18 / 0.10e2 + (-c11 * t97 / 0.720e3 + t16 * t105 / 0.576e3 - t4 * c21 / 0.720e3) * t25 / 0.9e1 + (-c11 * t105 / 0.24e2 - t16 * c21 / 0.24e2) * t9 / 0.48e2 + c11 * c21 * t32 / 0.252e3) + B22 * (t40 * t131 * t10 / 0.158400e6 + (t47 * t131 / 0.2880e4 + t40 * t139 / 0.2880e4) * t18 / 0.10e2 + (-c12 * t131 / 0.720e3 + t47 * t139 / 0.576e3 - t40 * c22 / 0.720e3) * t25 / 0.9e1 + (-c12 * t139 / 0.24e2 - t47 * c22 / 0.24e2) * t9 / 0.48e2 + c12 * c22 * t32 / 0.252e3) + B33 * (t68 * t165 * t10 / 0.158400e6 + (t75 * t165 / 0.2880e4 + t68 * t173 / 0.2880e4) * t18 / 0.10e2 + (-c13 * t165 / 0.720e3 + t75 * t173 / 0.576e3 - t68 * c23 / 0.720e3) * t25 / 0.9e1 + (-c13 * t173 / 0.24e2 - t75 * c23 / 0.24e2) * t9 / 0.48e2 + c13 * c23 * t32 / 0.252e3);
	t200 = c31 * b11 + c32 * b21 + c33 * b31;
	t208 = -c31 * a11 - c32 * a21 - c33 * a31;
	t234 = c32 * b22 + c31 * b12 + c33 * b32;
	t242 = -c31 * a12 - c33 * a32 - c32 * a22;
	t268 = c32 * b23 + c31 * b13 + c33 * b33;
	t276 = -c33 * a33 - c32 * a23 - c31 * a13;
	t299 = B11 * (t4 * t200 * t10 / 0.158400e6 + (t16 * t200 / 0.2880e4 + t4 * t208 / 0.2880e4) * t18 / 0.10e2 + (-c11 * t200 / 0.720e3 + t16 * t208 / 0.576e3 - t4 * c31 / 0.720e3) * t25 / 0.9e1 + (-c11 * t208 / 0.24e2 - t16 * c31 / 0.24e2) * t9 / 0.48e2 + c11 * c31 * t32 / 0.252e3) + B22 * (t40 * t234 * t10 / 0.158400e6 + (t47 * t234 / 0.2880e4 + t40 * t242 / 0.2880e4) * t18 / 0.10e2 + (-c12 * t234 / 0.720e3 + t47 * t242 / 0.576e3 - t40 * c32 / 0.720e3) * t25 / 0.9e1 + (-c12 * t242 / 0.24e2 - t47 * c32 / 0.24e2) * t9 / 0.48e2 + c12 * c32 * t32 / 0.252e3) + B33 * (t68 * t268 * t10 / 0.158400e6 + (t75 * t268 / 0.2880e4 + t68 * t276 / 0.2880e4) * t18 / 0.10e2 + (-c13 * t268 / 0.720e3 + t75 * t276 / 0.576e3 - t68 * c33 / 0.720e3) * t25 / 0.9e1 + (-c13 * t276 / 0.24e2 - t75 * c33 / 0.24e2) * t9 / 0.48e2 + c13 * c33 * t32 / 0.252e3);
	t315 = c21 * c21;
	t335 = c22 * c22;
	t355 = c23 * c23;
	t439 = B11 * (t97 * t200 * t10 / 0.158400e6 + (t105 * t200 / 0.2880e4 + t97 * t208 / 0.2880e4) * t18 / 0.10e2 + (-c21 * t200 / 0.720e3 + t105 * t208 / 0.576e3 - t97 * c31 / 0.720e3) * t25 / 0.9e1 + (-c21 * t208 / 0.24e2 - t105 * c31 / 0.24e2) * t9 / 0.48e2 + c21 * c31 * t32 / 0.252e3) + B22 * (t131 * t234 * t10 / 0.158400e6 + (t139 * t234 / 0.2880e4 + t131 * t242 / 0.2880e4) * t18 / 0.10e2 + (-c22 * t234 / 0.720e3 + t139 * t242 / 0.576e3 - t131 * c32 / 0.720e3) * t25 / 0.9e1 + (-c22 * t242 / 0.24e2 - t139 * c32 / 0.24e2) * t9 / 0.48e2 + c22 * c32 * t32 / 0.252e3) + B33 * (t165 * t268 * t10 / 0.158400e6 + (t173 * t268 / 0.2880e4 + t165 * t276 / 0.2880e4) * t18 / 0.10e2 + (-c23 * t268 / 0.720e3 + t173 * t276 / 0.576e3 - t165 * c33 / 0.720e3) * t25 / 0.9e1 + (-c23 * t276 / 0.24e2 - t173 * c33 / 0.24e2) * t9 / 0.48e2 + c23 * c33 * t32 / 0.252e3);
	t455 = c31 * c31;
	t475 = c32 * c32;
	t495 = c33 * c33;
	X(1,1) = B11 * (t4 * t4 * t10 / 0.158400e6 + t16 * t4 * t18 / 0.14400e5 + (-c11 * t4 / 0.360e3 + t16 * t16 / 0.576e3) * t25 / 0.9e1 - c11 * t16 * t9 / 0.576e3 + t31 * t32 / 0.252e3) + B22 * (t40 * t40 * t10 / 0.158400e6 + t47 * t40 * t18 / 0.14400e5 + (-c12 * t40 / 0.360e3 + t47 * t47 / 0.576e3) * t25 / 0.9e1 - c12 * t47 * t9 / 0.576e3 + t60 * t32 / 0.252e3) + B33 * (t68 * t68 * t10 / 0.158400e6 + t75 * t68 * t18 / 0.14400e5 + (-c13 * t68 / 0.360e3 + t75 * t75 / 0.576e3) * t25 / 0.9e1 - c13 * t75 * t9 / 0.576e3 + t88 * t32 / 0.252e3);
	X(2,3) = t196;
	X(1,3) = t299;
	X(2,1) = t196;
	X(2,2) = B11 * (t97 * t97 * t10 / 0.158400e6 + t105 * t97 * t18 / 0.14400e5 + (-c21 * t97 / 0.360e3 + t105 * t105 / 0.576e3) * t25 / 0.9e1 - c21 * t105 * t9 / 0.576e3 + t315 * t32 / 0.252e3) + B22 * (t131 * t131 * t10 / 0.158400e6 + t139 * t131 * t18 / 0.14400e5 + (-c22 * t131 / 0.360e3 + t139 * t139 / 0.576e3) * t25 / 0.9e1 - c22 * t139 * t9 / 0.576e3 + t335 * t32 / 0.252e3) + B33 * (t165 * t165 * t10 / 0.158400e6 + t173 * t165 * t18 / 0.14400e5 + (-c23 * t165 / 0.360e3 + t173 * t173 / 0.576e3) * t25 / 0.9e1 - c23 * t173 * t9 / 0.576e3 + t355 * t32 / 0.252e3);
	X(2,3) = t439;
	X(3,1) = t299;
	X(3,2) = t439;
	X(3,3) = B11 * (t200 * t200 * t10 / 0.158400e6 + t208 * t200 * t18 / 0.14400e5 + (-c31 * t200 / 0.360e3 + t208 * t208 / 0.576e3) * t25 / 0.9e1 - c31 * t208 * t9 / 0.576e3 + t455 * t32 / 0.252e3) + B22 * (t234 * t234 * t10 / 0.158400e6 + t242 * t234 * t18 / 0.14400e5 + (-c32 * t234 / 0.360e3 + t242 * t242 / 0.576e3) * t25 / 0.9e1 - c32 * t242 * t9 / 0.576e3 + t475 * t32 / 0.252e3) + B33 * (t268 * t268 * t10 / 0.158400e6 + t276 * t268 * t18 / 0.14400e5 + (-c33 * t268 / 0.360e3 + t276 * t276 / 0.576e3) * t25 / 0.9e1 - c33 * t276 * t9 / 0.576e3 + t495 * t32 / 0.252e3);

elseif calc==2
	%Maple generated code: A*(diag(sig^2))*C'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * T;
	t8 = t6 * t6;
	t9 = t8 * t7;
	t15 = c11 * a11 + c12 * a21 + c13 * a31;
	t19 = t8 * t6;
	t27 = t8 * T;
	t36 = c11 * c11;
	t44 = c12 * b22 + c11 * b12 + c13 * b32;
	t51 = c11 * a12 + c13 * a32 + c12 * a22;
	t70 = c12 * c12;
	t78 = c12 * b23 + c11 * b13 + c13 * b33;
	t85 = c13 * a33 + c12 * a23 + c11 * a13;
	t104 = c13 * c13;
	t113 = c21 * b11 + c22 * b21 + c23 * b31;
	t116 = t4 * t113 * t9 / 0.336e3;
	t121 = -c21 * a11 - c22 * a21 - c23 * a31;
	t128 = t15 * t121 / 0.6e1;
	t141 = c11 * c21 * t7 / 0.6e1;
	t147 = c22 * b22 + c21 * b12 + c23 * b32;
	t150 = t44 * t147 * t9 / 0.336e3;
	t155 = -c21 * a12 - c23 * a32 - c22 * a22;
	t162 = t51 * t155 / 0.6e1;
	t175 = c12 * c22 * t7 / 0.6e1;
	t181 = c22 * b23 + c21 * b13 + c23 * b33;
	t184 = t78 * t181 * t9 / 0.336e3;
	t189 = -c23 * a33 - c22 * a23 - c21 * a13;
	t196 = t85 * t189 / 0.6e1;
	t209 = c13 * c23 * t7 / 0.6e1;
	t216 = c31 * b11 + c32 * b21 + c33 * b31;
	t219 = t4 * t216 * t9 / 0.336e3;
	t224 = -c31 * a11 - c32 * a21 - c33 * a31;
	t231 = t15 * t224 / 0.6e1;
	t244 = c11 * c31 * t7 / 0.6e1;
	t250 = c32 * b22 + c31 * b12 + c33 * b32;
	t253 = t44 * t250 * t9 / 0.336e3;
	t258 = -c31 * a12 - c33 * a32 - c32 * a22;
	t265 = t51 * t258 / 0.6e1;
	t278 = c12 * c32 * t7 / 0.6e1;
	t284 = c32 * b23 + c31 * b13 + c33 * b33;
	t287 = t78 * t284 * t9 / 0.336e3;
	t292 = -c33 * a33 - c32 * a23 - c31 * a13;
	t299 = t85 * t292 / 0.6e1;
	t312 = c13 * c33 * t7 / 0.6e1;
	t395 = c21 * c21;
	t421 = c22 * c22;
	t447 = c23 * c23;
	t455 = t113 * t216 * t9 / 0.336e3;
	t463 = -t121 * t224 / 0.6e1;
	t476 = c21 * c31 * t7 / 0.6e1;
	t481 = t147 * t250 * t9 / 0.336e3;
	t489 = -t155 * t258 / 0.6e1;
	t502 = c22 * c32 * t7 / 0.6e1;
	t507 = t181 * t284 * t9 / 0.336e3;
	t515 = -t189 * t292 / 0.6e1;
	t528 = c23 * c33 * t7 / 0.6e1;
	t669 = c31 * c31;
	t695 = c32 * c32;
	t721 = c33 * c33;
	X(1,1) = B11 * (t4 * t4 * t9 / 0.336e3 + t15 * t4 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c11 * t4 - t15 * t15 / 0.6e1) * t27 / 0.5e1 + c11 * t15 * t8 / 0.6e1 - t36 * t7 / 0.6e1) + B22 * (t44 * t44 * t9 / 0.336e3 + t51 * t44 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c12 * t44 - t51 * t51 / 0.6e1) * t27 / 0.5e1 + c12 * t51 * t8 / 0.6e1 - t70 * t7 / 0.6e1) + B33 * (t78 * t78 * t9 / 0.336e3 + t85 * t78 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c13 * t78 - t85 * t85 / 0.6e1) * t27 / 0.5e1 + c13 * t85 * t8 / 0.6e1 - t104 * t7 / 0.6e1);
	X(2,3) = B11 * (t116 + (t15 * t113 / 0.12e2 + t4 * t121 / 0.24e2) * t19 / 0.6e1 + (-c11 * t113 / 0.4e1 + t128 + t4 * c21 / 0.24e2) * t27 / 0.5e1 + (-c11 * t121 / 0.2e1 + t15 * c21 / 0.6e1) * t8 / 0.4e1 - t141) + B22 * (t150 + (t51 * t147 / 0.12e2 + t44 * t155 / 0.24e2) * t19 / 0.6e1 + (-c12 * t147 / 0.4e1 + t162 + t44 * c22 / 0.24e2) * t27 / 0.5e1 + (-c12 * t155 / 0.2e1 + t51 * c22 / 0.6e1) * t8 / 0.4e1 - t175) + B33 * (t184 + (t85 * t181 / 0.12e2 + t78 * t189 / 0.24e2) * t19 / 0.6e1 + (-c13 * t181 / 0.4e1 + t196 + t78 * c23 / 0.24e2) * t27 / 0.5e1 + (-c13 * t189 / 0.2e1 + t85 * c23 / 0.6e1) * t8 / 0.4e1 - t209);
	X(1,3) = B11 * (t219 + (t15 * t216 / 0.12e2 + t4 * t224 / 0.24e2) * t19 / 0.6e1 + (-c11 * t216 / 0.4e1 + t231 + t4 * c31 / 0.24e2) * t27 / 0.5e1 + (-c11 * t224 / 0.2e1 + t15 * c31 / 0.6e1) * t8 / 0.4e1 - t244) + B22 * (t253 + (t51 * t250 / 0.12e2 + t44 * t258 / 0.24e2) * t19 / 0.6e1 + (-c12 * t250 / 0.4e1 + t265 + t44 * c32 / 0.24e2) * t27 / 0.5e1 + (-c12 * t258 / 0.2e1 + t51 * c32 / 0.6e1) * t8 / 0.4e1 - t278) + B33 * (t287 + (t85 * t284 / 0.12e2 + t78 * t292 / 0.24e2) * t19 / 0.6e1 + (-c13 * t284 / 0.4e1 + t299 + t78 * c33 / 0.24e2) * t27 / 0.5e1 + (-c13 * t292 / 0.2e1 + t85 * c33 / 0.6e1) * t8 / 0.4e1 - t312);
	X(2,1) = B11 * (t116 + (-t4 * t121 / 0.12e2 - t15 * t113 / 0.24e2) * t19 / 0.6e1 + (-t4 * c21 / 0.4e1 + t128 + c11 * t113 / 0.24e2) * t27 / 0.5e1 + (t15 * c21 / 0.2e1 - c11 * t121 / 0.6e1) * t8 / 0.4e1 - t141) + B22 * (t150 + (-t44 * t155 / 0.12e2 - t51 * t147 / 0.24e2) * t19 / 0.6e1 + (-t44 * c22 / 0.4e1 + t162 + c12 * t147 / 0.24e2) * t27 / 0.5e1 + (t51 * c22 / 0.2e1 - c12 * t155 / 0.6e1) * t8 / 0.4e1 - t175) + B33 * (t184 + (-t78 * t189 / 0.12e2 - t85 * t181 / 0.24e2) * t19 / 0.6e1 + (-t78 * c23 / 0.4e1 + t196 + c13 * t181 / 0.24e2) * t27 / 0.5e1 + (t85 * c23 / 0.2e1 - c13 * t189 / 0.6e1) * t8 / 0.4e1 - t209);
	X(2,2) = B11 * (t113 * t113 * t9 / 0.336e3 - t121 * t113 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c21 * t113 - t121 * t121 / 0.6e1) * t27 / 0.5e1 - c21 * t121 * t8 / 0.6e1 - t395 * t7 / 0.6e1) + B22 * (t147 * t147 * t9 / 0.336e3 - t155 * t147 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c22 * t147 - t155 * t155 / 0.6e1) * t27 / 0.5e1 - c22 * t155 * t8 / 0.6e1 - t421 * t7 / 0.6e1) + B33 * (t181 * t181 * t9 / 0.336e3 - t189 * t181 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c23 * t181 - t189 * t189 / 0.6e1) * t27 / 0.5e1 - c23 * t189 * t8 / 0.6e1 - t447 * t7 / 0.6e1);
	X(2,3) = B11 * (t455 + (-t121 * t216 / 0.12e2 + t113 * t224 / 0.24e2) * t19 / 0.6e1 + (-c21 * t216 / 0.4e1 + t463 + t113 * c31 / 0.24e2) * t27 / 0.5e1 + (-c21 * t224 / 0.2e1 - t121 * c31 / 0.6e1) * t8 / 0.4e1 - t476) + B22 * (t481 + (-t155 * t250 / 0.12e2 + t147 * t258 / 0.24e2) * t19 / 0.6e1 + (-c22 * t250 / 0.4e1 + t489 + t147 * c32 / 0.24e2) * t27 / 0.5e1 + (-c22 * t258 / 0.2e1 - t155 * c32 / 0.6e1) * t8 / 0.4e1 - t502) + B33 * (t507 + (-t189 * t284 / 0.12e2 + t181 * t292 / 0.24e2) * t19 / 0.6e1 + (-c23 * t284 / 0.4e1 + t515 + t181 * c33 / 0.24e2) * t27 / 0.5e1 + (-c23 * t292 / 0.2e1 - t189 * c33 / 0.6e1) * t8 / 0.4e1 - t528);
	X(3,1) = B11 * (t219 + (-t4 * t224 / 0.12e2 - t15 * t216 / 0.24e2) * t19 / 0.6e1 + (-t4 * c31 / 0.4e1 + t231 + c11 * t216 / 0.24e2) * t27 / 0.5e1 + (t15 * c31 / 0.2e1 - c11 * t224 / 0.6e1) * t8 / 0.4e1 - t244) + B22 * (t253 + (-t44 * t258 / 0.12e2 - t51 * t250 / 0.24e2) * t19 / 0.6e1 + (-t44 * c32 / 0.4e1 + t265 + c12 * t250 / 0.24e2) * t27 / 0.5e1 + (t51 * c32 / 0.2e1 - c12 * t258 / 0.6e1) * t8 / 0.4e1 - t278) + B33 * (t287 + (-t78 * t292 / 0.12e2 - t85 * t284 / 0.24e2) * t19 / 0.6e1 + (-t78 * c33 / 0.4e1 + t299 + c13 * t284 / 0.24e2) * t27 / 0.5e1 + (t85 * c33 / 0.2e1 - c13 * t292 / 0.6e1) * t8 / 0.4e1 - t312);
	X(3,2) = B11 * (t455 + (-t113 * t224 / 0.12e2 + t121 * t216 / 0.24e2) * t19 / 0.6e1 + (-t113 * c31 / 0.4e1 + t463 + c21 * t216 / 0.24e2) * t27 / 0.5e1 + (-t121 * c31 / 0.2e1 - c21 * t224 / 0.6e1) * t8 / 0.4e1 - t476) + B22 * (t481 + (-t147 * t258 / 0.12e2 + t155 * t250 / 0.24e2) * t19 / 0.6e1 + (-t147 * c32 / 0.4e1 + t489 + c22 * t250 / 0.24e2) * t27 / 0.5e1 + (-t155 * c32 / 0.2e1 - c22 * t258 / 0.6e1) * t8 / 0.4e1 - t502) + B33 * (t507 + (-t181 * t292 / 0.12e2 + t189 * t284 / 0.24e2) * t19 / 0.6e1 + (-t181 * c33 / 0.4e1 + t515 + c23 * t284 / 0.24e2) * t27 / 0.5e1 + (-t189 * c33 / 0.2e1 - c23 * t292 / 0.6e1) * t8 / 0.4e1 - t528);
	X(3,3) = B11 * (t216 * t216 * t9 / 0.336e3 - t224 * t216 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c31 * t216 - t224 * t224 / 0.6e1) * t27 / 0.5e1 - c31 * t224 * t8 / 0.6e1 - t669 * t7 / 0.6e1) + B22 * (t250 * t250 * t9 / 0.336e3 - t258 * t250 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c32 * t250 - t258 * t258 / 0.6e1) * t27 / 0.5e1 - c32 * t258 * t8 / 0.6e1 - t695 * t7 / 0.6e1) + B33 * (t284 * t284 * t9 / 0.336e3 - t292 * t284 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c33 * t284 - t292 * t292 / 0.6e1) * t27 / 0.5e1 - c33 * t292 * t8 / 0.6e1 - t721 * t7 / 0.6e1);

elseif calc==3
	%Maple generated code: B*(diag(sig^2))*D'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t9 = t8 * t6;
	t15 = -c11 * a11 - c12 * a21 - c13 * a31;
	t19 = t8 * T;
	t36 = t7 * t6 * T;
	t39 = c11 * c11;
	t40 = t7 * t6;
	t48 = c12 * b22 + c11 * b12 + c13 * b32;
	t55 = -c11 * a12 - c13 * a32 - c12 * a22;
	t76 = c12 * c12;
	t84 = c12 * b23 + c11 * b13 + c13 * b33;
	t91 = -c13 * a33 - c12 * a23 - c11 * a13;
	t112 = c13 * c13;
	t121 = -c21 * b11 - c22 * b21 - c23 * b31;
	t124 = t4 * t121 * t9 / 0.28800e5;
	t129 = -c21 * a11 - c22 * a21 - c23 * a31;
	t136 = t15 * t129 / 0.144e3;
	t151 = c21 * c11 * t40 / 0.72e2;
	t157 = -c22 * b22 - c21 * b12 - c23 * b32;
	t160 = t48 * t157 * t9 / 0.28800e5;
	t165 = -c21 * a12 - c23 * a32 - c22 * a22;
	t172 = t55 * t165 / 0.144e3;
	t187 = c22 * c12 * t40 / 0.72e2;
	t193 = -c22 * b23 - c21 * b13 - c23 * b33;
	t196 = t84 * t193 * t9 / 0.28800e5;
	t201 = -c23 * a33 - c22 * a23 - c21 * a13;
	t208 = t91 * t201 / 0.144e3;
	t223 = c23 * c13 * t40 / 0.72e2;
	t230 = -c31 * b11 - c32 * b21 - c33 * b31;
	t233 = t4 * t230 * t9 / 0.28800e5;
	t238 = -c31 * a11 - c32 * a21 - c33 * a31;
	t245 = t15 * t238 / 0.144e3;
	t260 = c31 * c11 * t40 / 0.72e2;
	t266 = -c32 * b22 - c31 * b12 - c33 * b32;
	t269 = t48 * t266 * t9 / 0.28800e5;
	t274 = -c31 * a12 - c33 * a32 - c32 * a22;
	t281 = t55 * t274 / 0.144e3;
	t296 = c32 * c12 * t40 / 0.72e2;
	t302 = -c32 * b23 - c31 * b13 - c33 * b33;
	t305 = t84 * t302 * t9 / 0.28800e5;
	t310 = -c33 * a33 - c32 * a23 - c31 * a13;
	t317 = t91 * t310 / 0.144e3;
	t332 = c33 * c13 * t40 / 0.72e2;
	t423 = c21 * c21;
	t451 = c22 * c22;
	t479 = c23 * c23;
	t487 = -t121 * t230 * t9 / 0.28800e5;
	t495 = t129 * t238 / 0.144e3;
	t510 = c31 * c21 * t40 / 0.72e2;
	t515 = -t157 * t266 * t9 / 0.28800e5;
	t523 = t165 * t274 / 0.144e3;
	t538 = c32 * c22 * t40 / 0.72e2;
	t543 = -t193 * t302 * t9 / 0.28800e5;
	t551 = t201 * t310 / 0.144e3;
	t566 = c33 * c23 * t40 / 0.72e2;
	t721 = c31 * c31;
	t749 = c32 * c32;
	t777 = c33 * c33;
	X(1,1) = B11 * (-t4 * t4 * t9 / 0.28800e5 - t15 * t4 * t19 / 0.25920e5 + (c11 * t4 / 0.90e2 + t15 * t15 / 0.144e3) * t8 / 0.8e1 - c11 * t15 * t36 / 0.1008e4 - t39 * t40 / 0.72e2) + B22 * (-t48 * t48 * t9 / 0.28800e5 - t55 * t48 * t19 / 0.25920e5 + (c12 * t48 / 0.90e2 + t55 * t55 / 0.144e3) * t8 / 0.8e1 - c12 * t55 * t36 / 0.1008e4 - t76 * t40 / 0.72e2) + B33 * (-t84 * t84 * t9 / 0.28800e5 - t91 * t84 * t19 / 0.25920e5 + (c13 * t84 / 0.90e2 + t91 * t91 / 0.144e3) * t8 / 0.8e1 - c13 * t91 * t36 / 0.1008e4 - t112 * t40 / 0.72e2);
	X(2,3) = B11 * (t124 + (t15 * t121 / 0.576e3 + t4 * t129 / 0.720e3) * t19 / 0.9e1 + (-c11 * t121 / 0.144e3 + t136 + t4 * c21 / 0.240e3) * t8 / 0.8e1 + (-c11 * t129 / 0.36e2 + t15 * c21 / 0.48e2) * t36 / 0.7e1 - t151) + B22 * (t160 + (t55 * t157 / 0.576e3 + t48 * t165 / 0.720e3) * t19 / 0.9e1 + (-c12 * t157 / 0.144e3 + t172 + t48 * c22 / 0.240e3) * t8 / 0.8e1 + (-c12 * t165 / 0.36e2 + t55 * c22 / 0.48e2) * t36 / 0.7e1 - t187) + B33 * (t196 + (t91 * t193 / 0.576e3 + t84 * t201 / 0.720e3) * t19 / 0.9e1 + (-c13 * t193 / 0.144e3 + t208 + t84 * c23 / 0.240e3) * t8 / 0.8e1 + (-c13 * t201 / 0.36e2 + t91 * c23 / 0.48e2) * t36 / 0.7e1 - t223);
	X(1,3) = B11 * (t233 + (t15 * t230 / 0.576e3 + t4 * t238 / 0.720e3) * t19 / 0.9e1 + (-c11 * t230 / 0.144e3 + t245 + t4 * c31 / 0.240e3) * t8 / 0.8e1 + (-c11 * t238 / 0.36e2 + t15 * c31 / 0.48e2) * t36 / 0.7e1 - t260) + B22 * (t269 + (t55 * t266 / 0.576e3 + t48 * t274 / 0.720e3) * t19 / 0.9e1 + (-c12 * t266 / 0.144e3 + t281 + t48 * c32 / 0.240e3) * t8 / 0.8e1 + (-c12 * t274 / 0.36e2 + t55 * c32 / 0.48e2) * t36 / 0.7e1 - t296) + B33 * (t305 + (t91 * t302 / 0.576e3 + t84 * t310 / 0.720e3) * t19 / 0.9e1 + (-c13 * t302 / 0.144e3 + t317 + t84 * c33 / 0.240e3) * t8 / 0.8e1 + (-c13 * t310 / 0.36e2 + t91 * c33 / 0.48e2) * t36 / 0.7e1 - t332);
	X(2,1) = B11 * (t124 + (-t4 * t129 / 0.576e3 - t15 * t121 / 0.720e3) * t19 / 0.9e1 + (t4 * c21 / 0.144e3 + t136 - c11 * t121 / 0.240e3) * t8 / 0.8e1 + (-t15 * c21 / 0.36e2 + c11 * t129 / 0.48e2) * t36 / 0.7e1 - t151) + B22 * (t160 + (-t48 * t165 / 0.576e3 - t55 * t157 / 0.720e3) * t19 / 0.9e1 + (t48 * c22 / 0.144e3 + t172 - c12 * t157 / 0.240e3) * t8 / 0.8e1 + (-t55 * c22 / 0.36e2 + c12 * t165 / 0.48e2) * t36 / 0.7e1 - t187) + B33 * (t196 + (-t84 * t201 / 0.576e3 - t91 * t193 / 0.720e3) * t19 / 0.9e1 + (t84 * c23 / 0.144e3 + t208 - c13 * t193 / 0.240e3) * t8 / 0.8e1 + (-t91 * c23 / 0.36e2 + c13 * t201 / 0.48e2) * t36 / 0.7e1 - t223);
	X(2,2) = B11 * (-t121 * t121 * t9 / 0.28800e5 + t129 * t121 * t19 / 0.25920e5 + (-c21 * t121 / 0.90e2 + t129 * t129 / 0.144e3) * t8 / 0.8e1 - c21 * t129 * t36 / 0.1008e4 - t423 * t40 / 0.72e2) + B22 * (-t157 * t157 * t9 / 0.28800e5 + t165 * t157 * t19 / 0.25920e5 + (-c22 * t157 / 0.90e2 + t165 * t165 / 0.144e3) * t8 / 0.8e1 - c22 * t165 * t36 / 0.1008e4 - t451 * t40 / 0.72e2) + B33 * (-t193 * t193 * t9 / 0.28800e5 + t201 * t193 * t19 / 0.25920e5 + (-c23 * t193 / 0.90e2 + t201 * t201 / 0.144e3) * t8 / 0.8e1 - c23 * t201 * t36 / 0.1008e4 - t479 * t40 / 0.72e2);
	X(2,3) = B11 * (t487 + (t129 * t230 / 0.576e3 - t121 * t238 / 0.720e3) * t19 / 0.9e1 + (-c21 * t230 / 0.144e3 + t495 - t121 * c31 / 0.240e3) * t8 / 0.8e1 + (-c21 * t238 / 0.36e2 + t129 * c31 / 0.48e2) * t36 / 0.7e1 - t510) + B22 * (t515 + (t165 * t266 / 0.576e3 - t157 * t274 / 0.720e3) * t19 / 0.9e1 + (-c22 * t266 / 0.144e3 + t523 - t157 * c32 / 0.240e3) * t8 / 0.8e1 + (-c22 * t274 / 0.36e2 + t165 * c32 / 0.48e2) * t36 / 0.7e1 - t538) + B33 * (t543 + (t201 * t302 / 0.576e3 - t193 * t310 / 0.720e3) * t19 / 0.9e1 + (-c23 * t302 / 0.144e3 + t551 - t193 * c33 / 0.240e3) * t8 / 0.8e1 + (-c23 * t310 / 0.36e2 + t201 * c33 / 0.48e2) * t36 / 0.7e1 - t566);
	X(3,1) = B11 * (t233 + (-t4 * t238 / 0.576e3 - t15 * t230 / 0.720e3) * t19 / 0.9e1 + (t4 * c31 / 0.144e3 + t245 - c11 * t230 / 0.240e3) * t8 / 0.8e1 + (-t15 * c31 / 0.36e2 + c11 * t238 / 0.48e2) * t36 / 0.7e1 - t260) + B22 * (t269 + (-t48 * t274 / 0.576e3 - t55 * t266 / 0.720e3) * t19 / 0.9e1 + (t48 * c32 / 0.144e3 + t281 - c12 * t266 / 0.240e3) * t8 / 0.8e1 + (-t55 * c32 / 0.36e2 + c12 * t274 / 0.48e2) * t36 / 0.7e1 - t296) + B33 * (t305 + (-t84 * t310 / 0.576e3 - t91 * t302 / 0.720e3) * t19 / 0.9e1 + (t84 * c33 / 0.144e3 + t317 - c13 * t302 / 0.240e3) * t8 / 0.8e1 + (-t91 * c33 / 0.36e2 + c13 * t310 / 0.48e2) * t36 / 0.7e1 - t332);
	X(3,2) = B11 * (t487 + (t121 * t238 / 0.576e3 - t129 * t230 / 0.720e3) * t19 / 0.9e1 + (-t121 * c31 / 0.144e3 + t495 - c21 * t230 / 0.240e3) * t8 / 0.8e1 + (-t129 * c31 / 0.36e2 + c21 * t238 / 0.48e2) * t36 / 0.7e1 - t510) + B22 * (t515 + (t157 * t274 / 0.576e3 - t165 * t266 / 0.720e3) * t19 / 0.9e1 + (-t157 * c32 / 0.144e3 + t523 - c22 * t266 / 0.240e3) * t8 / 0.8e1 + (-t165 * c32 / 0.36e2 + c22 * t274 / 0.48e2) * t36 / 0.7e1 - t538) + B33 * (t543 + (t193 * t310 / 0.576e3 - t201 * t302 / 0.720e3) * t19 / 0.9e1 + (-t193 * c33 / 0.144e3 + t551 - c23 * t302 / 0.240e3) * t8 / 0.8e1 + (-t201 * c33 / 0.36e2 + c23 * t310 / 0.48e2) * t36 / 0.7e1 - t566);
	X(3,3) = B11 * (-t230 * t230 * t9 / 0.28800e5 + t238 * t230 * t19 / 0.25920e5 + (-c31 * t230 / 0.90e2 + t238 * t238 / 0.144e3) * t8 / 0.8e1 - c31 * t238 * t36 / 0.1008e4 - t721 * t40 / 0.72e2) + B22 * (-t266 * t266 * t9 / 0.28800e5 + t274 * t266 * t19 / 0.25920e5 + (-c32 * t266 / 0.90e2 + t274 * t274 / 0.144e3) * t8 / 0.8e1 - c32 * t274 * t36 / 0.1008e4 - t749 * t40 / 0.72e2) + B33 * (-t302 * t302 * t9 / 0.28800e5 + t310 * t302 * t19 / 0.25920e5 + (-c33 * t302 / 0.90e2 + t310 * t310 / 0.144e3) * t8 / 0.8e1 - c33 * t310 * t36 / 0.1008e4 - t777 * t40 / 0.72e2);

elseif calc==4
	%Maple generated code: A*(diag(sig^2))*E'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = T * T;
	t7 = t6 * T;
	t8 = t6 * t6;
	t9 = t8 * t7;
	t12 = c11 * a11;
	t13 = c12 * a21;
	t14 = c13 * a31;
	t15 = t12 + t13 + t14;
	t20 = t8 * t6;
	t28 = t8 * T;
	t41 = c12 * b22;
	t42 = c11 * b12;
	t43 = c13 * b32;
	t44 = t41 + t42 + t43;
	t48 = c11 * a12;
	t49 = c13 * a32;
	t50 = c12 * a22;
	t51 = t48 + t49 + t50;
	t69 = c12 * b23;
	t70 = c11 * b13;
	t71 = c13 * b33;
	t72 = t69 + t70 + t71;
	t76 = c13 * a33;
	t77 = c12 * a23;
	t78 = c11 * a13;
	t79 = t76 + t77 + t78;
	t232 = c21 * b11;
	t233 = c22 * b21;
	t234 = c23 * b31;
	t235 = t232 + t233 + t234;
	t239 = c21 * a11;
	t240 = c22 * a21;
	t241 = c23 * a31;
	t242 = t239 + t240 + t241;
	t266 = c22 * b22;
	t267 = c21 * b12;
	t268 = c23 * b32;
	t269 = t266 + t267 + t268;
	t273 = c21 * a12;
	t274 = c23 * a32;
	t275 = c22 * a22;
	t276 = t273 + t274 + t275;
	t294 = c22 * b23;
	t295 = c21 * b13;
	t296 = c23 * b33;
	t297 = t294 + t295 + t296;
	t301 = c23 * a33;
	t302 = c22 * a23;
	t303 = c21 * a13;
	t304 = t301 + t302 + t303;
	t457 = c31 * b11;
	t458 = c32 * b21;
	t459 = c33 * b31;
	t460 = t457 + t458 + t459;
	t464 = c31 * a11;
	t465 = c32 * a21;
	t466 = c33 * a31;
	t467 = t464 + t465 + t466;
	t491 = c32 * b22;
	t492 = c31 * b12;
	t493 = c33 * b32;
	t494 = t491 + t492 + t493;
	t498 = c31 * a12;
	t499 = c33 * a32;
	t500 = c32 * a22;
	t501 = t498 + t499 + t500;
	t519 = c32 * b23;
	t520 = c31 * b13;
	t521 = c33 * b33;
	t522 = t519 + t520 + t521;
	t526 = c33 * a33;
	t527 = c32 * a23;
	t528 = c31 * a13;
	t529 = t526 + t527 + t528;
	X(1,1) = B11 * (t4 * b11 * t9 / 0.336e3 + (t15 * b11 / 0.12e2 - t4 * a11 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t1 - t15 * a11 / 0.6e1 + t2 / 0.24e2 + t3 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t12 + t13 / 0.6e1 + t14 / 0.6e1) * t8 / 0.4e1 - c11 * t7 / 0.6e1) + B22 * (t44 * b12 * t9 / 0.336e3 + (t51 * b12 / 0.12e2 - t44 * a12 / 0.24e2) * t20 / 0.6e1 + (-c12 * b12 / 0.4e1 - t51 * a12 / 0.6e1) * t28 / 0.5e1 + c12 * a12 * t8 / 0.8e1) + B33 * (t72 * b13 * t9 / 0.336e3 + (t79 * b13 / 0.12e2 - t72 * a13 / 0.24e2) * t20 / 0.6e1 + (-c13 * b13 / 0.4e1 - t79 * a13 / 0.6e1) * t28 / 0.5e1 + c13 * a13 * t8 / 0.8e1);
	X(2,3) = B11 * (t4 * b21 * t9 / 0.336e3 + (t15 * b21 / 0.12e2 - t4 * a21 / 0.24e2) * t20 / 0.6e1 + (-c11 * b21 / 0.4e1 - t15 * a21 / 0.6e1) * t28 / 0.5e1 + c11 * a21 * t8 / 0.8e1) + B22 * (t44 * b22 * t9 / 0.336e3 + (t51 * b22 / 0.12e2 - t44 * a22 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t41 - t51 * a22 / 0.6e1 + t42 / 0.24e2 + t43 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t50 + t48 / 0.6e1 + t49 / 0.6e1) * t8 / 0.4e1 - c12 * t7 / 0.6e1) + B33 * (t72 * b23 * t9 / 0.336e3 + (t79 * b23 / 0.12e2 - t72 * a23 / 0.24e2) * t20 / 0.6e1 + (-c13 * b23 / 0.4e1 - t79 * a23 / 0.6e1) * t28 / 0.5e1 + c13 * a23 * t8 / 0.8e1);
	X(1,3) = B11 * (t4 * b31 * t9 / 0.336e3 + (t15 * b31 / 0.12e2 - t4 * a31 / 0.24e2) * t20 / 0.6e1 + (-c11 * b31 / 0.4e1 - t15 * a31 / 0.6e1) * t28 / 0.5e1 + c11 * a31 * t8 / 0.8e1) + B22 * (t44 * b32 * t9 / 0.336e3 + (t51 * b32 / 0.12e2 - t44 * a32 / 0.24e2) * t20 / 0.6e1 + (-c12 * b32 / 0.4e1 - t51 * a32 / 0.6e1) * t28 / 0.5e1 + c12 * a32 * t8 / 0.8e1) + B33 * (t72 * b33 * t9 / 0.336e3 + (t79 * b33 / 0.12e2 - t72 * a33 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t71 - t79 * a33 / 0.6e1 + t69 / 0.24e2 + t70 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t76 + t77 / 0.6e1 + t78 / 0.6e1) * t8 / 0.4e1 - c13 * t7 / 0.6e1);
	X(2,1) = B11 * (t235 * b11 * t9 / 0.336e3 + (t242 * b11 / 0.12e2 - t235 * a11 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t232 - t242 * a11 / 0.6e1 + t233 / 0.24e2 + t234 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t239 + t240 / 0.6e1 + t241 / 0.6e1) * t8 / 0.4e1 - c21 * t7 / 0.6e1) + B22 * (t269 * b12 * t9 / 0.336e3 + (t276 * b12 / 0.12e2 - t269 * a12 / 0.24e2) * t20 / 0.6e1 + (-c22 * b12 / 0.4e1 - t276 * a12 / 0.6e1) * t28 / 0.5e1 + c22 * a12 * t8 / 0.8e1) + B33 * (t297 * b13 * t9 / 0.336e3 + (t304 * b13 / 0.12e2 - t297 * a13 / 0.24e2) * t20 / 0.6e1 + (-c23 * b13 / 0.4e1 - t304 * a13 / 0.6e1) * t28 / 0.5e1 + c23 * a13 * t8 / 0.8e1);
	X(2,2) = B11 * (t235 * b21 * t9 / 0.336e3 + (t242 * b21 / 0.12e2 - t235 * a21 / 0.24e2) * t20 / 0.6e1 + (-c21 * b21 / 0.4e1 - t242 * a21 / 0.6e1) * t28 / 0.5e1 + c21 * a21 * t8 / 0.8e1) + B22 * (t269 * b22 * t9 / 0.336e3 + (t276 * b22 / 0.12e2 - t269 * a22 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t266 - t276 * a22 / 0.6e1 + t267 / 0.24e2 + t268 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t275 + t273 / 0.6e1 + t274 / 0.6e1) * t8 / 0.4e1 - c22 * t7 / 0.6e1) + B33 * (t297 * b23 * t9 / 0.336e3 + (t304 * b23 / 0.12e2 - t297 * a23 / 0.24e2) * t20 / 0.6e1 + (-c23 * b23 / 0.4e1 - t304 * a23 / 0.6e1) * t28 / 0.5e1 + c23 * a23 * t8 / 0.8e1);
	X(2,3) = B11 * (t235 * b31 * t9 / 0.336e3 + (t242 * b31 / 0.12e2 - t235 * a31 / 0.24e2) * t20 / 0.6e1 + (-c21 * b31 / 0.4e1 - t242 * a31 / 0.6e1) * t28 / 0.5e1 + c21 * a31 * t8 / 0.8e1) + B22 * (t269 * b32 * t9 / 0.336e3 + (t276 * b32 / 0.12e2 - t269 * a32 / 0.24e2) * t20 / 0.6e1 + (-c22 * b32 / 0.4e1 - t276 * a32 / 0.6e1) * t28 / 0.5e1 + c22 * a32 * t8 / 0.8e1) + B33 * (t297 * b33 * t9 / 0.336e3 + (t304 * b33 / 0.12e2 - t297 * a33 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t296 - t304 * a33 / 0.6e1 + t294 / 0.24e2 + t295 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t301 + t302 / 0.6e1 + t303 / 0.6e1) * t8 / 0.4e1 - c23 * t7 / 0.6e1);
	X(3,1) = B11 * (t460 * b11 * t9 / 0.336e3 + (t467 * b11 / 0.12e2 - t460 * a11 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t457 - t467 * a11 / 0.6e1 + t458 / 0.24e2 + t459 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t464 + t465 / 0.6e1 + t466 / 0.6e1) * t8 / 0.4e1 - c31 * t7 / 0.6e1) + B22 * (t494 * b12 * t9 / 0.336e3 + (t501 * b12 / 0.12e2 - t494 * a12 / 0.24e2) * t20 / 0.6e1 + (-c32 * b12 / 0.4e1 - t501 * a12 / 0.6e1) * t28 / 0.5e1 + c32 * a12 * t8 / 0.8e1) + B33 * (t522 * b13 * t9 / 0.336e3 + (t529 * b13 / 0.12e2 - t522 * a13 / 0.24e2) * t20 / 0.6e1 + (-c33 * b13 / 0.4e1 - t529 * a13 / 0.6e1) * t28 / 0.5e1 + c33 * a13 * t8 / 0.8e1);
	X(3,2) = B11 * (t460 * b21 * t9 / 0.336e3 + (t467 * b21 / 0.12e2 - t460 * a21 / 0.24e2) * t20 / 0.6e1 + (-c31 * b21 / 0.4e1 - t467 * a21 / 0.6e1) * t28 / 0.5e1 + c31 * a21 * t8 / 0.8e1) + B22 * (t494 * b22 * t9 / 0.336e3 + (t501 * b22 / 0.12e2 - t494 * a22 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t491 - t501 * a22 / 0.6e1 + t492 / 0.24e2 + t493 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t500 + t498 / 0.6e1 + t499 / 0.6e1) * t8 / 0.4e1 - c32 * t7 / 0.6e1) + B33 * (t522 * b23 * t9 / 0.336e3 + (t529 * b23 / 0.12e2 - t522 * a23 / 0.24e2) * t20 / 0.6e1 + (-c33 * b23 / 0.4e1 - t529 * a23 / 0.6e1) * t28 / 0.5e1 + c33 * a23 * t8 / 0.8e1);
	X(3,3) = B11 * (t460 * b31 * t9 / 0.336e3 + (t467 * b31 / 0.12e2 - t460 * a31 / 0.24e2) * t20 / 0.6e1 + (-c31 * b31 / 0.4e1 - t467 * a31 / 0.6e1) * t28 / 0.5e1 + c31 * a31 * t8 / 0.8e1) + B22 * (t494 * b32 * t9 / 0.336e3 + (t501 * b32 / 0.12e2 - t494 * a32 / 0.24e2) * t20 / 0.6e1 + (-c32 * b32 / 0.4e1 - t501 * a32 / 0.6e1) * t28 / 0.5e1 + c32 * a32 * t8 / 0.8e1) + B33 * (t522 * b33 * t9 / 0.336e3 + (t529 * b33 / 0.12e2 - t522 * a33 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t521 - t529 * a33 / 0.6e1 + t519 / 0.24e2 + t520 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t526 + t527 / 0.6e1 + t528 / 0.6e1) * t8 / 0.4e1 - c33 * t7 / 0.6e1);

elseif calc==5
	%Maple generated code: B*(diag(sig^2))*F'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t9 = t8 * T;
	t12 = c11 * a11;
	t13 = c12 * a21;
	t14 = c13 * a31;
	t15 = -t12 - t13 - t14;
	t30 = t7 * t6 * T;
	t34 = t7 * t6;
	t37 = t7 * T;
	t42 = c12 * b22;
	t43 = c11 * b12;
	t44 = c13 * b32;
	t45 = t42 + t43 + t44;
	t49 = c11 * a12;
	t50 = c13 * a32;
	t51 = c12 * a22;
	t52 = -t49 - t50 - t51;
	t72 = c12 * b23;
	t73 = c11 * b13;
	t74 = c13 * b33;
	t75 = t72 + t73 + t74;
	t79 = c13 * a33;
	t80 = c12 * a23;
	t81 = c11 * a13;
	t82 = -t79 - t80 - t81;
	t243 = c21 * b11;
	t244 = c22 * b21;
	t245 = c23 * b31;
	t246 = t243 + t244 + t245;
	t250 = c21 * a11;
	t251 = c22 * a21;
	t252 = c23 * a31;
	t253 = -t250 - t251 - t252;
	t276 = c22 * b22;
	t277 = c21 * b12;
	t278 = c23 * b32;
	t279 = t276 + t277 + t278;
	t283 = c21 * a12;
	t284 = c23 * a32;
	t285 = c22 * a22;
	t286 = -t283 - t284 - t285;
	t306 = c22 * b23;
	t307 = c21 * b13;
	t308 = c23 * b33;
	t309 = t306 + t307 + t308;
	t313 = c23 * a33;
	t314 = c22 * a23;
	t315 = c21 * a13;
	t316 = -t313 - t314 - t315;
	t477 = c31 * b11;
	t478 = c32 * b21;
	t479 = c33 * b31;
	t480 = t477 + t478 + t479;
	t484 = c31 * a11;
	t485 = c32 * a21;
	t486 = c33 * a31;
	t487 = -t484 - t485 - t486;
	t510 = c32 * b22;
	t511 = c31 * b12;
	t512 = c33 * b32;
	t513 = t510 + t511 + t512;
	t517 = c31 * a12;
	t518 = c33 * a32;
	t519 = c32 * a22;
	t520 = -t517 - t518 - t519;
	t540 = c32 * b23;
	t541 = c31 * b13;
	t542 = c33 * b33;
	t543 = t540 + t541 + t542;
	t547 = c33 * a33;
	t548 = c32 * a23;
	t549 = c31 * a13;
	t550 = -t547 - t548 - t549;
	X(1,1) = B11 * (-t4 * b11 * t9 / 0.6480e4 + (-t15 * b11 / 0.144e3 + t4 * a11 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t1 + t15 * a11 / 0.48e2 - t2 / 0.120e3 - t3 / 0.120e3) * t30 / 0.7e1 + (-t12 + t13 + t14) * t34 / 0.144e3 + c11 * t37 / 0.30e2) + B22 * (-t45 * b12 * t9 / 0.6480e4 + (-t52 * b12 / 0.144e3 + t45 * a12 / 0.240e3) * t8 / 0.8e1 + (c12 * b12 / 0.36e2 + t52 * a12 / 0.48e2) * t30 / 0.7e1 - c12 * a12 * t34 / 0.72e2) + B33 * (-t75 * b13 * t9 / 0.6480e4 + (-t82 * b13 / 0.144e3 + t75 * a13 / 0.240e3) * t8 / 0.8e1 + (c13 * b13 / 0.36e2 + t82 * a13 / 0.48e2) * t30 / 0.7e1 - c13 * a13 * t34 / 0.72e2);
	X(2,3) = B11 * (-t4 * b21 * t9 / 0.6480e4 + (-t15 * b21 / 0.144e3 + t4 * a21 / 0.240e3) * t8 / 0.8e1 + (c11 * b21 / 0.36e2 + t15 * a21 / 0.48e2) * t30 / 0.7e1 - c11 * a21 * t34 / 0.72e2) + B22 * (-t45 * b22 * t9 / 0.6480e4 + (-t52 * b22 / 0.144e3 + t45 * a22 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t42 + t52 * a22 / 0.48e2 - t43 / 0.120e3 - t44 / 0.120e3) * t30 / 0.7e1 + (-t51 + t49 + t50) * t34 / 0.144e3 + c12 * t37 / 0.30e2) + B33 * (-t75 * b23 * t9 / 0.6480e4 + (-t82 * b23 / 0.144e3 + t75 * a23 / 0.240e3) * t8 / 0.8e1 + (c13 * b23 / 0.36e2 + t82 * a23 / 0.48e2) * t30 / 0.7e1 - c13 * a23 * t34 / 0.72e2);
	X(1,3) = B11 * (-t4 * b31 * t9 / 0.6480e4 + (-t15 * b31 / 0.144e3 + t4 * a31 / 0.240e3) * t8 / 0.8e1 + (c11 * b31 / 0.36e2 + t15 * a31 / 0.48e2) * t30 / 0.7e1 - c11 * a31 * t34 / 0.72e2) + B22 * (-t45 * b32 * t9 / 0.6480e4 + (-t52 * b32 / 0.144e3 + t45 * a32 / 0.240e3) * t8 / 0.8e1 + (c12 * b32 / 0.36e2 + t52 * a32 / 0.48e2) * t30 / 0.7e1 - c12 * a32 * t34 / 0.72e2) + B33 * (-t75 * b33 * t9 / 0.6480e4 + (-t82 * b33 / 0.144e3 + t75 * a33 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t74 + t82 * a33 / 0.48e2 - t72 / 0.120e3 - t73 / 0.120e3) * t30 / 0.7e1 + (-t79 + t80 + t81) * t34 / 0.144e3 + c13 * t37 / 0.30e2);
	X(2,1) = B11 * (-t246 * b11 * t9 / 0.6480e4 + (-t253 * b11 / 0.144e3 + t246 * a11 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t243 + t253 * a11 / 0.48e2 - t244 / 0.120e3 - t245 / 0.120e3) * t30 / 0.7e1 + (-t250 + t251 + t252) * t34 / 0.144e3 + c21 * t37 / 0.30e2) + B22 * (-t279 * b12 * t9 / 0.6480e4 + (-t286 * b12 / 0.144e3 + t279 * a12 / 0.240e3) * t8 / 0.8e1 + (c22 * b12 / 0.36e2 + t286 * a12 / 0.48e2) * t30 / 0.7e1 - c22 * a12 * t34 / 0.72e2) + B33 * (-t309 * b13 * t9 / 0.6480e4 + (-t316 * b13 / 0.144e3 + t309 * a13 / 0.240e3) * t8 / 0.8e1 + (c23 * b13 / 0.36e2 + t316 * a13 / 0.48e2) * t30 / 0.7e1 - c23 * a13 * t34 / 0.72e2);
	X(2,2) = B11 * (-t246 * b21 * t9 / 0.6480e4 + (-t253 * b21 / 0.144e3 + t246 * a21 / 0.240e3) * t8 / 0.8e1 + (c21 * b21 / 0.36e2 + t253 * a21 / 0.48e2) * t30 / 0.7e1 - c21 * a21 * t34 / 0.72e2) + B22 * (-t279 * b22 * t9 / 0.6480e4 + (-t286 * b22 / 0.144e3 + t279 * a22 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t276 + t286 * a22 / 0.48e2 - t277 / 0.120e3 - t278 / 0.120e3) * t30 / 0.7e1 + (-t285 + t283 + t284) * t34 / 0.144e3 + c22 * t37 / 0.30e2) + B33 * (-t309 * b23 * t9 / 0.6480e4 + (-t316 * b23 / 0.144e3 + t309 * a23 / 0.240e3) * t8 / 0.8e1 + (c23 * b23 / 0.36e2 + t316 * a23 / 0.48e2) * t30 / 0.7e1 - c23 * a23 * t34 / 0.72e2);
	X(2,3) = B11 * (-t246 * b31 * t9 / 0.6480e4 + (-t253 * b31 / 0.144e3 + t246 * a31 / 0.240e3) * t8 / 0.8e1 + (c21 * b31 / 0.36e2 + t253 * a31 / 0.48e2) * t30 / 0.7e1 - c21 * a31 * t34 / 0.72e2) + B22 * (-t279 * b32 * t9 / 0.6480e4 + (-t286 * b32 / 0.144e3 + t279 * a32 / 0.240e3) * t8 / 0.8e1 + (c22 * b32 / 0.36e2 + t286 * a32 / 0.48e2) * t30 / 0.7e1 - c22 * a32 * t34 / 0.72e2) + B33 * (-t309 * b33 * t9 / 0.6480e4 + (-t316 * b33 / 0.144e3 + t309 * a33 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t308 + t316 * a33 / 0.48e2 - t306 / 0.120e3 - t307 / 0.120e3) * t30 / 0.7e1 + (-t313 + t314 + t315) * t34 / 0.144e3 + c23 * t37 / 0.30e2);
	X(3,1) = B11 * (-t480 * b11 * t9 / 0.6480e4 + (-t487 * b11 / 0.144e3 + t480 * a11 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t477 + t487 * a11 / 0.48e2 - t478 / 0.120e3 - t479 / 0.120e3) * t30 / 0.7e1 + (-t484 + t485 + t486) * t34 / 0.144e3 + c31 * t37 / 0.30e2) + B22 * (-t513 * b12 * t9 / 0.6480e4 + (-t520 * b12 / 0.144e3 + t513 * a12 / 0.240e3) * t8 / 0.8e1 + (c32 * b12 / 0.36e2 + t520 * a12 / 0.48e2) * t30 / 0.7e1 - c32 * a12 * t34 / 0.72e2) + B33 * (-t543 * b13 * t9 / 0.6480e4 + (-t550 * b13 / 0.144e3 + t543 * a13 / 0.240e3) * t8 / 0.8e1 + (c33 * b13 / 0.36e2 + t550 * a13 / 0.48e2) * t30 / 0.7e1 - c33 * a13 * t34 / 0.72e2);
	X(3,2) = B11 * (-t480 * b21 * t9 / 0.6480e4 + (-t487 * b21 / 0.144e3 + t480 * a21 / 0.240e3) * t8 / 0.8e1 + (c31 * b21 / 0.36e2 + t487 * a21 / 0.48e2) * t30 / 0.7e1 - c31 * a21 * t34 / 0.72e2) + B22 * (-t513 * b22 * t9 / 0.6480e4 + (-t520 * b22 / 0.144e3 + t513 * a22 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t510 + t520 * a22 / 0.48e2 - t511 / 0.120e3 - t512 / 0.120e3) * t30 / 0.7e1 + (-t519 + t517 + t518) * t34 / 0.144e3 + c32 * t37 / 0.30e2) + B33 * (-t543 * b23 * t9 / 0.6480e4 + (-t550 * b23 / 0.144e3 + t543 * a23 / 0.240e3) * t8 / 0.8e1 + (c33 * b23 / 0.36e2 + t550 * a23 / 0.48e2) * t30 / 0.7e1 - c33 * a23 * t34 / 0.72e2);
	X(3,3) = B11 * (-t480 * b31 * t9 / 0.6480e4 + (-t487 * b31 / 0.144e3 + t480 * a31 / 0.240e3) * t8 / 0.8e1 + (c31 * b31 / 0.36e2 + t487 * a31 / 0.48e2) * t30 / 0.7e1 - c31 * a31 * t34 / 0.72e2) + B22 * (-t513 * b32 * t9 / 0.6480e4 + (-t520 * b32 / 0.144e3 + t513 * a32 / 0.240e3) * t8 / 0.8e1 + (c32 * b32 / 0.36e2 + t520 * a32 / 0.48e2) * t30 / 0.7e1 - c32 * a32 * t34 / 0.72e2) + B33 * (-t543 * b33 * t9 / 0.6480e4 + (-t550 * b33 / 0.144e3 + t543 * a33 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t542 + t550 * a33 / 0.48e2 - t540 / 0.120e3 - t541 / 0.120e3) * t30 / 0.7e1 + (-t547 + t548 + t549) * t34 / 0.144e3 + c33 * t37 / 0.30e2);

elseif calc==6
	%Maple generated code: B*(diag(sig^2))*Id'
	t1 = T * T;
	t2 = t1 * t1;
	t3 = t2 / 0.24e2;
	t4 = t2 * T;
	t7 = t2 * t1;
	t10 = -t3 - t4 * a11 / 0.120e3 + t7 * b11 / 0.720e3;
	t16 = -t4 * a21 / 0.120e3 + t7 * b21 / 0.720e3;
	t22 = -t4 * a31 / 0.120e3 + t7 * b31 / 0.720e3;
	t30 = -t4 * a12 / 0.120e3 + t7 * b12 / 0.720e3;
	t36 = -t3 - t4 * a22 / 0.120e3 + t7 * b22 / 0.720e3;
	t42 = -t4 * a32 / 0.120e3 + t7 * b32 / 0.720e3;
	t50 = -t4 * a13 / 0.120e3 + t7 * b13 / 0.720e3;
	t56 = -t4 * a23 / 0.120e3 + t7 * b23 / 0.720e3;
	t62 = -t3 - t4 * a33 / 0.120e3 + t7 * b33 / 0.720e3;
	X(1,1) = B11 * (c11 * t10 + c12 * t16 + c13 * t22);
	X(2,3) = B22 * (c11 * t30 + c12 * t36 + c13 * t42);
	X(1,3) = B33 * (c11 * t50 + c12 * t56 + c13 * t62);
	X(2,1) = B11 * (c21 * t10 + c22 * t16 + c23 * t22);
	X(2,2) = B22 * (c21 * t30 + c22 * t36 + c23 * t42);
	X(2,3) = B33 * (c21 * t50 + c22 * t56 + c23 * t62);
	X(3,1) = B11 * (c31 * t10 + c32 * t16 + c33 * t22);
	X(3,2) = B22 * (c31 * t30 + c32 * t36 + c33 * t42);
	X(3,3) = B33 * (c31 * t50 + c32 * t56 + c33 * t62);
	
elseif calc==7
	%Maple generated code: C*(diag(sig^2))*A'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * T;
	t8 = t6 * t6;
	t9 = t8 * t7;
	t15 = c11 * a11 + c12 * a21 + c13 * a31;
	t19 = t8 * t6;
	t27 = t8 * T;
	t36 = c11 * c11;
	t44 = c12 * b22 + c11 * b12 + c13 * b32;
	t51 = c11 * a12 + c13 * a32 + c12 * a22;
	t70 = c12 * c12;
	t78 = c12 * b23 + c11 * b13 + c13 * b33;
	t85 = c13 * a33 + c12 * a23 + c11 * a13;
	t104 = c13 * c13;
	t113 = c21 * b11 + c22 * b21 + c23 * b31;
	t116 = t113 * t4 * t9 / 0.336e3;
	t120 = c21 * a11 + c22 * a21 + c23 * a31;
	t128 = -t120 * t15 / 0.6e1;
	t141 = c11 * c21 * t7 / 0.6e1;
	t147 = c22 * b22 + c21 * b12 + c23 * b32;
	t150 = t147 * t44 * t9 / 0.336e3;
	t154 = c21 * a12 + c23 * a32 + c22 * a22;
	t162 = -t154 * t51 / 0.6e1;
	t175 = c12 * c22 * t7 / 0.6e1;
	t181 = c22 * b23 + c21 * b13 + c23 * b33;
	t184 = t181 * t78 * t9 / 0.336e3;
	t188 = c23 * a33 + c22 * a23 + c21 * a13;
	t196 = -t188 * t85 / 0.6e1;
	t209 = c13 * c23 * t7 / 0.6e1;
	t216 = c31 * b11 + c32 * b21 + c33 * b31;
	t219 = t216 * t4 * t9 / 0.336e3;
	t223 = c31 * a11 + c32 * a21 + c33 * a31;
	t231 = -t223 * t15 / 0.6e1;
	t244 = c11 * c31 * t7 / 0.6e1;
	t250 = c32 * b22 + c31 * b12 + c33 * b32;
	t253 = t250 * t44 * t9 / 0.336e3;
	t257 = c31 * a12 + c33 * a32 + c32 * a22;
	t265 = -t257 * t51 / 0.6e1;
	t278 = c12 * c32 * t7 / 0.6e1;
	t284 = c32 * b23 + c31 * b13 + c33 * b33;
	t287 = t284 * t78 * t9 / 0.336e3;
	t291 = c33 * a33 + c32 * a23 + c31 * a13;
	t299 = -t291 * t85 / 0.6e1;
	t312 = c13 * c33 * t7 / 0.6e1;
	t395 = c21 * c21;
	t421 = c22 * c22;
	t447 = c23 * c23;
	t455 = t216 * t113 * t9 / 0.336e3;
	t463 = -t223 * t120 / 0.6e1;
	t476 = c21 * c31 * t7 / 0.6e1;
	t481 = t250 * t147 * t9 / 0.336e3;
	t489 = -t257 * t154 / 0.6e1;
	t502 = c22 * c32 * t7 / 0.6e1;
	t507 = t284 * t181 * t9 / 0.336e3;
	t515 = -t291 * t188 / 0.6e1;
	t528 = c23 * c33 * t7 / 0.6e1;
	t669 = c31 * c31;
	t695 = c32 * c32;
	t721 = c33 * c33;
	X(1,1) = B11 * (t4 * t4 * t9 / 0.336e3 + t15 * t4 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c11 * t4 - t15 * t15 / 0.6e1) * t27 / 0.5e1 + c11 * t15 * t8 / 0.6e1 - t36 * t7 / 0.6e1) + B22 * (t44 * t44 * t9 / 0.336e3 + t51 * t44 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c12 * t44 - t51 * t51 / 0.6e1) * t27 / 0.5e1 + c12 * t51 * t8 / 0.6e1 - t70 * t7 / 0.6e1) + B33 * (t78 * t78 * t9 / 0.336e3 + t85 * t78 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c13 * t78 - t85 * t85 / 0.6e1) * t27 / 0.5e1 + c13 * t85 * t8 / 0.6e1 - t104 * t7 / 0.6e1);
	X(2,3) = B11 * (t116 + (t120 * t4 / 0.12e2 - t113 * t15 / 0.24e2) * t19 / 0.6e1 + (-c21 * t4 / 0.4e1 + t128 + t113 * c11 / 0.24e2) * t27 / 0.5e1 + (c21 * t15 / 0.2e1 + t120 * c11 / 0.6e1) * t8 / 0.4e1 - t141) + B22 * (t150 + (t154 * t44 / 0.12e2 - t147 * t51 / 0.24e2) * t19 / 0.6e1 + (-c22 * t44 / 0.4e1 + t162 + t147 * c12 / 0.24e2) * t27 / 0.5e1 + (c22 * t51 / 0.2e1 + t154 * c12 / 0.6e1) * t8 / 0.4e1 - t175) + B33 * (t184 + (t188 * t78 / 0.12e2 - t181 * t85 / 0.24e2) * t19 / 0.6e1 + (-c23 * t78 / 0.4e1 + t196 + t181 * c13 / 0.24e2) * t27 / 0.5e1 + (c23 * t85 / 0.2e1 + t188 * c13 / 0.6e1) * t8 / 0.4e1 - t209);
	X(1,3) = B11 * (t219 + (t223 * t4 / 0.12e2 - t216 * t15 / 0.24e2) * t19 / 0.6e1 + (-c31 * t4 / 0.4e1 + t231 + t216 * c11 / 0.24e2) * t27 / 0.5e1 + (c31 * t15 / 0.2e1 + t223 * c11 / 0.6e1) * t8 / 0.4e1 - t244) + B22 * (t253 + (t257 * t44 / 0.12e2 - t250 * t51 / 0.24e2) * t19 / 0.6e1 + (-c32 * t44 / 0.4e1 + t265 + t250 * c12 / 0.24e2) * t27 / 0.5e1 + (c32 * t51 / 0.2e1 + t257 * c12 / 0.6e1) * t8 / 0.4e1 - t278) + B33 * (t287 + (t291 * t78 / 0.12e2 - t284 * t85 / 0.24e2) * t19 / 0.6e1 + (-c33 * t78 / 0.4e1 + t299 + t284 * c13 / 0.24e2) * t27 / 0.5e1 + (c33 * t85 / 0.2e1 + t291 * c13 / 0.6e1) * t8 / 0.4e1 - t312);
	X(2,1) = B11 * (t116 + (t113 * t15 / 0.12e2 - t120 * t4 / 0.24e2) * t19 / 0.6e1 + (-t113 * c11 / 0.4e1 + t128 + c21 * t4 / 0.24e2) * t27 / 0.5e1 + (t120 * c11 / 0.2e1 + c21 * t15 / 0.6e1) * t8 / 0.4e1 - t141) + B22 * (t150 + (t147 * t51 / 0.12e2 - t154 * t44 / 0.24e2) * t19 / 0.6e1 + (-t147 * c12 / 0.4e1 + t162 + c22 * t44 / 0.24e2) * t27 / 0.5e1 + (t154 * c12 / 0.2e1 + c22 * t51 / 0.6e1) * t8 / 0.4e1 - t175) + B33 * (t184 + (t181 * t85 / 0.12e2 - t188 * t78 / 0.24e2) * t19 / 0.6e1 + (-t181 * c13 / 0.4e1 + t196 + c23 * t78 / 0.24e2) * t27 / 0.5e1 + (t188 * c13 / 0.2e1 + c23 * t85 / 0.6e1) * t8 / 0.4e1 - t209);
	X(2,2) = B11 * (t113 * t113 * t9 / 0.336e3 + t120 * t113 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c21 * t113 - t120 * t120 / 0.6e1) * t27 / 0.5e1 + c21 * t120 * t8 / 0.6e1 - t395 * t7 / 0.6e1) + B22 * (t147 * t147 * t9 / 0.336e3 + t154 * t147 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c22 * t147 - t154 * t154 / 0.6e1) * t27 / 0.5e1 + c22 * t154 * t8 / 0.6e1 - t421 * t7 / 0.6e1) + B33 * (t181 * t181 * t9 / 0.336e3 + t188 * t181 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c23 * t181 - t188 * t188 / 0.6e1) * t27 / 0.5e1 + c23 * t188 * t8 / 0.6e1 - t447 * t7 / 0.6e1);
	X(2,3) = B11 * (t455 + (t223 * t113 / 0.12e2 - t216 * t120 / 0.24e2) * t19 / 0.6e1 + (-c31 * t113 / 0.4e1 + t463 + t216 * c21 / 0.24e2) * t27 / 0.5e1 + (c31 * t120 / 0.2e1 + t223 * c21 / 0.6e1) * t8 / 0.4e1 - t476) + B22 * (t481 + (t257 * t147 / 0.12e2 - t250 * t154 / 0.24e2) * t19 / 0.6e1 + (-c32 * t147 / 0.4e1 + t489 + t250 * c22 / 0.24e2) * t27 / 0.5e1 + (c32 * t154 / 0.2e1 + t257 * c22 / 0.6e1) * t8 / 0.4e1 - t502) + B33 * (t507 + (t291 * t181 / 0.12e2 - t284 * t188 / 0.24e2) * t19 / 0.6e1 + (-c33 * t181 / 0.4e1 + t515 + t284 * c23 / 0.24e2) * t27 / 0.5e1 + (c33 * t188 / 0.2e1 + t291 * c23 / 0.6e1) * t8 / 0.4e1 - t528);
	X(3,1) = B11 * (t219 + (t216 * t15 / 0.12e2 - t223 * t4 / 0.24e2) * t19 / 0.6e1 + (-t216 * c11 / 0.4e1 + t231 + c31 * t4 / 0.24e2) * t27 / 0.5e1 + (t223 * c11 / 0.2e1 + c31 * t15 / 0.6e1) * t8 / 0.4e1 - t244) + B22 * (t253 + (t250 * t51 / 0.12e2 - t257 * t44 / 0.24e2) * t19 / 0.6e1 + (-t250 * c12 / 0.4e1 + t265 + c32 * t44 / 0.24e2) * t27 / 0.5e1 + (t257 * c12 / 0.2e1 + c32 * t51 / 0.6e1) * t8 / 0.4e1 - t278) + B33 * (t287 + (t284 * t85 / 0.12e2 - t291 * t78 / 0.24e2) * t19 / 0.6e1 + (-t284 * c13 / 0.4e1 + t299 + c33 * t78 / 0.24e2) * t27 / 0.5e1 + (t291 * c13 / 0.2e1 + c33 * t85 / 0.6e1) * t8 / 0.4e1 - t312);
	X(3,2) = B11 * (t455 + (t216 * t120 / 0.12e2 - t223 * t113 / 0.24e2) * t19 / 0.6e1 + (-t216 * c21 / 0.4e1 + t463 + c31 * t113 / 0.24e2) * t27 / 0.5e1 + (t223 * c21 / 0.2e1 + c31 * t120 / 0.6e1) * t8 / 0.4e1 - t476) + B22 * (t481 + (t250 * t154 / 0.12e2 - t257 * t147 / 0.24e2) * t19 / 0.6e1 + (-t250 * c22 / 0.4e1 + t489 + c32 * t147 / 0.24e2) * t27 / 0.5e1 + (t257 * c22 / 0.2e1 + c32 * t154 / 0.6e1) * t8 / 0.4e1 - t502) + B33 * (t507 + (t284 * t188 / 0.12e2 - t291 * t181 / 0.24e2) * t19 / 0.6e1 + (-t284 * c23 / 0.4e1 + t515 + c33 * t181 / 0.24e2) * t27 / 0.5e1 + (t291 * c23 / 0.2e1 + c33 * t188 / 0.6e1) * t8 / 0.4e1 - t528);
	X(3,3) = B11 * (t216 * t216 * t9 / 0.336e3 + t223 * t216 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c31 * t216 - t223 * t223 / 0.6e1) * t27 / 0.5e1 + c31 * t223 * t8 / 0.6e1 - t669 * t7 / 0.6e1) + B22 * (t250 * t250 * t9 / 0.336e3 + t257 * t250 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c32 * t250 - t257 * t257 / 0.6e1) * t27 / 0.5e1 + c32 * t257 * t8 / 0.6e1 - t695 * t7 / 0.6e1) + B33 * (t284 * t284 * t9 / 0.336e3 + t291 * t284 * t19 / 0.144e3 + (-0.5e1 / 0.24e2 * c33 * t284 - t291 * t291 / 0.6e1) * t27 / 0.5e1 + c33 * t291 * t8 / 0.6e1 - t721 * t7 / 0.6e1);

elseif calc==8
	%Maple generated code: D*(diag(sig^2))*B'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t9 = t8 * t6;
	t15 = c11 * a11 + c12 * a21 + c13 * a31;
	t19 = t8 * T;
	t36 = t7 * t6 * T;
	t39 = c11 * c11;
	t40 = t7 * t6;
	t48 = c12 * b22 + c11 * b12 + c13 * b32;
	t55 = c11 * a12 + c13 * a32 + c12 * a22;
	t76 = c12 * c12;
	t84 = c12 * b23 + c11 * b13 + c13 * b33;
	t91 = c13 * a33 + c12 * a23 + c11 * a13;
	t112 = c13 * c13;
	t121 = c21 * b11 + c22 * b21 + c23 * b31;
	t124 = t4 * t121 * t9 / 0.28800e5;
	t129 = -c21 * a11 - c22 * a21 - c23 * a31;
	t136 = t15 * t129 / 0.144e3;
	t151 = c21 * c11 * t40 / 0.72e2;
	t157 = c22 * b22 + c21 * b12 + c23 * b32;
	t160 = t48 * t157 * t9 / 0.28800e5;
	t165 = -c21 * a12 - c23 * a32 - c22 * a22;
	t172 = t55 * t165 / 0.144e3;
	t187 = c22 * c12 * t40 / 0.72e2;
	t193 = c22 * b23 + c21 * b13 + c23 * b33;
	t196 = t84 * t193 * t9 / 0.28800e5;
	t201 = -c23 * a33 - c22 * a23 - c21 * a13;
	t208 = t91 * t201 / 0.144e3;
	t223 = c23 * c13 * t40 / 0.72e2;
	t230 = c31 * b11 + c32 * b21 + c33 * b31;
	t233 = t4 * t230 * t9 / 0.28800e5;
	t238 = -c31 * a11 - c32 * a21 - c33 * a31;
	t245 = t15 * t238 / 0.144e3;
	t260 = c31 * c11 * t40 / 0.72e2;
	t266 = c32 * b22 + c31 * b12 + c33 * b32;
	t269 = t48 * t266 * t9 / 0.28800e5;
	t274 = -c31 * a12 - c33 * a32 - c32 * a22;
	t281 = t55 * t274 / 0.144e3;
	t296 = c32 * c12 * t40 / 0.72e2;
	t302 = c32 * b23 + c31 * b13 + c33 * b33;
	t305 = t84 * t302 * t9 / 0.28800e5;
	t310 = -c33 * a33 - c32 * a23 - c31 * a13;
	t317 = t91 * t310 / 0.144e3;
	t332 = c33 * c13 * t40 / 0.72e2;
	t423 = c21 * c21;
	t451 = c22 * c22;
	t479 = c23 * c23;
	t487 = t121 * t230 * t9 / 0.28800e5;
	t495 = -t129 * t238 / 0.144e3;
	t510 = c31 * c21 * t40 / 0.72e2;
	t515 = t157 * t266 * t9 / 0.28800e5;
	t523 = -t165 * t274 / 0.144e3;
	t538 = c32 * c22 * t40 / 0.72e2;
	t543 = t193 * t302 * t9 / 0.28800e5;
	t551 = -t201 * t310 / 0.144e3;
	t566 = c33 * c23 * t40 / 0.72e2;
	t721 = c31 * c31;
	t749 = c32 * c32;
	t777 = c33 * c33;
	X(1,1) = -B11 * (t4 * t4 * t9 / 0.28800e5 - t15 * t4 * t19 / 0.25920e5 + (-c11 * t4 / 0.90e2 - t15 * t15 / 0.144e3) * t8 / 0.8e1 - t15 * c11 * t36 / 0.1008e4 + t39 * t40 / 0.72e2) - B22 * (t48 * t48 * t9 / 0.28800e5 - t55 * t48 * t19 / 0.25920e5 + (-c12 * t48 / 0.90e2 - t55 * t55 / 0.144e3) * t8 / 0.8e1 - t55 * c12 * t36 / 0.1008e4 + t76 * t40 / 0.72e2) - B33 * (t84 * t84 * t9 / 0.28800e5 - t91 * t84 * t19 / 0.25920e5 + (-c13 * t84 / 0.90e2 - t91 * t91 / 0.144e3) * t8 / 0.8e1 - t91 * c13 * t36 / 0.1008e4 + t112 * t40 / 0.72e2);
	X(2,3) = -B11 * (t124 + (t15 * t121 / 0.720e3 + t4 * t129 / 0.576e3) * t19 / 0.9e1 + (-c11 * t121 / 0.240e3 + t136 - c21 * t4 / 0.144e3) * t8 / 0.8e1 + (-c11 * t129 / 0.48e2 - c21 * t15 / 0.36e2) * t36 / 0.7e1 + t151) - B22 * (t160 + (t55 * t157 / 0.720e3 + t48 * t165 / 0.576e3) * t19 / 0.9e1 + (-c12 * t157 / 0.240e3 + t172 - t48 * c22 / 0.144e3) * t8 / 0.8e1 + (-c12 * t165 / 0.48e2 - t55 * c22 / 0.36e2) * t36 / 0.7e1 + t187) - B33 * (t196 + (t91 * t193 / 0.720e3 + t84 * t201 / 0.576e3) * t19 / 0.9e1 + (-c13 * t193 / 0.240e3 + t208 - t84 * c23 / 0.144e3) * t8 / 0.8e1 + (-c13 * t201 / 0.48e2 - t91 * c23 / 0.36e2) * t36 / 0.7e1 + t223);
	X(1,3) = -B11 * (t233 + (t15 * t230 / 0.720e3 + t4 * t238 / 0.576e3) * t19 / 0.9e1 + (-c11 * t230 / 0.240e3 + t245 - c31 * t4 / 0.144e3) * t8 / 0.8e1 + (-c11 * t238 / 0.48e2 - c31 * t15 / 0.36e2) * t36 / 0.7e1 + t260) - B22 * (t269 + (t55 * t266 / 0.720e3 + t48 * t274 / 0.576e3) * t19 / 0.9e1 + (-c12 * t266 / 0.240e3 + t281 - t48 * c32 / 0.144e3) * t8 / 0.8e1 + (-c12 * t274 / 0.48e2 - t55 * c32 / 0.36e2) * t36 / 0.7e1 + t296) - B33 * (t305 + (t91 * t302 / 0.720e3 + t84 * t310 / 0.576e3) * t19 / 0.9e1 + (-c13 * t302 / 0.240e3 + t317 - t84 * c33 / 0.144e3) * t8 / 0.8e1 + (-c13 * t310 / 0.48e2 - t91 * c33 / 0.36e2) * t36 / 0.7e1 + t332);
	X(2,1) = -B11 * (t124 + (-t4 * t129 / 0.720e3 - t15 * t121 / 0.576e3) * t19 / 0.9e1 + (-c21 * t4 / 0.240e3 + t136 - c11 * t121 / 0.144e3) * t8 / 0.8e1 + (c21 * t15 / 0.48e2 + c11 * t129 / 0.36e2) * t36 / 0.7e1 + t151) - B22 * (t160 + (-t48 * t165 / 0.720e3 - t55 * t157 / 0.576e3) * t19 / 0.9e1 + (-t48 * c22 / 0.240e3 + t172 - c12 * t157 / 0.144e3) * t8 / 0.8e1 + (t55 * c22 / 0.48e2 + c12 * t165 / 0.36e2) * t36 / 0.7e1 + t187) - B33 * (t196 + (-t84 * t201 / 0.720e3 - t91 * t193 / 0.576e3) * t19 / 0.9e1 + (-t84 * c23 / 0.240e3 + t208 - c13 * t193 / 0.144e3) * t8 / 0.8e1 + (t91 * c23 / 0.48e2 + c13 * t201 / 0.36e2) * t36 / 0.7e1 + t223);
	X(2,2) = -B11 * (t121 * t121 * t9 / 0.28800e5 + t129 * t121 * t19 / 0.25920e5 + (-c21 * t121 / 0.90e2 - t129 * t129 / 0.144e3) * t8 / 0.8e1 + t129 * c21 * t36 / 0.1008e4 + t423 * t40 / 0.72e2) - B22 * (t157 * t157 * t9 / 0.28800e5 + t165 * t157 * t19 / 0.25920e5 + (-c22 * t157 / 0.90e2 - t165 * t165 / 0.144e3) * t8 / 0.8e1 + t165 * c22 * t36 / 0.1008e4 + t451 * t40 / 0.72e2) - B33 * (t193 * t193 * t9 / 0.28800e5 + t201 * t193 * t19 / 0.25920e5 + (-c23 * t193 / 0.90e2 - t201 * t201 / 0.144e3) * t8 / 0.8e1 + t201 * c23 * t36 / 0.1008e4 + t479 * t40 / 0.72e2);
	X(2,3) = -B11 * (t487 + (-t129 * t230 / 0.720e3 + t121 * t238 / 0.576e3) * t19 / 0.9e1 + (-c21 * t230 / 0.240e3 + t495 - t121 * c31 / 0.144e3) * t8 / 0.8e1 + (-c21 * t238 / 0.48e2 + t129 * c31 / 0.36e2) * t36 / 0.7e1 + t510) - B22 * (t515 + (-t165 * t266 / 0.720e3 + t157 * t274 / 0.576e3) * t19 / 0.9e1 + (-c22 * t266 / 0.240e3 + t523 - t157 * c32 / 0.144e3) * t8 / 0.8e1 + (-c22 * t274 / 0.48e2 + t165 * c32 / 0.36e2) * t36 / 0.7e1 + t538) - B33 * (t543 + (-t201 * t302 / 0.720e3 + t193 * t310 / 0.576e3) * t19 / 0.9e1 + (-c23 * t302 / 0.240e3 + t551 - t193 * c33 / 0.144e3) * t8 / 0.8e1 + (-c23 * t310 / 0.48e2 + t201 * c33 / 0.36e2) * t36 / 0.7e1 + t566);
	X(3,1) = -B11 * (t233 + (-t4 * t238 / 0.720e3 - t15 * t230 / 0.576e3) * t19 / 0.9e1 + (-c31 * t4 / 0.240e3 + t245 - c11 * t230 / 0.144e3) * t8 / 0.8e1 + (c31 * t15 / 0.48e2 + c11 * t238 / 0.36e2) * t36 / 0.7e1 + t260) - B22 * (t269 + (-t48 * t274 / 0.720e3 - t55 * t266 / 0.576e3) * t19 / 0.9e1 + (-t48 * c32 / 0.240e3 + t281 - c12 * t266 / 0.144e3) * t8 / 0.8e1 + (t55 * c32 / 0.48e2 + c12 * t274 / 0.36e2) * t36 / 0.7e1 + t296) - B33 * (t305 + (-t84 * t310 / 0.720e3 - t91 * t302 / 0.576e3) * t19 / 0.9e1 + (-t84 * c33 / 0.240e3 + t317 - c13 * t302 / 0.144e3) * t8 / 0.8e1 + (t91 * c33 / 0.48e2 + c13 * t310 / 0.36e2) * t36 / 0.7e1 + t332);
	X(3,2) = -B11 * (t487 + (-t121 * t238 / 0.720e3 + t129 * t230 / 0.576e3) * t19 / 0.9e1 + (-t121 * c31 / 0.240e3 + t495 - c21 * t230 / 0.144e3) * t8 / 0.8e1 + (-t129 * c31 / 0.48e2 + c21 * t238 / 0.36e2) * t36 / 0.7e1 + t510) - B22 * (t515 + (-t157 * t274 / 0.720e3 + t165 * t266 / 0.576e3) * t19 / 0.9e1 + (-t157 * c32 / 0.240e3 + t523 - c22 * t266 / 0.144e3) * t8 / 0.8e1 + (-t165 * c32 / 0.48e2 + c22 * t274 / 0.36e2) * t36 / 0.7e1 + t538) - B33 * (t543 + (-t193 * t310 / 0.720e3 + t201 * t302 / 0.576e3) * t19 / 0.9e1 + (-t193 * c33 / 0.240e3 + t551 - c23 * t302 / 0.144e3) * t8 / 0.8e1 + (-t201 * c33 / 0.48e2 + c23 * t310 / 0.36e2) * t36 / 0.7e1 + t566);
	X(3,3) = -B11 * (t230 * t230 * t9 / 0.28800e5 + t238 * t230 * t19 / 0.25920e5 + (-c31 * t230 / 0.90e2 - t238 * t238 / 0.144e3) * t8 / 0.8e1 + t238 * c31 * t36 / 0.1008e4 + t721 * t40 / 0.72e2) - B22 * (t266 * t266 * t9 / 0.28800e5 + t274 * t266 * t19 / 0.25920e5 + (-c32 * t266 / 0.90e2 - t274 * t274 / 0.144e3) * t8 / 0.8e1 + t274 * c32 * t36 / 0.1008e4 + t749 * t40 / 0.72e2) - B33 * (t302 * t302 * t9 / 0.28800e5 + t310 * t302 * t19 / 0.25920e5 + (-c33 * t302 / 0.90e2 - t310 * t310 / 0.144e3) * t8 / 0.8e1 + t310 * c33 * t36 / 0.1008e4 + t777 * t40 / 0.72e2);

elseif calc==9
	%Maple generated code: C*(diag(sig^2))*C'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * T;
	t14 = -c11 * a11 - c12 * a21 - c13 * a31;
	t20 = t14 * t14;
	t22 = t6 * T;
	t27 = c11 * c11;
	t34 = c12 * b22 + c11 * b12 + c13 * b32;
	t41 = -c11 * a12 - c13 * a32 - c12 * a22;
	t47 = t41 * t41;
	t53 = c12 * c12;
	t60 = c12 * b23 + c11 * b13 + c13 * b33;
	t67 = -c13 * a33 - c12 * a23 - c11 * a13;
	t73 = t67 * t67;
	t79 = c13 * c13;
	t87 = c21 * b11 + c22 * b21 + c23 * b31;
	t95 = -c21 * a11 - c22 * a21 - c23 * a31;
	t118 = c22 * b22 + c21 * b12 + c23 * b32;
	t126 = -c21 * a12 - c23 * a32 - c22 * a22;
	t149 = c22 * b23 + c21 * b13 + c23 * b33;
	t157 = -c23 * a33 - c22 * a23 - c21 * a13;
	t177 = B11 * (t4 * t87 * t8 / 0.20e2 + (t14 * t87 / 0.2e1 + t4 * t95 / 0.2e1) * t7 / 0.4e1 + (c11 * t87 / 0.2e1 + t14 * t95 + c21 * t4 / 0.2e1) * t22 / 0.3e1 + (c11 * t95 + c21 * t14) * t6 / 0.2e1 + c11 * c21 * T) + B22 * (t34 * t118 * t8 / 0.20e2 + (t41 * t118 / 0.2e1 + t34 * t126 / 0.2e1) * t7 / 0.4e1 + (c12 * t118 / 0.2e1 + t41 * t126 + c22 * t34 / 0.2e1) * t22 / 0.3e1 + (c12 * t126 + c22 * t41) * t6 / 0.2e1 + c12 * c22 * T) + B33 * (t60 * t149 * t8 / 0.20e2 + (t67 * t149 / 0.2e1 + t60 * t157 / 0.2e1) * t7 / 0.4e1 + (c13 * t149 / 0.2e1 + t67 * t157 + c23 * t60 / 0.2e1) * t22 / 0.3e1 + (c13 * t157 + c23 * t67) * t6 / 0.2e1 + c13 * c23 * T);
	t181 = c31 * b11 + c32 * b21 + c33 * b31;
	t189 = -c31 * a11 - c32 * a21 - c33 * a31;
	t212 = c32 * b22 + c31 * b12 + c33 * b32;
	t220 = -c31 * a12 - c33 * a32 - c32 * a22;
	t243 = c32 * b23 + c31 * b13 + c33 * b33;
	t251 = -c33 * a33 - c32 * a23 - c31 * a13;
	t271 = B11 * (t4 * t181 * t8 / 0.20e2 + (t14 * t181 / 0.2e1 + t4 * t189 / 0.2e1) * t7 / 0.4e1 + (c11 * t181 / 0.2e1 + t14 * t189 + c31 * t4 / 0.2e1) * t22 / 0.3e1 + (c11 * t189 + c31 * t14) * t6 / 0.2e1 + c11 * c31 * T) + B22 * (t34 * t212 * t8 / 0.20e2 + (t41 * t212 / 0.2e1 + t34 * t220 / 0.2e1) * t7 / 0.4e1 + (c12 * t212 / 0.2e1 + t41 * t220 + c32 * t34 / 0.2e1) * t22 / 0.3e1 + (c12 * t220 + c32 * t41) * t6 / 0.2e1 + c12 * c32 * T) + B33 * (t60 * t243 * t8 / 0.20e2 + (t67 * t243 / 0.2e1 + t60 * t251 / 0.2e1) * t7 / 0.4e1 + (c13 * t243 / 0.2e1 + t67 * t251 + c33 * t60 / 0.2e1) * t22 / 0.3e1 + (c13 * t251 + c33 * t67) * t6 / 0.2e1 + c13 * c33 * T);
	t280 = t95 * t95;
	t286 = c21 * c21;
	t298 = t126 * t126;
	t304 = c22 * c22;
	t316 = t157 * t157;
	t322 = c23 * c23;
	t396 = B11 * (t87 * t181 * t8 / 0.20e2 + (t95 * t181 / 0.2e1 + t87 * t189 / 0.2e1) * t7 / 0.4e1 + (c21 * t181 / 0.2e1 + t95 * t189 + c31 * t87 / 0.2e1) * t22 / 0.3e1 + (c21 * t189 + c31 * t95) * t6 / 0.2e1 + c21 * c31 * T) + B22 * (t118 * t212 * t8 / 0.20e2 + (t126 * t212 / 0.2e1 + t118 * t220 / 0.2e1) * t7 / 0.4e1 + (c22 * t212 / 0.2e1 + t126 * t220 + c32 * t118 / 0.2e1) * t22 / 0.3e1 + (c22 * t220 + c32 * t126) * t6 / 0.2e1 + c22 * c32 * T) + B33 * (t149 * t243 * t8 / 0.20e2 + (t157 * t243 / 0.2e1 + t149 * t251 / 0.2e1) * t7 / 0.4e1 + (c23 * t243 / 0.2e1 + t157 * t251 + c33 * t149 / 0.2e1) * t22 / 0.3e1 + (c23 * t251 + c33 * t157) * t6 / 0.2e1 + c23 * c33 * T);
	t405 = t189 * t189;
	t411 = c31 * c31;
	t423 = t220 * t220;
	t429 = c32 * c32;
	t441 = t251 * t251;
	t447 = c33 * c33;
	X(1,1) = B11 * (t4 * t4 * t8 / 0.20e2 + t14 * t4 * t7 / 0.4e1 + (c11 * t4 + t20) * t22 / 0.3e1 + c11 * t14 * t6 + t27 * T) + B22 * (t34 * t34 * t8 / 0.20e2 + t41 * t34 * t7 / 0.4e1 + (c12 * t34 + t47) * t22 / 0.3e1 + c12 * t41 * t6 + t53 * T) + B33 * (t60 * t60 * t8 / 0.20e2 + t67 * t60 * t7 / 0.4e1 + (c13 * t60 + t73) * t22 / 0.3e1 + c13 * t67 * t6 + t79 * T);
	X(2,3) = t177;
	X(1,3) = t271;
	X(2,1) = t177;
	X(2,2) = B11 * (t87 * t87 * t8 / 0.20e2 + t95 * t87 * t7 / 0.4e1 + (c21 * t87 + t280) * t22 / 0.3e1 + c21 * t95 * t6 + t286 * T) + B22 * (t118 * t118 * t8 / 0.20e2 + t126 * t118 * t7 / 0.4e1 + (c22 * t118 + t298) * t22 / 0.3e1 + c22 * t126 * t6 + t304 * T) + B33 * (t149 * t149 * t8 / 0.20e2 + t157 * t149 * t7 / 0.4e1 + (c23 * t149 + t316) * t22 / 0.3e1 + c23 * t157 * t6 + t322 * T);
	X(2,3) = t396;
	X(3,1) = t271;
	X(3,2) = t396;
	X(3,3) = B11 * (t181 * t181 * t8 / 0.20e2 + t189 * t181 * t7 / 0.4e1 + (c31 * t181 + t405) * t22 / 0.3e1 + c31 * t189 * t6 + t411 * T) + B22 * (t212 * t212 * t8 / 0.20e2 + t220 * t212 * t7 / 0.4e1 + (c32 * t212 + t423) * t22 / 0.3e1 + c32 * t220 * t6 + t429 * T) + B33 * (t243 * t243 * t8 / 0.20e2 + t251 * t243 * t7 / 0.4e1 + (c33 * t243 + t441) * t22 / 0.3e1 + c33 * t251 * t6 + t447 * T);

elseif calc==10
	%Maple generated code: D*(diag(sig^2))*D'
	t4 = c11 * b11 + c12 * b21 + c13 * b31;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t9 = t8 * T;
	t15 = c11 * a11 + c12 * a21 + c13 * a31;
	t27 = t7 * t6 * T;
	t33 = t7 * t6;
	t36 = c11 * c11;
	t37 = t7 * T;
	t45 = c12 * b22 + c11 * b12 + c13 * b32;
	t52 = c11 * a12 + c13 * a32 + c12 * a22;
	t70 = c12 * c12;
	t78 = c12 * b23 + c11 * b13 + c13 * b33;
	t85 = c13 * a33 + c12 * a23 + c11 * a13;
	t103 = c13 * c13;
	t112 = -c21 * b11 - c22 * b21 - c23 * b31;
	t115 = t4 * t112 * t9 / 0.5184e4;
	t120 = -c21 * a11 - c22 * a21 - c23 * a31;
	t124 = (t15 * t112 / 0.144e3 + t4 * t120 / 0.144e3) * t8 / 0.8e1;
	t127 = t15 * t120 / 0.36e2;
	t140 = c11 * c21 * t37 / 0.20e2;
	t146 = -c22 * b22 - c21 * b12 - c23 * b32;
	t149 = t45 * t146 * t9 / 0.5184e4;
	t154 = -c21 * a12 - c23 * a32 - c22 * a22;
	t158 = (t52 * t146 / 0.144e3 + t45 * t154 / 0.144e3) * t8 / 0.8e1;
	t161 = t52 * t154 / 0.36e2;
	t174 = c12 * c22 * t37 / 0.20e2;
	t180 = -c22 * b23 - c21 * b13 - c23 * b33;
	t183 = t78 * t180 * t9 / 0.5184e4;
	t188 = -c23 * a33 - c22 * a23 - c21 * a13;
	t192 = (t85 * t180 / 0.144e3 + t78 * t188 / 0.144e3) * t8 / 0.8e1;
	t195 = t85 * t188 / 0.36e2;
	t208 = c13 * c23 * t37 / 0.20e2;
	t215 = -c31 * b11 - c32 * b21 - c33 * b31;
	t218 = t4 * t215 * t9 / 0.5184e4;
	t223 = -c31 * a11 - c32 * a21 - c33 * a31;
	t227 = (t15 * t215 / 0.144e3 + t4 * t223 / 0.144e3) * t8 / 0.8e1;
	t230 = t15 * t223 / 0.36e2;
	t243 = c11 * c31 * t37 / 0.20e2;
	t249 = -c32 * b22 - c31 * b12 - c33 * b32;
	t252 = t45 * t249 * t9 / 0.5184e4;
	t257 = -c31 * a12 - c33 * a32 - c32 * a22;
	t261 = (t52 * t249 / 0.144e3 + t45 * t257 / 0.144e3) * t8 / 0.8e1;
	t264 = t52 * t257 / 0.36e2;
	t277 = c12 * c32 * t37 / 0.20e2;
	t283 = -c32 * b23 - c31 * b13 - c33 * b33;
	t286 = t78 * t283 * t9 / 0.5184e4;
	t291 = -c33 * a33 - c32 * a23 - c31 * a13;
	t295 = (t85 * t283 / 0.144e3 + t78 * t291 / 0.144e3) * t8 / 0.8e1;
	t298 = t85 * t291 / 0.36e2;
	t311 = c13 * c33 * t37 / 0.20e2;
	t378 = c21 * c21;
	t403 = c22 * c22;
	t428 = c23 * c23;
	t436 = -t112 * t215 * t9 / 0.5184e4;
	t441 = (-t120 * t215 / 0.144e3 - t112 * t223 / 0.144e3) * t8 / 0.8e1;
	t444 = -t120 * t223 / 0.36e2;
	t457 = c21 * c31 * t37 / 0.20e2;
	t462 = -t146 * t249 * t9 / 0.5184e4;
	t467 = (-t154 * t249 / 0.144e3 - t146 * t257 / 0.144e3) * t8 / 0.8e1;
	t470 = -t154 * t257 / 0.36e2;
	t483 = c22 * c32 * t37 / 0.20e2;
	t488 = -t180 * t283 * t9 / 0.5184e4;
	t493 = (-t188 * t283 / 0.144e3 - t180 * t291 / 0.144e3) * t8 / 0.8e1;
	t496 = -t188 * t291 / 0.36e2;
	t509 = c23 * c33 * t37 / 0.20e2;
	t619 = c31 * c31;
	t644 = c32 * c32;
	t669 = c33 * c33;
	X(1,1) = -B11 * (-t4 * t4 * t9 / 0.5184e4 - t15 * t4 * t8 / 0.576e3 + (c11 * t4 / 0.24e2 - t15 * t15 / 0.36e2) * t27 / 0.7e1 + c11 * t15 * t33 / 0.36e2 - t36 * t37 / 0.20e2) - B22 * (-t45 * t45 * t9 / 0.5184e4 - t52 * t45 * t8 / 0.576e3 + (c12 * t45 / 0.24e2 - t52 * t52 / 0.36e2) * t27 / 0.7e1 + c12 * t52 * t33 / 0.36e2 - t70 * t37 / 0.20e2) - B33 * (-t78 * t78 * t9 / 0.5184e4 - t85 * t78 * t8 / 0.576e3 + (c13 * t78 / 0.24e2 - t85 * t85 / 0.36e2) * t27 / 0.7e1 + c13 * t85 * t33 / 0.36e2 - t103 * t37 / 0.20e2);
	X(2,3) = -B11 * (t115 + t124 + (-c11 * t112 / 0.48e2 + t127 + c21 * t4 / 0.48e2) * t27 / 0.7e1 + (-c11 * t120 / 0.6e1 + t15 * c21 / 0.6e1) * t33 / 0.12e2 - t140) - B22 * (t149 + t158 + (-c12 * t146 / 0.48e2 + t161 + t45 * c22 / 0.48e2) * t27 / 0.7e1 + (-c12 * t154 / 0.6e1 + t52 * c22 / 0.6e1) * t33 / 0.12e2 - t174) - B33 * (t183 + t192 + (-c13 * t180 / 0.48e2 + t195 + t78 * c23 / 0.48e2) * t27 / 0.7e1 + (-c13 * t188 / 0.6e1 + t85 * c23 / 0.6e1) * t33 / 0.12e2 - t208);
	X(1,3) = -B11 * (t218 + t227 + (-c11 * t215 / 0.48e2 + t230 + c31 * t4 / 0.48e2) * t27 / 0.7e1 + (-c11 * t223 / 0.6e1 + t15 * c31 / 0.6e1) * t33 / 0.12e2 - t243) - B22 * (t252 + t261 + (-c12 * t249 / 0.48e2 + t264 + t45 * c32 / 0.48e2) * t27 / 0.7e1 + (-c12 * t257 / 0.6e1 + t52 * c32 / 0.6e1) * t33 / 0.12e2 - t277) - B33 * (t286 + t295 + (-c13 * t283 / 0.48e2 + t298 + t78 * c33 / 0.48e2) * t27 / 0.7e1 + (-c13 * t291 / 0.6e1 + t85 * c33 / 0.6e1) * t33 / 0.12e2 - t311);
	X(2,1) = -B11 * (t115 + t124 + (-c11 * t112 / 0.48e2 + t127 + c21 * t4 / 0.48e2) * t27 / 0.7e1 + (-c11 * t120 / 0.6e1 + t15 * c21 / 0.6e1) * t33 / 0.12e2 - t140) - B22 * (t149 + t158 + (-c12 * t146 / 0.48e2 + t161 + t45 * c22 / 0.48e2) * t27 / 0.7e1 + (-c12 * t154 / 0.6e1 + t52 * c22 / 0.6e1) * t33 / 0.12e2 - t174) - B33 * (t183 + t192 + (-c13 * t180 / 0.48e2 + t195 + t78 * c23 / 0.48e2) * t27 / 0.7e1 + (-c13 * t188 / 0.6e1 + t85 * c23 / 0.6e1) * t33 / 0.12e2 - t208);
	X(2,2) = -B11 * (-t112 * t112 * t9 / 0.5184e4 - t120 * t112 * t8 / 0.576e3 + (-c21 * t112 / 0.24e2 - t120 * t120 / 0.36e2) * t27 / 0.7e1 - c21 * t120 * t33 / 0.36e2 - t378 * t37 / 0.20e2) - B22 * (-t146 * t146 * t9 / 0.5184e4 - t154 * t146 * t8 / 0.576e3 + (-c22 * t146 / 0.24e2 - t154 * t154 / 0.36e2) * t27 / 0.7e1 - c22 * t154 * t33 / 0.36e2 - t403 * t37 / 0.20e2) - B33 * (-t180 * t180 * t9 / 0.5184e4 - t188 * t180 * t8 / 0.576e3 + (-c23 * t180 / 0.24e2 - t188 * t188 / 0.36e2) * t27 / 0.7e1 - c23 * t188 * t33 / 0.36e2 - t428 * t37 / 0.20e2);
	X(2,3) = -B11 * (t436 + t441 + (-c21 * t215 / 0.48e2 + t444 - t112 * c31 / 0.48e2) * t27 / 0.7e1 + (-c21 * t223 / 0.6e1 - t120 * c31 / 0.6e1) * t33 / 0.12e2 - t457) - B22 * (t462 + t467 + (-c22 * t249 / 0.48e2 + t470 - t146 * c32 / 0.48e2) * t27 / 0.7e1 + (-c22 * t257 / 0.6e1 - t154 * c32 / 0.6e1) * t33 / 0.12e2 - t483) - B33 * (t488 + t493 + (-c23 * t283 / 0.48e2 + t496 - t180 * c33 / 0.48e2) * t27 / 0.7e1 + (-c23 * t291 / 0.6e1 - t188 * c33 / 0.6e1) * t33 / 0.12e2 - t509);
	X(3,1) = -B11 * (t218 + t227 + (-c11 * t215 / 0.48e2 + t230 + c31 * t4 / 0.48e2) * t27 / 0.7e1 + (-c11 * t223 / 0.6e1 + t15 * c31 / 0.6e1) * t33 / 0.12e2 - t243) - B22 * (t252 + t261 + (-c12 * t249 / 0.48e2 + t264 + t45 * c32 / 0.48e2) * t27 / 0.7e1 + (-c12 * t257 / 0.6e1 + t52 * c32 / 0.6e1) * t33 / 0.12e2 - t277) - B33 * (t286 + t295 + (-c13 * t283 / 0.48e2 + t298 + t78 * c33 / 0.48e2) * t27 / 0.7e1 + (-c13 * t291 / 0.6e1 + t85 * c33 / 0.6e1) * t33 / 0.12e2 - t311);
	X(3,2) = -B11 * (t436 + t441 + (-c21 * t215 / 0.48e2 + t444 - t112 * c31 / 0.48e2) * t27 / 0.7e1 + (-c21 * t223 / 0.6e1 - t120 * c31 / 0.6e1) * t33 / 0.12e2 - t457) - B22 * (t462 + t467 + (-c22 * t249 / 0.48e2 + t470 - t146 * c32 / 0.48e2) * t27 / 0.7e1 + (-c22 * t257 / 0.6e1 - t154 * c32 / 0.6e1) * t33 / 0.12e2 - t483) - B33 * (t488 + t493 + (-c23 * t283 / 0.48e2 + t496 - t180 * c33 / 0.48e2) * t27 / 0.7e1 + (-c23 * t291 / 0.6e1 - t188 * c33 / 0.6e1) * t33 / 0.12e2 - t509);
	X(3,3) = -B11 * (-t215 * t215 * t9 / 0.5184e4 - t223 * t215 * t8 / 0.576e3 + (-c31 * t215 / 0.24e2 - t223 * t223 / 0.36e2) * t27 / 0.7e1 - c31 * t223 * t33 / 0.36e2 - t619 * t37 / 0.20e2) - B22 * (-t249 * t249 * t9 / 0.5184e4 - t257 * t249 * t8 / 0.576e3 + (-c32 * t249 / 0.24e2 - t257 * t257 / 0.36e2) * t27 / 0.7e1 - c32 * t257 * t33 / 0.36e2 - t644 * t37 / 0.20e2) - B33 * (-t283 * t283 * t9 / 0.5184e4 - t291 * t283 * t8 / 0.576e3 + (-c33 * t283 / 0.24e2 - t291 * t291 / 0.36e2) * t27 / 0.7e1 - c33 * t291 * t33 / 0.36e2 - t669 * t37 / 0.20e2);

elseif calc==11
	%Maple generated code: C*(diag(sig^2))*E'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = (T * T);
	t7 = t6 * t6;
	t8 = t7 * T;
	t11 = (c11 * a11);
	t12 = (c12 * a21);
	t13 = (c13 * a31);
	t14 = -t11 - t12 - t13;
	t25 = t6 * T;
	t35 = c12 * b22;
	t36 = c11 * b12;
	t37 = c13 * b32;
	t38 = t35 + t36 + t37;
	t42 = (c11 * a12);
	t43 = (c13 * a32);
	t44 = (c12 * a22);
	t45 = -t42 - t43 - t44;
	t63 = c12 * b23;
	t64 = c11 * b13;
	t65 = c13 * b33;
	t66 = t63 + t64 + t65;
	t70 = (c13 * a33);
	t71 = (c12 * a23);
	t72 = (c11 * a13);
	t73 = -t70 - t71 - t72;
	t218 = c21 * b11;
	t219 = c22 * b21;
	t220 = c23 * b31;
	t221 = t218 + t219 + t220;
	t225 = (c21 * a11);
	t226 = (c22 * a21);
	t227 = (c23 * a31);
	t228 = -t225 - t226 - t227;
	t248 = c22 * b22;
	t249 = c21 * b12;
	t250 = c23 * b32;
	t251 = t248 + t249 + t250;
	t255 = (c21 * a12);
	t256 = (c23 * a32);
	t257 = (c22 * a22);
	t258 = -t255 - t256 - t257;
	t276 = c22 * b23;
	t277 = c21 * b13;
	t278 = c23 * b33;
	t279 = t276 + t277 + t278;
	t283 = (c23 * a33);
	t284 = (c22 * a23);
	t285 = (c21 * a13);
	t286 = -t283 - t284 - t285;
	t431 = c31 * b11;
	t432 = c32 * b21;
	t433 = c33 * b31;
	t434 = t431 + t432 + t433;
	t438 = (c31 * a11);
	t439 = (c32 * a21);
	t440 = (c33 * a31);
	t441 = -t438 - t439 - t440;
	t461 = c32 * b22;
	t462 = c31 * b12;
	t463 = c33 * b32;
	t464 = t461 + t462 + t463;
	t468 = (c31 * a12);
	t469 = (c33 * a32);
	t470 = (c32 * a22);
	t471 = -t468 - t469 - t470;
	t489 = c32 * b23;
	t490 = c31 * b13;
	t491 = c33 * b33;
	t492 = t489 + t490 + t491;
	t496 = (c33 * a33);
	t497 = (c32 * a23);
	t498 = (c31 * a13);
	t499 = -t496 - t497 - t498;
	X(1,1) = B11 * (t4 * b11 * t8 / 0.20e2 + (t14 * b11 / 0.2e1 - t4 * a11 / 0.2e1) * t7 / 0.4e1 + (t1 - t14 * a11 + t2 / 0.2e1 + t3 / 0.2e1) * t25 / 0.3e1 + ((-2 * t11 - t12 - t13) * t6) / 0.2e1 + c11 * T) + B22 * (t38 * b12 * t8 / 0.20e2 + (t45 * b12 / 0.2e1 - t38 * a12 / 0.2e1) * t7 / 0.4e1 + (c12 * b12 / 0.2e1 - t45 * a12) * t25 / 0.3e1 - c12 * a12 * t6 / 0.2e1) + B33 * (t66 * b13 * t8 / 0.20e2 + (t73 * b13 / 0.2e1 - t66 * a13 / 0.2e1) * t7 / 0.4e1 + (c13 * b13 / 0.2e1 - t73 * a13) * t25 / 0.3e1 - c13 * a13 * t6 / 0.2e1);
	X(2,3) = B11 * (t4 * b21 * t8 / 0.20e2 + (t14 * b21 / 0.2e1 - t4 * a21 / 0.2e1) * t7 / 0.4e1 + (c11 * b21 / 0.2e1 - t14 * a21) * t25 / 0.3e1 - c11 * a21 * t6 / 0.2e1) + B22 * (t38 * b22 * t8 / 0.20e2 + (t45 * b22 / 0.2e1 - t38 * a22 / 0.2e1) * t7 / 0.4e1 + (t35 - t45 * a22 + t36 / 0.2e1 + t37 / 0.2e1) * t25 / 0.3e1 + ((-2 * t44 - t42 - t43) * t6) / 0.2e1 + c12 * T) + B33 * (t66 * b23 * t8 / 0.20e2 + (t73 * b23 / 0.2e1 - t66 * a23 / 0.2e1) * t7 / 0.4e1 + (c13 * b23 / 0.2e1 - t73 * a23) * t25 / 0.3e1 - c13 * a23 * t6 / 0.2e1);
	X(1,3) = B11 * (t4 * b31 * t8 / 0.20e2 + (t14 * b31 / 0.2e1 - t4 * a31 / 0.2e1) * t7 / 0.4e1 + (c11 * b31 / 0.2e1 - t14 * a31) * t25 / 0.3e1 - c11 * a31 * t6 / 0.2e1) + B22 * (t38 * b32 * t8 / 0.20e2 + (t45 * b32 / 0.2e1 - t38 * a32 / 0.2e1) * t7 / 0.4e1 + (c12 * b32 / 0.2e1 - t45 * a32) * t25 / 0.3e1 - c12 * a32 * t6 / 0.2e1) + B33 * (t66 * b33 * t8 / 0.20e2 + (t73 * b33 / 0.2e1 - t66 * a33 / 0.2e1) * t7 / 0.4e1 + (t65 - t73 * a33 + t63 / 0.2e1 + t64 / 0.2e1) * t25 / 0.3e1 + ((-2 * t70 - t71 - t72) * t6) / 0.2e1 + c13 * T);
	X(2,1) = B11 * (t221 * b11 * t8 / 0.20e2 + (t228 * b11 / 0.2e1 - t221 * a11 / 0.2e1) * t7 / 0.4e1 + (t218 - t228 * a11 + t219 / 0.2e1 + t220 / 0.2e1) * t25 / 0.3e1 + ((-2 * t225 - t226 - t227) * t6) / 0.2e1 + c21 * T) + B22 * (t251 * b12 * t8 / 0.20e2 + (t258 * b12 / 0.2e1 - t251 * a12 / 0.2e1) * t7 / 0.4e1 + (c22 * b12 / 0.2e1 - t258 * a12) * t25 / 0.3e1 - c22 * a12 * t6 / 0.2e1) + B33 * (t279 * b13 * t8 / 0.20e2 + (t286 * b13 / 0.2e1 - t279 * a13 / 0.2e1) * t7 / 0.4e1 + (c23 * b13 / 0.2e1 - t286 * a13) * t25 / 0.3e1 - c23 * a13 * t6 / 0.2e1);
	X(2,2) = B11 * (t221 * b21 * t8 / 0.20e2 + (t228 * b21 / 0.2e1 - t221 * a21 / 0.2e1) * t7 / 0.4e1 + (c21 * b21 / 0.2e1 - t228 * a21) * t25 / 0.3e1 - c21 * a21 * t6 / 0.2e1) + B22 * (t251 * b22 * t8 / 0.20e2 + (t258 * b22 / 0.2e1 - t251 * a22 / 0.2e1) * t7 / 0.4e1 + (t248 - t258 * a22 + t249 / 0.2e1 + t250 / 0.2e1) * t25 / 0.3e1 + ((-2 * t257 - t255 - t256) * t6) / 0.2e1 + c22 * T) + B33 * (t279 * b23 * t8 / 0.20e2 + (t286 * b23 / 0.2e1 - t279 * a23 / 0.2e1) * t7 / 0.4e1 + (c23 * b23 / 0.2e1 - t286 * a23) * t25 / 0.3e1 - c23 * a23 * t6 / 0.2e1);
	X(2,3) = B11 * (t221 * b31 * t8 / 0.20e2 + (t228 * b31 / 0.2e1 - t221 * a31 / 0.2e1) * t7 / 0.4e1 + (c21 * b31 / 0.2e1 - t228 * a31) * t25 / 0.3e1 - c21 * a31 * t6 / 0.2e1) + B22 * (t251 * b32 * t8 / 0.20e2 + (t258 * b32 / 0.2e1 - t251 * a32 / 0.2e1) * t7 / 0.4e1 + (c22 * b32 / 0.2e1 - t258 * a32) * t25 / 0.3e1 - c22 * a32 * t6 / 0.2e1) + B33 * (t279 * b33 * t8 / 0.20e2 + (t286 * b33 / 0.2e1 - t279 * a33 / 0.2e1) * t7 / 0.4e1 + (t278 - t286 * a33 + t276 / 0.2e1 + t277 / 0.2e1) * t25 / 0.3e1 + ((-2 * t283 - t284 - t285) * t6) / 0.2e1 + c23 * T);
	X(3,1) = B11 * (t434 * b11 * t8 / 0.20e2 + (t441 * b11 / 0.2e1 - t434 * a11 / 0.2e1) * t7 / 0.4e1 + (t431 - t441 * a11 + t432 / 0.2e1 + t433 / 0.2e1) * t25 / 0.3e1 + ((-2 * t438 - t439 - t440) * t6) / 0.2e1 + c31 * T) + B22 * (t464 * b12 * t8 / 0.20e2 + (t471 * b12 / 0.2e1 - t464 * a12 / 0.2e1) * t7 / 0.4e1 + (c32 * b12 / 0.2e1 - t471 * a12) * t25 / 0.3e1 - c32 * a12 * t6 / 0.2e1) + B33 * (t492 * b13 * t8 / 0.20e2 + (t499 * b13 / 0.2e1 - t492 * a13 / 0.2e1) * t7 / 0.4e1 + (c33 * b13 / 0.2e1 - t499 * a13) * t25 / 0.3e1 - c33 * a13 * t6 / 0.2e1);
	X(3,2) = B11 * (t434 * b21 * t8 / 0.20e2 + (t441 * b21 / 0.2e1 - t434 * a21 / 0.2e1) * t7 / 0.4e1 + (c31 * b21 / 0.2e1 - t441 * a21) * t25 / 0.3e1 - c31 * a21 * t6 / 0.2e1) + B22 * (t464 * b22 * t8 / 0.20e2 + (t471 * b22 / 0.2e1 - t464 * a22 / 0.2e1) * t7 / 0.4e1 + (t461 - t471 * a22 + t462 / 0.2e1 + t463 / 0.2e1) * t25 / 0.3e1 + ((-2 * t470 - t468 - t469) * t6) / 0.2e1 + c32 * T) + B33 * (t492 * b23 * t8 / 0.20e2 + (t499 * b23 / 0.2e1 - t492 * a23 / 0.2e1) * t7 / 0.4e1 + (c33 * b23 / 0.2e1 - t499 * a23) * t25 / 0.3e1 - c33 * a23 * t6 / 0.2e1);
	X(3,3) = B11 * (t434 * b31 * t8 / 0.20e2 + (t441 * b31 / 0.2e1 - t434 * a31 / 0.2e1) * t7 / 0.4e1 + (c31 * b31 / 0.2e1 - t441 * a31) * t25 / 0.3e1 - c31 * a31 * t6 / 0.2e1) + B22 * (t464 * b32 * t8 / 0.20e2 + (t471 * b32 / 0.2e1 - t464 * a32 / 0.2e1) * t7 / 0.4e1 + (c32 * b32 / 0.2e1 - t471 * a32) * t25 / 0.3e1 - c32 * a32 * t6 / 0.2e1) + B33 * (t492 * b33 * t8 / 0.20e2 + (t499 * b33 / 0.2e1 - t492 * a33 / 0.2e1) * t7 / 0.4e1 + (t491 - t499 * a33 + t489 / 0.2e1 + t490 / 0.2e1) * t25 / 0.3e1 + ((-2 * t496 - t497 - t498) * t6) / 0.2e1 + c33 * T);

elseif calc==12
	%Maple generated code: D*(diag(sig^2))*F'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t11 = c11 * a11;
	t12 = c12 * a21;
	t13 = c13 * a31;
	t14 = t11 + t12 + t13;
	t21 = t7 * t6 * T;
	t30 = t7 * t6;
	t37 = t7 * T;
	t44 = c12 * b22;
	t45 = c11 * b12;
	t46 = c13 * b32;
	t47 = t44 + t45 + t46;
	t51 = c11 * a12;
	t52 = c13 * a32;
	t53 = c12 * a22;
	t54 = t51 + t52 + t53;
	t74 = c12 * b23;
	t75 = c11 * b13;
	t76 = c13 * b33;
	t77 = t74 + t75 + t76;
	t81 = c13 * a33;
	t82 = c12 * a23;
	t83 = c11 * a13;
	t84 = t81 + t82 + t83;
	t251 = c21 * b11;
	t252 = c22 * b21;
	t253 = c23 * b31;
	t254 = t251 + t252 + t253;
	t258 = c21 * a11;
	t259 = c22 * a21;
	t260 = c23 * a31;
	t261 = t258 + t259 + t260;
	t287 = c22 * b22;
	t288 = c21 * b12;
	t289 = c23 * b32;
	t290 = t287 + t288 + t289;
	t294 = c21 * a12;
	t295 = c23 * a32;
	t296 = c22 * a22;
	t297 = t294 + t295 + t296;
	t317 = c22 * b23;
	t318 = c21 * b13;
	t319 = c23 * b33;
	t320 = t317 + t318 + t319;
	t324 = c23 * a33;
	t325 = c22 * a23;
	t326 = c21 * a13;
	t327 = t324 + t325 + t326;
	t494 = c31 * b11;
	t495 = c32 * b21;
	t496 = c33 * b31;
	t497 = t494 + t495 + t496;
	t501 = c31 * a11;
	t502 = c32 * a21;
	t503 = c33 * a31;
	t504 = t501 + t502 + t503;
	t530 = c32 * b22;
	t531 = c31 * b12;
	t532 = c33 * b32;
	t533 = t530 + t531 + t532;
	t537 = c31 * a12;
	t538 = c33 * a32;
	t539 = c32 * a22;
	t540 = t537 + t538 + t539;
	t560 = c32 * b23;
	t561 = c31 * b13;
	t562 = c33 * b33;
	t563 = t560 + t561 + t562;
	t567 = c33 * a33;
	t568 = c32 * a23;
	t569 = c31 * a13;
	t570 = t567 + t568 + t569;
	X(1,1) = -B11 * (-t4 * b11 * t8 / 0.1152e4 + (-t14 * b11 / 0.36e2 + t4 * a11 / 0.48e2) * t21 / 0.7e1 + (t1 / 0.24e2 + t14 * a11 / 0.12e2 - t2 / 0.24e2 - t3 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t11 - t12 / 0.6e1 - t13 / 0.6e1) * t37 / 0.5e1 + c11 * t7 / 0.8e1) - B22 * (-t47 * b12 * t8 / 0.1152e4 + (-t54 * b12 / 0.36e2 + t47 * a12 / 0.48e2) * t21 / 0.7e1 + (c12 * b12 / 0.12e2 + t54 * a12 / 0.12e2) * t30 / 0.6e1 - c12 * a12 * t37 / 0.20e2) - B33 * (-t77 * b13 * t8 / 0.1152e4 + (-t84 * b13 / 0.36e2 + t77 * a13 / 0.48e2) * t21 / 0.7e1 + (c13 * b13 / 0.12e2 + t84 * a13 / 0.12e2) * t30 / 0.6e1 - c13 * a13 * t37 / 0.20e2);
	X(2,3) = -B11 * (-t4 * b21 * t8 / 0.1152e4 + (-t14 * b21 / 0.36e2 + t4 * a21 / 0.48e2) * t21 / 0.7e1 + (c11 * b21 / 0.12e2 + t14 * a21 / 0.12e2) * t30 / 0.6e1 - c11 * a21 * t37 / 0.20e2) - B22 * (-t47 * b22 * t8 / 0.1152e4 + (-t54 * b22 / 0.36e2 + t47 * a22 / 0.48e2) * t21 / 0.7e1 + (t44 / 0.24e2 + t54 * a22 / 0.12e2 - t45 / 0.24e2 - t46 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t53 - t51 / 0.6e1 - t52 / 0.6e1) * t37 / 0.5e1 + c12 * t7 / 0.8e1) - B33 * (-t77 * b23 * t8 / 0.1152e4 + (-t84 * b23 / 0.36e2 + t77 * a23 / 0.48e2) * t21 / 0.7e1 + (c13 * b23 / 0.12e2 + t84 * a23 / 0.12e2) * t30 / 0.6e1 - c13 * a23 * t37 / 0.20e2);
	X(1,3) = -B11 * (-t4 * b31 * t8 / 0.1152e4 + (-t14 * b31 / 0.36e2 + t4 * a31 / 0.48e2) * t21 / 0.7e1 + (c11 * b31 / 0.12e2 + t14 * a31 / 0.12e2) * t30 / 0.6e1 - c11 * a31 * t37 / 0.20e2) - B22 * (-t47 * b32 * t8 / 0.1152e4 + (-t54 * b32 / 0.36e2 + t47 * a32 / 0.48e2) * t21 / 0.7e1 + (c12 * b32 / 0.12e2 + t54 * a32 / 0.12e2) * t30 / 0.6e1 - c12 * a32 * t37 / 0.20e2) - B33 * (-t77 * b33 * t8 / 0.1152e4 + (-t84 * b33 / 0.36e2 + t77 * a33 / 0.48e2) * t21 / 0.7e1 + (t76 / 0.24e2 + t84 * a33 / 0.12e2 - t74 / 0.24e2 - t75 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t81 - t82 / 0.6e1 - t83 / 0.6e1) * t37 / 0.5e1 + c13 * t7 / 0.8e1);
	X(2,1) = -B11 * (-t254 * b11 * t8 / 0.1152e4 + (-t261 * b11 / 0.36e2 + t254 * a11 / 0.48e2) * t21 / 0.7e1 + (t251 / 0.24e2 + t261 * a11 / 0.12e2 - t252 / 0.24e2 - t253 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t258 - t259 / 0.6e1 - t260 / 0.6e1) * t37 / 0.5e1 + c21 * t7 / 0.8e1) - B22 * (-t290 * b12 * t8 / 0.1152e4 + (-t297 * b12 / 0.36e2 + t290 * a12 / 0.48e2) * t21 / 0.7e1 + (c22 * b12 / 0.12e2 + t297 * a12 / 0.12e2) * t30 / 0.6e1 - c22 * a12 * t37 / 0.20e2) - B33 * (-t320 * b13 * t8 / 0.1152e4 + (-t327 * b13 / 0.36e2 + t320 * a13 / 0.48e2) * t21 / 0.7e1 + (c23 * b13 / 0.12e2 + t327 * a13 / 0.12e2) * t30 / 0.6e1 - c23 * a13 * t37 / 0.20e2);
	X(2,2) = -B11 * (-t254 * b21 * t8 / 0.1152e4 + (-t261 * b21 / 0.36e2 + t254 * a21 / 0.48e2) * t21 / 0.7e1 + (c21 * b21 / 0.12e2 + t261 * a21 / 0.12e2) * t30 / 0.6e1 - c21 * a21 * t37 / 0.20e2) - B22 * (-t290 * b22 * t8 / 0.1152e4 + (-t297 * b22 / 0.36e2 + t290 * a22 / 0.48e2) * t21 / 0.7e1 + (t287 / 0.24e2 + t297 * a22 / 0.12e2 - t288 / 0.24e2 - t289 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t296 - t294 / 0.6e1 - t295 / 0.6e1) * t37 / 0.5e1 + c22 * t7 / 0.8e1) - B33 * (-t320 * b23 * t8 / 0.1152e4 + (-t327 * b23 / 0.36e2 + t320 * a23 / 0.48e2) * t21 / 0.7e1 + (c23 * b23 / 0.12e2 + t327 * a23 / 0.12e2) * t30 / 0.6e1 - c23 * a23 * t37 / 0.20e2);
	X(2,3) = -B11 * (-t254 * b31 * t8 / 0.1152e4 + (-t261 * b31 / 0.36e2 + t254 * a31 / 0.48e2) * t21 / 0.7e1 + (c21 * b31 / 0.12e2 + t261 * a31 / 0.12e2) * t30 / 0.6e1 - c21 * a31 * t37 / 0.20e2) - B22 * (-t290 * b32 * t8 / 0.1152e4 + (-t297 * b32 / 0.36e2 + t290 * a32 / 0.48e2) * t21 / 0.7e1 + (c22 * b32 / 0.12e2 + t297 * a32 / 0.12e2) * t30 / 0.6e1 - c22 * a32 * t37 / 0.20e2) - B33 * (-t320 * b33 * t8 / 0.1152e4 + (-t327 * b33 / 0.36e2 + t320 * a33 / 0.48e2) * t21 / 0.7e1 + (t319 / 0.24e2 + t327 * a33 / 0.12e2 - t317 / 0.24e2 - t318 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t324 - t325 / 0.6e1 - t326 / 0.6e1) * t37 / 0.5e1 + c23 * t7 / 0.8e1);
	X(3,1) = -B11 * (-t497 * b11 * t8 / 0.1152e4 + (-t504 * b11 / 0.36e2 + t497 * a11 / 0.48e2) * t21 / 0.7e1 + (t494 / 0.24e2 + t504 * a11 / 0.12e2 - t495 / 0.24e2 - t496 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t501 - t502 / 0.6e1 - t503 / 0.6e1) * t37 / 0.5e1 + c31 * t7 / 0.8e1) - B22 * (-t533 * b12 * t8 / 0.1152e4 + (-t540 * b12 / 0.36e2 + t533 * a12 / 0.48e2) * t21 / 0.7e1 + (c32 * b12 / 0.12e2 + t540 * a12 / 0.12e2) * t30 / 0.6e1 - c32 * a12 * t37 / 0.20e2) - B33 * (-t563 * b13 * t8 / 0.1152e4 + (-t570 * b13 / 0.36e2 + t563 * a13 / 0.48e2) * t21 / 0.7e1 + (c33 * b13 / 0.12e2 + t570 * a13 / 0.12e2) * t30 / 0.6e1 - c33 * a13 * t37 / 0.20e2);
	X(3,2) = -B11 * (-t497 * b21 * t8 / 0.1152e4 + (-t504 * b21 / 0.36e2 + t497 * a21 / 0.48e2) * t21 / 0.7e1 + (c31 * b21 / 0.12e2 + t504 * a21 / 0.12e2) * t30 / 0.6e1 - c31 * a21 * t37 / 0.20e2) - B22 * (-t533 * b22 * t8 / 0.1152e4 + (-t540 * b22 / 0.36e2 + t533 * a22 / 0.48e2) * t21 / 0.7e1 + (t530 / 0.24e2 + t540 * a22 / 0.12e2 - t531 / 0.24e2 - t532 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t539 - t537 / 0.6e1 - t538 / 0.6e1) * t37 / 0.5e1 + c32 * t7 / 0.8e1) - B33 * (-t563 * b23 * t8 / 0.1152e4 + (-t570 * b23 / 0.36e2 + t563 * a23 / 0.48e2) * t21 / 0.7e1 + (c33 * b23 / 0.12e2 + t570 * a23 / 0.12e2) * t30 / 0.6e1 - c33 * a23 * t37 / 0.20e2);
	X(3,3) = -B11 * (-t497 * b31 * t8 / 0.1152e4 + (-t504 * b31 / 0.36e2 + t497 * a31 / 0.48e2) * t21 / 0.7e1 + (c31 * b31 / 0.12e2 + t504 * a31 / 0.12e2) * t30 / 0.6e1 - c31 * a31 * t37 / 0.20e2) - B22 * (-t533 * b32 * t8 / 0.1152e4 + (-t540 * b32 / 0.36e2 + t533 * a32 / 0.48e2) * t21 / 0.7e1 + (c32 * b32 / 0.12e2 + t540 * a32 / 0.12e2) * t30 / 0.6e1 - c32 * a32 * t37 / 0.20e2) - B33 * (-t563 * b33 * t8 / 0.1152e4 + (-t570 * b33 / 0.36e2 + t563 * a33 / 0.48e2) * t21 / 0.7e1 + (t562 / 0.24e2 + t570 * a33 / 0.12e2 - t560 / 0.24e2 - t561 / 0.24e2) * t30 / 0.6e1 + (-0.5e1 / 0.12e2 * t567 - t568 / 0.6e1 - t569 / 0.6e1) * t37 / 0.5e1 + c33 * t7 / 0.8e1);

elseif calc==13
	%Maple generated code: D*(diag(sig^2))*Id'
	t1 = T * T;
	t3 = t1 * T / 0.6e1;
	t4 = t1 * t1;
	t7 = t4 * T;
	t10 = -t3 + t4 * a11 / 0.24e2 + t7 * b11 / 0.120e3;
	t16 = t4 * a21 / 0.24e2 + t7 * b21 / 0.120e3;
	t22 = t4 * a31 / 0.24e2 + t7 * b31 / 0.120e3;
	t30 = t4 * a12 / 0.24e2 + t7 * b12 / 0.120e3;
	t36 = -t3 + t4 * a22 / 0.24e2 + t7 * b22 / 0.120e3;
	t42 = t4 * a32 / 0.24e2 + t7 * b32 / 0.120e3;
	t50 = t4 * a13 / 0.24e2 + t7 * b13 / 0.120e3;
	t56 = t4 * a23 / 0.24e2 + t7 * b23 / 0.120e3;
	t62 = -t3 + t4 * a33 / 0.24e2 + t7 * b33 / 0.120e3;
	X(1,1) = -B11 * (c11 * t10 + c12 * t16 + c13 * t22);
	X(2,3) = -B22 * (c11 * t30 + c12 * t36 + c13 * t42);
	X(1,3) = -B33 * (c11 * t50 + c12 * t56 + c13 * t62);
	X(2,1) = -B11 * (c21 * t10 + c22 * t16 + c23 * t22);
	X(2,2) = -B22 * (c21 * t30 + c22 * t36 + c23 * t42);
	X(2,3) = -B33 * (c21 * t50 + c22 * t56 + c23 * t62);
	X(3,1) = -B11 * (c31 * t10 + c32 * t16 + c33 * t22);
	X(3,2) = -B22 * (c31 * t30 + c32 * t36 + c33 * t42);
	X(3,3) = -B33 * (c31 * t50 + c32 * t56 + c33 * t62);

elseif calc==14
	%Maple generated code: E*(diag(sig^2))*A'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = T * T;
	t7 = t6 * T;
	t8 = t6 * t6;
	t9 = t8 * t7;
	t12 = c11 * a11;
	t13 = c12 * a21;
	t14 = c13 * a31;
	t15 = t12 + t13 + t14;
	t20 = t8 * t6;
	t28 = t8 * T;
	t41 = c12 * b22;
	t42 = c11 * b12;
	t43 = c13 * b32;
	t44 = t41 + t42 + t43;
	t48 = c11 * a12;
	t49 = c13 * a32;
	t50 = c12 * a22;
	t51 = t48 + t49 + t50;
	t69 = c12 * b23;
	t70 = c11 * b13;
	t71 = c13 * b33;
	t72 = t69 + t70 + t71;
	t76 = c13 * a33;
	t77 = c12 * a23;
	t78 = c11 * a13;
	t79 = t76 + t77 + t78;
	t98 = c21 * b11;
	t99 = c22 * b21;
	t100 = c23 * b31;
	t101 = t98 + t99 + t100;
	t105 = c21 * a11;
	t106 = c22 * a21;
	t107 = c23 * a31;
	t108 = t105 + t106 + t107;
	t132 = c22 * b22;
	t133 = c21 * b12;
	t134 = c23 * b32;
	t135 = t132 + t133 + t134;
	t139 = c21 * a12;
	t140 = c23 * a32;
	t141 = c22 * a22;
	t142 = t139 + t140 + t141;
	t160 = c22 * b23;
	t161 = c21 * b13;
	t162 = c23 * b33;
	t163 = t160 + t161 + t162;
	t167 = c23 * a33;
	t168 = c22 * a23;
	t169 = c21 * a13;
	t170 = t167 + t168 + t169;
	t189 = c31 * b11;
	t190 = c32 * b21;
	t191 = c33 * b31;
	t192 = t189 + t190 + t191;
	t196 = c31 * a11;
	t197 = c32 * a21;
	t198 = c33 * a31;
	t199 = t196 + t197 + t198;
	t223 = c32 * b22;
	t224 = c31 * b12;
	t225 = c33 * b32;
	t226 = t223 + t224 + t225;
	t230 = c31 * a12;
	t231 = c33 * a32;
	t232 = c32 * a22;
	t233 = t230 + t231 + t232;
	t251 = c32 * b23;
	t252 = c31 * b13;
	t253 = c33 * b33;
	t254 = t251 + t252 + t253;
	t258 = c33 * a33;
	t259 = c32 * a23;
	t260 = c31 * a13;
	t261 = t258 + t259 + t260;
	X(1,1) = B11 * (t4 * b11 * t9 / 0.336e3 + (t15 * b11 / 0.12e2 - t4 * a11 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t1 - t15 * a11 / 0.6e1 + t2 / 0.24e2 + t3 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t12 + t13 / 0.6e1 + t14 / 0.6e1) * t8 / 0.4e1 - c11 * t7 / 0.6e1) + B22 * (t44 * b12 * t9 / 0.336e3 + (t51 * b12 / 0.12e2 - t44 * a12 / 0.24e2) * t20 / 0.6e1 + (-c12 * b12 / 0.4e1 - t51 * a12 / 0.6e1) * t28 / 0.5e1 + c12 * a12 * t8 / 0.8e1) + B33 * (t72 * b13 * t9 / 0.336e3 + (t79 * b13 / 0.12e2 - t72 * a13 / 0.24e2) * t20 / 0.6e1 + (-c13 * b13 / 0.4e1 - t79 * a13 / 0.6e1) * t28 / 0.5e1 + c13 * a13 * t8 / 0.8e1);
	X(2,3) = B11 * (t101 * b11 * t9 / 0.336e3 + (t108 * b11 / 0.12e2 - t101 * a11 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t98 - t108 * a11 / 0.6e1 + t99 / 0.24e2 + t100 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t105 + t106 / 0.6e1 + t107 / 0.6e1) * t8 / 0.4e1 - c21 * t7 / 0.6e1) + B22 * (t135 * b12 * t9 / 0.336e3 + (t142 * b12 / 0.12e2 - t135 * a12 / 0.24e2) * t20 / 0.6e1 + (-c22 * b12 / 0.4e1 - t142 * a12 / 0.6e1) * t28 / 0.5e1 + c22 * a12 * t8 / 0.8e1) + B33 * (t163 * b13 * t9 / 0.336e3 + (t170 * b13 / 0.12e2 - t163 * a13 / 0.24e2) * t20 / 0.6e1 + (-c23 * b13 / 0.4e1 - t170 * a13 / 0.6e1) * t28 / 0.5e1 + c23 * a13 * t8 / 0.8e1);
	X(1,3) = B11 * (t192 * b11 * t9 / 0.336e3 + (t199 * b11 / 0.12e2 - t192 * a11 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t189 - t199 * a11 / 0.6e1 + t190 / 0.24e2 + t191 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t196 + t197 / 0.6e1 + t198 / 0.6e1) * t8 / 0.4e1 - c31 * t7 / 0.6e1) + B22 * (t226 * b12 * t9 / 0.336e3 + (t233 * b12 / 0.12e2 - t226 * a12 / 0.24e2) * t20 / 0.6e1 + (-c32 * b12 / 0.4e1 - t233 * a12 / 0.6e1) * t28 / 0.5e1 + c32 * a12 * t8 / 0.8e1) + B33 * (t254 * b13 * t9 / 0.336e3 + (t261 * b13 / 0.12e2 - t254 * a13 / 0.24e2) * t20 / 0.6e1 + (-c33 * b13 / 0.4e1 - t261 * a13 / 0.6e1) * t28 / 0.5e1 + c33 * a13 * t8 / 0.8e1);
	X(2,1) = B11 * (t4 * b21 * t9 / 0.336e3 + (t15 * b21 / 0.12e2 - t4 * a21 / 0.24e2) * t20 / 0.6e1 + (-c11 * b21 / 0.4e1 - t15 * a21 / 0.6e1) * t28 / 0.5e1 + c11 * a21 * t8 / 0.8e1) + B22 * (t44 * b22 * t9 / 0.336e3 + (t51 * b22 / 0.12e2 - t44 * a22 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t41 - t51 * a22 / 0.6e1 + t42 / 0.24e2 + t43 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t50 + t48 / 0.6e1 + t49 / 0.6e1) * t8 / 0.4e1 - c12 * t7 / 0.6e1) + B33 * (t72 * b23 * t9 / 0.336e3 + (t79 * b23 / 0.12e2 - t72 * a23 / 0.24e2) * t20 / 0.6e1 + (-c13 * b23 / 0.4e1 - t79 * a23 / 0.6e1) * t28 / 0.5e1 + c13 * a23 * t8 / 0.8e1);
	X(2,2) = B11 * (t101 * b21 * t9 / 0.336e3 + (t108 * b21 / 0.12e2 - t101 * a21 / 0.24e2) * t20 / 0.6e1 + (-c21 * b21 / 0.4e1 - t108 * a21 / 0.6e1) * t28 / 0.5e1 + c21 * a21 * t8 / 0.8e1) + B22 * (t135 * b22 * t9 / 0.336e3 + (t142 * b22 / 0.12e2 - t135 * a22 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t132 - t142 * a22 / 0.6e1 + t133 / 0.24e2 + t134 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t141 + t139 / 0.6e1 + t140 / 0.6e1) * t8 / 0.4e1 - c22 * t7 / 0.6e1) + B33 * (t163 * b23 * t9 / 0.336e3 + (t170 * b23 / 0.12e2 - t163 * a23 / 0.24e2) * t20 / 0.6e1 + (-c23 * b23 / 0.4e1 - t170 * a23 / 0.6e1) * t28 / 0.5e1 + c23 * a23 * t8 / 0.8e1);
	X(2,3) = B11 * (t192 * b21 * t9 / 0.336e3 + (t199 * b21 / 0.12e2 - t192 * a21 / 0.24e2) * t20 / 0.6e1 + (-c31 * b21 / 0.4e1 - t199 * a21 / 0.6e1) * t28 / 0.5e1 + c31 * a21 * t8 / 0.8e1) + B22 * (t226 * b22 * t9 / 0.336e3 + (t233 * b22 / 0.12e2 - t226 * a22 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t223 - t233 * a22 / 0.6e1 + t224 / 0.24e2 + t225 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t232 + t230 / 0.6e1 + t231 / 0.6e1) * t8 / 0.4e1 - c32 * t7 / 0.6e1) + B33 * (t254 * b23 * t9 / 0.336e3 + (t261 * b23 / 0.12e2 - t254 * a23 / 0.24e2) * t20 / 0.6e1 + (-c33 * b23 / 0.4e1 - t261 * a23 / 0.6e1) * t28 / 0.5e1 + c33 * a23 * t8 / 0.8e1);
	X(3,1) = B11 * (t4 * b31 * t9 / 0.336e3 + (t15 * b31 / 0.12e2 - t4 * a31 / 0.24e2) * t20 / 0.6e1 + (-c11 * b31 / 0.4e1 - t15 * a31 / 0.6e1) * t28 / 0.5e1 + c11 * a31 * t8 / 0.8e1) + B22 * (t44 * b32 * t9 / 0.336e3 + (t51 * b32 / 0.12e2 - t44 * a32 / 0.24e2) * t20 / 0.6e1 + (-c12 * b32 / 0.4e1 - t51 * a32 / 0.6e1) * t28 / 0.5e1 + c12 * a32 * t8 / 0.8e1) + B33 * (t72 * b33 * t9 / 0.336e3 + (t79 * b33 / 0.12e2 - t72 * a33 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t71 - t79 * a33 / 0.6e1 + t69 / 0.24e2 + t70 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t76 + t77 / 0.6e1 + t78 / 0.6e1) * t8 / 0.4e1 - c13 * t7 / 0.6e1);
	X(3,2) = B11 * (t101 * b31 * t9 / 0.336e3 + (t108 * b31 / 0.12e2 - t101 * a31 / 0.24e2) * t20 / 0.6e1 + (-c21 * b31 / 0.4e1 - t108 * a31 / 0.6e1) * t28 / 0.5e1 + c21 * a31 * t8 / 0.8e1) + B22 * (t135 * b32 * t9 / 0.336e3 + (t142 * b32 / 0.12e2 - t135 * a32 / 0.24e2) * t20 / 0.6e1 + (-c22 * b32 / 0.4e1 - t142 * a32 / 0.6e1) * t28 / 0.5e1 + c22 * a32 * t8 / 0.8e1) + B33 * (t163 * b33 * t9 / 0.336e3 + (t170 * b33 / 0.12e2 - t163 * a33 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t162 - t170 * a33 / 0.6e1 + t160 / 0.24e2 + t161 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t167 + t168 / 0.6e1 + t169 / 0.6e1) * t8 / 0.4e1 - c23 * t7 / 0.6e1);
	X(3,3) = B11 * (t192 * b31 * t9 / 0.336e3 + (t199 * b31 / 0.12e2 - t192 * a31 / 0.24e2) * t20 / 0.6e1 + (-c31 * b31 / 0.4e1 - t199 * a31 / 0.6e1) * t28 / 0.5e1 + c31 * a31 * t8 / 0.8e1) + B22 * (t226 * b32 * t9 / 0.336e3 + (t233 * b32 / 0.12e2 - t226 * a32 / 0.24e2) * t20 / 0.6e1 + (-c32 * b32 / 0.4e1 - t233 * a32 / 0.6e1) * t28 / 0.5e1 + c32 * a32 * t8 / 0.8e1) + B33 * (t254 * b33 * t9 / 0.336e3 + (t261 * b33 / 0.12e2 - t254 * a33 / 0.24e2) * t20 / 0.6e1 + (-0.5e1 / 0.24e2 * t253 - t261 * a33 / 0.6e1 + t251 / 0.24e2 + t252 / 0.24e2) * t28 / 0.5e1 + (0.2e1 / 0.3e1 * t258 + t259 / 0.6e1 + t260 / 0.6e1) * t8 / 0.4e1 - c33 * t7 / 0.6e1);

elseif calc==15
	%Maple generated code: F*(diag(sig^2))*B'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t9 = t8 * T;
	t12 = c11 * a11;
	t13 = c12 * a21;
	t14 = c13 * a31;
	t15 = -t12 - t13 - t14;
	t30 = t7 * t6 * T;
	t34 = t7 * t6;
	t37 = t7 * T;
	t42 = c12 * b22;
	t43 = c11 * b12;
	t44 = c13 * b32;
	t45 = t42 + t43 + t44;
	t49 = c11 * a12;
	t50 = c13 * a32;
	t51 = c12 * a22;
	t52 = -t49 - t50 - t51;
	t72 = c12 * b23;
	t73 = c11 * b13;
	t74 = c13 * b33;
	t75 = t72 + t73 + t74;
	t79 = c13 * a33;
	t80 = c12 * a23;
	t81 = c11 * a13;
	t82 = -t79 - t80 - t81;
	t103 = c21 * b11;
	t104 = c22 * b21;
	t105 = c23 * b31;
	t106 = t103 + t104 + t105;
	t110 = c21 * a11;
	t111 = c22 * a21;
	t112 = c23 * a31;
	t113 = -t110 - t111 - t112;
	t136 = c22 * b22;
	t137 = c21 * b12;
	t138 = c23 * b32;
	t139 = t136 + t137 + t138;
	t143 = c21 * a12;
	t144 = c23 * a32;
	t145 = c22 * a22;
	t146 = -t143 - t144 - t145;
	t166 = c22 * b23;
	t167 = c21 * b13;
	t168 = c23 * b33;
	t169 = t166 + t167 + t168;
	t173 = c23 * a33;
	t174 = c22 * a23;
	t175 = c21 * a13;
	t176 = -t173 - t174 - t175;
	t197 = c31 * b11;
	t198 = c32 * b21;
	t199 = c33 * b31;
	t200 = t197 + t198 + t199;
	t204 = c31 * a11;
	t205 = c32 * a21;
	t206 = c33 * a31;
	t207 = -t204 - t205 - t206;
	t230 = c32 * b22;
	t231 = c31 * b12;
	t232 = c33 * b32;
	t233 = t230 + t231 + t232;
	t237 = c31 * a12;
	t238 = c33 * a32;
	t239 = c32 * a22;
	t240 = -t237 - t238 - t239;
	t260 = c32 * b23;
	t261 = c31 * b13;
	t262 = c33 * b33;
	t263 = t260 + t261 + t262;
	t267 = c33 * a33;
	t268 = c32 * a23;
	t269 = c31 * a13;
	t270 = -t267 - t268 - t269;
	X(1,1) = B11 * (-t4 * b11 * t9 / 0.6480e4 + (-t15 * b11 / 0.144e3 + t4 * a11 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t1 + t15 * a11 / 0.48e2 - t2 / 0.120e3 - t3 / 0.120e3) * t30 / 0.7e1 + (-t12 + t13 + t14) * t34 / 0.144e3 + c11 * t37 / 0.30e2) + B22 * (-t45 * b12 * t9 / 0.6480e4 + (-t52 * b12 / 0.144e3 + t45 * a12 / 0.240e3) * t8 / 0.8e1 + (c12 * b12 / 0.36e2 + t52 * a12 / 0.48e2) * t30 / 0.7e1 - c12 * a12 * t34 / 0.72e2) + B33 * (-t75 * b13 * t9 / 0.6480e4 + (-t82 * b13 / 0.144e3 + t75 * a13 / 0.240e3) * t8 / 0.8e1 + (c13 * b13 / 0.36e2 + t82 * a13 / 0.48e2) * t30 / 0.7e1 - c13 * a13 * t34 / 0.72e2);
	X(2,3) = B11 * (-t106 * b11 * t9 / 0.6480e4 + (-t113 * b11 / 0.144e3 + t106 * a11 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t103 + t113 * a11 / 0.48e2 - t104 / 0.120e3 - t105 / 0.120e3) * t30 / 0.7e1 + (-t110 + t111 + t112) * t34 / 0.144e3 + c21 * t37 / 0.30e2) + B22 * (-t139 * b12 * t9 / 0.6480e4 + (-t146 * b12 / 0.144e3 + t139 * a12 / 0.240e3) * t8 / 0.8e1 + (c22 * b12 / 0.36e2 + t146 * a12 / 0.48e2) * t30 / 0.7e1 - c22 * a12 * t34 / 0.72e2) + B33 * (-t169 * b13 * t9 / 0.6480e4 + (-t176 * b13 / 0.144e3 + t169 * a13 / 0.240e3) * t8 / 0.8e1 + (c23 * b13 / 0.36e2 + t176 * a13 / 0.48e2) * t30 / 0.7e1 - c23 * a13 * t34 / 0.72e2);
	X(1,3) = B11 * (-t200 * b11 * t9 / 0.6480e4 + (-t207 * b11 / 0.144e3 + t200 * a11 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t197 + t207 * a11 / 0.48e2 - t198 / 0.120e3 - t199 / 0.120e3) * t30 / 0.7e1 + (-t204 + t205 + t206) * t34 / 0.144e3 + c31 * t37 / 0.30e2) + B22 * (-t233 * b12 * t9 / 0.6480e4 + (-t240 * b12 / 0.144e3 + t233 * a12 / 0.240e3) * t8 / 0.8e1 + (c32 * b12 / 0.36e2 + t240 * a12 / 0.48e2) * t30 / 0.7e1 - c32 * a12 * t34 / 0.72e2) + B33 * (-t263 * b13 * t9 / 0.6480e4 + (-t270 * b13 / 0.144e3 + t263 * a13 / 0.240e3) * t8 / 0.8e1 + (c33 * b13 / 0.36e2 + t270 * a13 / 0.48e2) * t30 / 0.7e1 - c33 * a13 * t34 / 0.72e2);
	X(2,1) = B11 * (-t4 * b21 * t9 / 0.6480e4 + (-t15 * b21 / 0.144e3 + t4 * a21 / 0.240e3) * t8 / 0.8e1 + (c11 * b21 / 0.36e2 + t15 * a21 / 0.48e2) * t30 / 0.7e1 - c11 * a21 * t34 / 0.72e2) + B22 * (-t45 * b22 * t9 / 0.6480e4 + (-t52 * b22 / 0.144e3 + t45 * a22 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t42 + t52 * a22 / 0.48e2 - t43 / 0.120e3 - t44 / 0.120e3) * t30 / 0.7e1 + (-t51 + t49 + t50) * t34 / 0.144e3 + c12 * t37 / 0.30e2) + B33 * (-t75 * b23 * t9 / 0.6480e4 + (-t82 * b23 / 0.144e3 + t75 * a23 / 0.240e3) * t8 / 0.8e1 + (c13 * b23 / 0.36e2 + t82 * a23 / 0.48e2) * t30 / 0.7e1 - c13 * a23 * t34 / 0.72e2);
	X(2,2) = B11 * (-t106 * b21 * t9 / 0.6480e4 + (-t113 * b21 / 0.144e3 + t106 * a21 / 0.240e3) * t8 / 0.8e1 + (c21 * b21 / 0.36e2 + t113 * a21 / 0.48e2) * t30 / 0.7e1 - c21 * a21 * t34 / 0.72e2) + B22 * (-t139 * b22 * t9 / 0.6480e4 + (-t146 * b22 / 0.144e3 + t139 * a22 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t136 + t146 * a22 / 0.48e2 - t137 / 0.120e3 - t138 / 0.120e3) * t30 / 0.7e1 + (-t145 + t143 + t144) * t34 / 0.144e3 + c22 * t37 / 0.30e2) + B33 * (-t169 * b23 * t9 / 0.6480e4 + (-t176 * b23 / 0.144e3 + t169 * a23 / 0.240e3) * t8 / 0.8e1 + (c23 * b23 / 0.36e2 + t176 * a23 / 0.48e2) * t30 / 0.7e1 - c23 * a23 * t34 / 0.72e2);
	X(2,3) = B11 * (-t200 * b21 * t9 / 0.6480e4 + (-t207 * b21 / 0.144e3 + t200 * a21 / 0.240e3) * t8 / 0.8e1 + (c31 * b21 / 0.36e2 + t207 * a21 / 0.48e2) * t30 / 0.7e1 - c31 * a21 * t34 / 0.72e2) + B22 * (-t233 * b22 * t9 / 0.6480e4 + (-t240 * b22 / 0.144e3 + t233 * a22 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t230 + t240 * a22 / 0.48e2 - t231 / 0.120e3 - t232 / 0.120e3) * t30 / 0.7e1 + (-t239 + t237 + t238) * t34 / 0.144e3 + c32 * t37 / 0.30e2) + B33 * (-t263 * b23 * t9 / 0.6480e4 + (-t270 * b23 / 0.144e3 + t263 * a23 / 0.240e3) * t8 / 0.8e1 + (c33 * b23 / 0.36e2 + t270 * a23 / 0.48e2) * t30 / 0.7e1 - c33 * a23 * t34 / 0.72e2);
	X(3,1) = B11 * (-t4 * b31 * t9 / 0.6480e4 + (-t15 * b31 / 0.144e3 + t4 * a31 / 0.240e3) * t8 / 0.8e1 + (c11 * b31 / 0.36e2 + t15 * a31 / 0.48e2) * t30 / 0.7e1 - c11 * a31 * t34 / 0.72e2) + B22 * (-t45 * b32 * t9 / 0.6480e4 + (-t52 * b32 / 0.144e3 + t45 * a32 / 0.240e3) * t8 / 0.8e1 + (c12 * b32 / 0.36e2 + t52 * a32 / 0.48e2) * t30 / 0.7e1 - c12 * a32 * t34 / 0.72e2) + B33 * (-t75 * b33 * t9 / 0.6480e4 + (-t82 * b33 / 0.144e3 + t75 * a33 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t74 + t82 * a33 / 0.48e2 - t72 / 0.120e3 - t73 / 0.120e3) * t30 / 0.7e1 + (-t79 + t80 + t81) * t34 / 0.144e3 + c13 * t37 / 0.30e2);
	X(3,2) = B11 * (-t106 * b31 * t9 / 0.6480e4 + (-t113 * b31 / 0.144e3 + t106 * a31 / 0.240e3) * t8 / 0.8e1 + (c21 * b31 / 0.36e2 + t113 * a31 / 0.48e2) * t30 / 0.7e1 - c21 * a31 * t34 / 0.72e2) + B22 * (-t139 * b32 * t9 / 0.6480e4 + (-t146 * b32 / 0.144e3 + t139 * a32 / 0.240e3) * t8 / 0.8e1 + (c22 * b32 / 0.36e2 + t146 * a32 / 0.48e2) * t30 / 0.7e1 - c22 * a32 * t34 / 0.72e2) + B33 * (-t169 * b33 * t9 / 0.6480e4 + (-t176 * b33 / 0.144e3 + t169 * a33 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t168 + t176 * a33 / 0.48e2 - t166 / 0.120e3 - t167 / 0.120e3) * t30 / 0.7e1 + (-t173 + t174 + t175) * t34 / 0.144e3 + c23 * t37 / 0.30e2);
	X(3,3) = B11 * (-t200 * b31 * t9 / 0.6480e4 + (-t207 * b31 / 0.144e3 + t200 * a31 / 0.240e3) * t8 / 0.8e1 + (c31 * b31 / 0.36e2 + t207 * a31 / 0.48e2) * t30 / 0.7e1 - c31 * a31 * t34 / 0.72e2) + B22 * (-t233 * b32 * t9 / 0.6480e4 + (-t240 * b32 / 0.144e3 + t233 * a32 / 0.240e3) * t8 / 0.8e1 + (c32 * b32 / 0.36e2 + t240 * a32 / 0.48e2) * t30 / 0.7e1 - c32 * a32 * t34 / 0.72e2) + B33 * (-t263 * b33 * t9 / 0.6480e4 + (-t270 * b33 / 0.144e3 + t263 * a33 / 0.240e3) * t8 / 0.8e1 + (0.7e1 / 0.360e3 * t262 + t270 * a33 / 0.48e2 - t260 / 0.120e3 - t261 / 0.120e3) * t30 / 0.7e1 + (-t267 + t268 + t269) * t34 / 0.144e3 + c33 * t37 / 0.30e2);

elseif calc==16
	%Maple generated code: E*(diag(sig^2))*C'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = t1 + t2 + t3;
	t6 = (T * T);
	t7 = t6 * t6;
	t8 = t7 * T;
	t11 = (c11 * a11);
	t12 = (c12 * a21);
	t13 = (c13 * a31);
	t14 = -t11 - t12 - t13;
	t25 = t6 * T;
	t35 = c12 * b22;
	t36 = c11 * b12;
	t37 = c13 * b32;
	t38 = t35 + t36 + t37;
	t42 = (c11 * a12);
	t43 = (c13 * a32);
	t44 = (c12 * a22);
	t45 = -t42 - t43 - t44;
	t63 = c12 * b23;
	t64 = c11 * b13;
	t65 = c13 * b33;
	t66 = t63 + t64 + t65;
	t70 = (c13 * a33);
	t71 = (c12 * a23);
	t72 = (c11 * a13);
	t73 = -t70 - t71 - t72;
	t92 = c21 * b11;
	t93 = c22 * b21;
	t94 = c23 * b31;
	t95 = t92 + t93 + t94;
	t99 = (c21 * a11);
	t100 = (c22 * a21);
	t101 = (c23 * a31);
	t102 = -t99 - t100 - t101;
	t122 = c22 * b22;
	t123 = c21 * b12;
	t124 = c23 * b32;
	t125 = t122 + t123 + t124;
	t129 = (c21 * a12);
	t130 = (c23 * a32);
	t131 = (c22 * a22);
	t132 = -t129 - t130 - t131;
	t150 = c22 * b23;
	t151 = c21 * b13;
	t152 = c23 * b33;
	t153 = t150 + t151 + t152;
	t157 = (c23 * a33);
	t158 = (c22 * a23);
	t159 = (c21 * a13);
	t160 = -t157 - t158 - t159;
	t179 = c31 * b11;
	t180 = c32 * b21;
	t181 = c33 * b31;
	t182 = t179 + t180 + t181;
	t186 = (c31 * a11);
	t187 = (c32 * a21);
	t188 = (c33 * a31);
	t189 = -t186 - t187 - t188;
	t209 = c32 * b22;
	t210 = c31 * b12;
	t211 = c33 * b32;
	t212 = t209 + t210 + t211;
	t216 = (c31 * a12);
	t217 = (c33 * a32);
	t218 = (c32 * a22);
	t219 = -t216 - t217 - t218;
	t237 = c32 * b23;
	t238 = c31 * b13;
	t239 = c33 * b33;
	t240 = t237 + t238 + t239;
	t244 = (c33 * a33);
	t245 = (c32 * a23);
	t246 = (c31 * a13);
	t247 = -t244 - t245 - t246;
	X(1,1) = B11 * (t4 * b11 * t8 / 0.20e2 + (t14 * b11 / 0.2e1 - t4 * a11 / 0.2e1) * t7 / 0.4e1 + (t1 - t14 * a11 + t2 / 0.2e1 + t3 / 0.2e1) * t25 / 0.3e1 + ((-2 * t11 - t12 - t13) * t6) / 0.2e1 + c11 * T) + B22 * (t38 * b12 * t8 / 0.20e2 + (t45 * b12 / 0.2e1 - t38 * a12 / 0.2e1) * t7 / 0.4e1 + (c12 * b12 / 0.2e1 - t45 * a12) * t25 / 0.3e1 - c12 * a12 * t6 / 0.2e1) + B33 * (t66 * b13 * t8 / 0.20e2 + (t73 * b13 / 0.2e1 - t66 * a13 / 0.2e1) * t7 / 0.4e1 + (c13 * b13 / 0.2e1 - t73 * a13) * t25 / 0.3e1 - c13 * a13 * t6 / 0.2e1);
	X(2,3) = B11 * (t95 * b11 * t8 / 0.20e2 + (t102 * b11 / 0.2e1 - t95 * a11 / 0.2e1) * t7 / 0.4e1 + (t92 - t102 * a11 + t93 / 0.2e1 + t94 / 0.2e1) * t25 / 0.3e1 + ((-2 * t99 - t100 - t101) * t6) / 0.2e1 + c21 * T) + B22 * (t125 * b12 * t8 / 0.20e2 + (t132 * b12 / 0.2e1 - t125 * a12 / 0.2e1) * t7 / 0.4e1 + (c22 * b12 / 0.2e1 - t132 * a12) * t25 / 0.3e1 - c22 * a12 * t6 / 0.2e1) + B33 * (t153 * b13 * t8 / 0.20e2 + (t160 * b13 / 0.2e1 - t153 * a13 / 0.2e1) * t7 / 0.4e1 + (c23 * b13 / 0.2e1 - t160 * a13) * t25 / 0.3e1 - c23 * a13 * t6 / 0.2e1);
	X(1,3) = B11 * (t182 * b11 * t8 / 0.20e2 + (t189 * b11 / 0.2e1 - t182 * a11 / 0.2e1) * t7 / 0.4e1 + (t179 - t189 * a11 + t180 / 0.2e1 + t181 / 0.2e1) * t25 / 0.3e1 + ((-2 * t186 - t187 - t188) * t6) / 0.2e1 + c31 * T) + B22 * (t212 * b12 * t8 / 0.20e2 + (t219 * b12 / 0.2e1 - t212 * a12 / 0.2e1) * t7 / 0.4e1 + (c32 * b12 / 0.2e1 - t219 * a12) * t25 / 0.3e1 - c32 * a12 * t6 / 0.2e1) + B33 * (t240 * b13 * t8 / 0.20e2 + (t247 * b13 / 0.2e1 - t240 * a13 / 0.2e1) * t7 / 0.4e1 + (c33 * b13 / 0.2e1 - t247 * a13) * t25 / 0.3e1 - c33 * a13 * t6 / 0.2e1);
	X(2,1) = B11 * (t4 * b21 * t8 / 0.20e2 + (t14 * b21 / 0.2e1 - t4 * a21 / 0.2e1) * t7 / 0.4e1 + (c11 * b21 / 0.2e1 - t14 * a21) * t25 / 0.3e1 - c11 * a21 * t6 / 0.2e1) + B22 * (t38 * b22 * t8 / 0.20e2 + (t45 * b22 / 0.2e1 - t38 * a22 / 0.2e1) * t7 / 0.4e1 + (t35 - t45 * a22 + t36 / 0.2e1 + t37 / 0.2e1) * t25 / 0.3e1 + ((-2 * t44 - t42 - t43) * t6) / 0.2e1 + c12 * T) + B33 * (t66 * b23 * t8 / 0.20e2 + (t73 * b23 / 0.2e1 - t66 * a23 / 0.2e1) * t7 / 0.4e1 + (c13 * b23 / 0.2e1 - t73 * a23) * t25 / 0.3e1 - c13 * a23 * t6 / 0.2e1);
	X(2,2) = B11 * (t95 * b21 * t8 / 0.20e2 + (t102 * b21 / 0.2e1 - t95 * a21 / 0.2e1) * t7 / 0.4e1 + (c21 * b21 / 0.2e1 - t102 * a21) * t25 / 0.3e1 - c21 * a21 * t6 / 0.2e1) + B22 * (t125 * b22 * t8 / 0.20e2 + (t132 * b22 / 0.2e1 - t125 * a22 / 0.2e1) * t7 / 0.4e1 + (t122 - t132 * a22 + t123 / 0.2e1 + t124 / 0.2e1) * t25 / 0.3e1 + ((-2 * t131 - t129 - t130) * t6) / 0.2e1 + c22 * T) + B33 * (t153 * b23 * t8 / 0.20e2 + (t160 * b23 / 0.2e1 - t153 * a23 / 0.2e1) * t7 / 0.4e1 + (c23 * b23 / 0.2e1 - t160 * a23) * t25 / 0.3e1 - c23 * a23 * t6 / 0.2e1);
	X(2,3) = B11 * (t182 * b21 * t8 / 0.20e2 + (t189 * b21 / 0.2e1 - t182 * a21 / 0.2e1) * t7 / 0.4e1 + (c31 * b21 / 0.2e1 - t189 * a21) * t25 / 0.3e1 - c31 * a21 * t6 / 0.2e1) + B22 * (t212 * b22 * t8 / 0.20e2 + (t219 * b22 / 0.2e1 - t212 * a22 / 0.2e1) * t7 / 0.4e1 + (t209 - t219 * a22 + t210 / 0.2e1 + t211 / 0.2e1) * t25 / 0.3e1 + ((-2 * t218 - t216 - t217) * t6) / 0.2e1 + c32 * T) + B33 * (t240 * b23 * t8 / 0.20e2 + (t247 * b23 / 0.2e1 - t240 * a23 / 0.2e1) * t7 / 0.4e1 + (c33 * b23 / 0.2e1 - t247 * a23) * t25 / 0.3e1 - c33 * a23 * t6 / 0.2e1);
	X(3,1) = B11 * (t4 * b31 * t8 / 0.20e2 + (t14 * b31 / 0.2e1 - t4 * a31 / 0.2e1) * t7 / 0.4e1 + (c11 * b31 / 0.2e1 - t14 * a31) * t25 / 0.3e1 - c11 * a31 * t6 / 0.2e1) + B22 * (t38 * b32 * t8 / 0.20e2 + (t45 * b32 / 0.2e1 - t38 * a32 / 0.2e1) * t7 / 0.4e1 + (c12 * b32 / 0.2e1 - t45 * a32) * t25 / 0.3e1 - c12 * a32 * t6 / 0.2e1) + B33 * (t66 * b33 * t8 / 0.20e2 + (t73 * b33 / 0.2e1 - t66 * a33 / 0.2e1) * t7 / 0.4e1 + (t65 - t73 * a33 + t63 / 0.2e1 + t64 / 0.2e1) * t25 / 0.3e1 + ((-2 * t70 - t71 - t72) * t6) / 0.2e1 + c13 * T);
	X(3,2) = B11 * (t95 * b31 * t8 / 0.20e2 + (t102 * b31 / 0.2e1 - t95 * a31 / 0.2e1) * t7 / 0.4e1 + (c21 * b31 / 0.2e1 - t102 * a31) * t25 / 0.3e1 - c21 * a31 * t6 / 0.2e1) + B22 * (t125 * b32 * t8 / 0.20e2 + (t132 * b32 / 0.2e1 - t125 * a32 / 0.2e1) * t7 / 0.4e1 + (c22 * b32 / 0.2e1 - t132 * a32) * t25 / 0.3e1 - c22 * a32 * t6 / 0.2e1) + B33 * (t153 * b33 * t8 / 0.20e2 + (t160 * b33 / 0.2e1 - t153 * a33 / 0.2e1) * t7 / 0.4e1 + (t152 - t160 * a33 + t150 / 0.2e1 + t151 / 0.2e1) * t25 / 0.3e1 + ((-2 * t157 - t158 - t159) * t6) / 0.2e1 + c23 * T);
	X(3,3) = B11 * (t182 * b31 * t8 / 0.20e2 + (t189 * b31 / 0.2e1 - t182 * a31 / 0.2e1) * t7 / 0.4e1 + (c31 * b31 / 0.2e1 - t189 * a31) * t25 / 0.3e1 - c31 * a31 * t6 / 0.2e1) + B22 * (t212 * b32 * t8 / 0.20e2 + (t219 * b32 / 0.2e1 - t212 * a32 / 0.2e1) * t7 / 0.4e1 + (c32 * b32 / 0.2e1 - t219 * a32) * t25 / 0.3e1 - c32 * a32 * t6 / 0.2e1) + B33 * (t240 * b33 * t8 / 0.20e2 + (t247 * b33 / 0.2e1 - t240 * a33 / 0.2e1) * t7 / 0.4e1 + (t239 - t247 * a33 + t237 / 0.2e1 + t238 / 0.2e1) * t25 / 0.3e1 + ((-2 * t244 - t245 - t246) * t6) / 0.2e1 + c33 * T);

elseif calc==17
	%Maple generated code: F*(diag(sig^2))*D'
	t1 = c11 * b11;
	t2 = c12 * b21;
	t3 = c13 * b31;
	t4 = -t1 - t2 - t3;
	t6 = T * T;
	t7 = t6 * t6;
	t8 = t7 * t7;
	t13 = c11 * a11;
	t14 = c12 * a21;
	t15 = c13 * a31;
	t16 = -t13 - t14 - t15;
	t21 = t7 * t6 * T;
	t30 = t7 * t6;
	t37 = t7 * T;
	t44 = c12 * b22;
	t45 = c11 * b12;
	t46 = c13 * b32;
	t47 = -t44 - t45 - t46;
	t53 = c11 * a12;
	t54 = c13 * a32;
	t55 = c12 * a22;
	t56 = -t53 - t54 - t55;
	t74 = c12 * b23;
	t75 = c11 * b13;
	t76 = c13 * b33;
	t77 = -t74 - t75 - t76;
	t83 = c13 * a33;
	t84 = c12 * a23;
	t85 = c11 * a13;
	t86 = -t83 - t84 - t85;
	t105 = c21 * b11;
	t106 = c22 * b21;
	t107 = c23 * b31;
	t108 = -t105 - t106 - t107;
	t114 = c21 * a11;
	t115 = c22 * a21;
	t116 = c23 * a31;
	t117 = -t114 - t115 - t116;
	t141 = c22 * b22;
	t142 = c21 * b12;
	t143 = c23 * b32;
	t144 = -t141 - t142 - t143;
	t150 = c21 * a12;
	t151 = c23 * a32;
	t152 = c22 * a22;
	t153 = -t150 - t151 - t152;
	t171 = c22 * b23;
	t172 = c21 * b13;
	t173 = c23 * b33;
	t174 = -t171 - t172 - t173;
	t180 = c23 * a33;
	t181 = c22 * a23;
	t182 = c21 * a13;
	t183 = -t180 - t181 - t182;
	t202 = c31 * b11;
	t203 = c32 * b21;
	t204 = c33 * b31;
	t205 = -t202 - t203 - t204;
	t211 = c31 * a11;
	t212 = c32 * a21;
	t213 = c33 * a31;
	t214 = -t211 - t212 - t213;
	t238 = c32 * b22;
	t239 = c31 * b12;
	t240 = c33 * b32;
	t241 = -t238 - t239 - t240;
	t247 = c31 * a12;
	t248 = c33 * a32;
	t249 = c32 * a22;
	t250 = -t247 - t248 - t249;
	t268 = c32 * b23;
	t269 = c31 * b13;
	t270 = c33 * b33;
	t271 = -t268 - t269 - t270;
	t277 = c33 * a33;
	t278 = c32 * a23;
	t279 = c31 * a13;
	t280 = -t277 - t278 - t279;
	X(1,1) = B11 * (-t4 * b11 * t8 / 0.1152e4 + (t4 * a11 / 0.48e2 - b11 * t16 / 0.36e2) * t21 / 0.7e1 + (-t1 / 0.24e2 + t2 / 0.24e2 + t3 / 0.24e2 + a11 * t16 / 0.12e2) * t30 / 0.6e1 + (0.5e1 / 0.12e2 * t13 + t14 / 0.6e1 + t15 / 0.6e1) * t37 / 0.5e1 - c11 * t7 / 0.8e1) + B22 * (-b12 * t47 * t8 / 0.1152e4 + (a12 * t47 / 0.48e2 - b12 * t56 / 0.36e2) * t21 / 0.7e1 + (a12 * t56 / 0.12e2 - c12 * b12 / 0.12e2) * t30 / 0.6e1 + c12 * a12 * t37 / 0.20e2) + B33 * (-b13 * t77 * t8 / 0.1152e4 + (a13 * t77 / 0.48e2 - b13 * t86 / 0.36e2) * t21 / 0.7e1 + (a13 * t86 / 0.12e2 - c13 * b13 / 0.12e2) * t30 / 0.6e1 + c13 * a13 * t37 / 0.20e2);
	X(2,3) = B11 * (-b11 * t108 * t8 / 0.1152e4 + (a11 * t108 / 0.48e2 - b11 * t117 / 0.36e2) * t21 / 0.7e1 + (-t105 / 0.24e2 + t106 / 0.24e2 + t107 / 0.24e2 + a11 * t117 / 0.12e2) * t30 / 0.6e1 + (0.5e1 / 0.12e2 * t114 + t115 / 0.6e1 + t116 / 0.6e1) * t37 / 0.5e1 - c21 * t7 / 0.8e1) + B22 * (-b12 * t144 * t8 / 0.1152e4 + (a12 * t144 / 0.48e2 - b12 * t153 / 0.36e2) * t21 / 0.7e1 + (a12 * t153 / 0.12e2 - c22 * b12 / 0.12e2) * t30 / 0.6e1 + c22 * a12 * t37 / 0.20e2) + B33 * (-b13 * t174 * t8 / 0.1152e4 + (a13 * t174 / 0.48e2 - b13 * t183 / 0.36e2) * t21 / 0.7e1 + (a13 * t183 / 0.12e2 - c23 * b13 / 0.12e2) * t30 / 0.6e1 + c23 * a13 * t37 / 0.20e2);
	X(1,3) = B11 * (-b11 * t205 * t8 / 0.1152e4 + (a11 * t205 / 0.48e2 - b11 * t214 / 0.36e2) * t21 / 0.7e1 + (-t202 / 0.24e2 + t203 / 0.24e2 + t204 / 0.24e2 + a11 * t214 / 0.12e2) * t30 / 0.6e1 + (0.5e1 / 0.12e2 * t211 + t212 / 0.6e1 + t213 / 0.6e1) * t37 / 0.5e1 - c31 * t7 / 0.8e1) + B22 * (-b12 * t241 * t8 / 0.1152e4 + (a12 * t241 / 0.48e2 - b12 * t250 / 0.36e2) * t21 / 0.7e1 + (a12 * t250 / 0.12e2 - c32 * b12 / 0.12e2) * t30 / 0.6e1 + c32 * a12 * t37 / 0.20e2) + B33 * (-b13 * t271 * t8 / 0.1152e4 + (a13 * t271 / 0.48e2 - b13 * t280 / 0.36e2) * t21 / 0.7e1 + (a13 * t280 / 0.12e2 - c33 * b13 / 0.12e2) * t30 / 0.6e1 + c33 * a13 * t37 / 0.20e2);
	X(2,1) = B11 * (-t4 * b21 * t8 / 0.1152e4 + (t4 * a21 / 0.48e2 - b21 * t16 / 0.36e2) * t21 / 0.7e1 + (a21 * t16 / 0.12e2 - c11 * b21 / 0.12e2) * t30 / 0.6e1 + c11 * a21 * t37 / 0.20e2) + B22 * (-b22 * t47 * t8 / 0.1152e4 + (a22 * t47 / 0.48e2 - b22 * t56 / 0.36e2) * t21 / 0.7e1 + (-t44 / 0.24e2 + t45 / 0.24e2 + t46 / 0.24e2 + a22 * t56 / 0.12e2) * t30 / 0.6e1 + (t53 / 0.6e1 + t54 / 0.6e1 + 0.5e1 / 0.12e2 * t55) * t37 / 0.5e1 - c12 * t7 / 0.8e1) + B33 * (-b23 * t77 * t8 / 0.1152e4 + (a23 * t77 / 0.48e2 - b23 * t86 / 0.36e2) * t21 / 0.7e1 + (a23 * t86 / 0.12e2 - c13 * b23 / 0.12e2) * t30 / 0.6e1 + c13 * a23 * t37 / 0.20e2);
	X(2,2) = B11 * (-b21 * t108 * t8 / 0.1152e4 + (a21 * t108 / 0.48e2 - b21 * t117 / 0.36e2) * t21 / 0.7e1 + (a21 * t117 / 0.12e2 - c21 * b21 / 0.12e2) * t30 / 0.6e1 + c21 * a21 * t37 / 0.20e2) + B22 * (-b22 * t144 * t8 / 0.1152e4 + (a22 * t144 / 0.48e2 - b22 * t153 / 0.36e2) * t21 / 0.7e1 + (-t141 / 0.24e2 + t142 / 0.24e2 + t143 / 0.24e2 + a22 * t153 / 0.12e2) * t30 / 0.6e1 + (t150 / 0.6e1 + t151 / 0.6e1 + 0.5e1 / 0.12e2 * t152) * t37 / 0.5e1 - c22 * t7 / 0.8e1) + B33 * (-b23 * t174 * t8 / 0.1152e4 + (a23 * t174 / 0.48e2 - b23 * t183 / 0.36e2) * t21 / 0.7e1 + (a23 * t183 / 0.12e2 - c23 * b23 / 0.12e2) * t30 / 0.6e1 + c23 * a23 * t37 / 0.20e2);
	X(2,3) = B11 * (-b21 * t205 * t8 / 0.1152e4 + (a21 * t205 / 0.48e2 - b21 * t214 / 0.36e2) * t21 / 0.7e1 + (a21 * t214 / 0.12e2 - c31 * b21 / 0.12e2) * t30 / 0.6e1 + c31 * a21 * t37 / 0.20e2) + B22 * (-b22 * t241 * t8 / 0.1152e4 + (a22 * t241 / 0.48e2 - b22 * t250 / 0.36e2) * t21 / 0.7e1 + (-t238 / 0.24e2 + t239 / 0.24e2 + t240 / 0.24e2 + a22 * t250 / 0.12e2) * t30 / 0.6e1 + (t247 / 0.6e1 + t248 / 0.6e1 + 0.5e1 / 0.12e2 * t249) * t37 / 0.5e1 - c32 * t7 / 0.8e1) + B33 * (-b23 * t271 * t8 / 0.1152e4 + (a23 * t271 / 0.48e2 - b23 * t280 / 0.36e2) * t21 / 0.7e1 + (a23 * t280 / 0.12e2 - c33 * b23 / 0.12e2) * t30 / 0.6e1 + c33 * a23 * t37 / 0.20e2);
	X(3,1) = B11 * (-t4 * b31 * t8 / 0.1152e4 + (t4 * a31 / 0.48e2 - b31 * t16 / 0.36e2) * t21 / 0.7e1 + (a31 * t16 / 0.12e2 - c11 * b31 / 0.12e2) * t30 / 0.6e1 + c11 * a31 * t37 / 0.20e2) + B22 * (-b32 * t47 * t8 / 0.1152e4 + (a32 * t47 / 0.48e2 - b32 * t56 / 0.36e2) * t21 / 0.7e1 + (a32 * t56 / 0.12e2 - c12 * b32 / 0.12e2) * t30 / 0.6e1 + c12 * a32 * t37 / 0.20e2) + B33 * (-b33 * t77 * t8 / 0.1152e4 + (a33 * t77 / 0.48e2 - b33 * t86 / 0.36e2) * t21 / 0.7e1 + (t74 / 0.24e2 + t75 / 0.24e2 - t76 / 0.24e2 + a33 * t86 / 0.12e2) * t30 / 0.6e1 + (0.5e1 / 0.12e2 * t83 + t84 / 0.6e1 + t85 / 0.6e1) * t37 / 0.5e1 - c13 * t7 / 0.8e1);
	X(3,2) = B11 * (-b31 * t108 * t8 / 0.1152e4 + (a31 * t108 / 0.48e2 - b31 * t117 / 0.36e2) * t21 / 0.7e1 + (a31 * t117 / 0.12e2 - c21 * b31 / 0.12e2) * t30 / 0.6e1 + c21 * a31 * t37 / 0.20e2) + B22 * (-b32 * t144 * t8 / 0.1152e4 + (a32 * t144 / 0.48e2 - b32 * t153 / 0.36e2) * t21 / 0.7e1 + (a32 * t153 / 0.12e2 - c22 * b32 / 0.12e2) * t30 / 0.6e1 + c22 * a32 * t37 / 0.20e2) + B33 * (-b33 * t174 * t8 / 0.1152e4 + (a33 * t174 / 0.48e2 - b33 * t183 / 0.36e2) * t21 / 0.7e1 + (t171 / 0.24e2 + t172 / 0.24e2 - t173 / 0.24e2 + a33 * t183 / 0.12e2) * t30 / 0.6e1 + (0.5e1 / 0.12e2 * t180 + t181 / 0.6e1 + t182 / 0.6e1) * t37 / 0.5e1 - c23 * t7 / 0.8e1);
	X(3,3) = B11 * (-b31 * t205 * t8 / 0.1152e4 + (a31 * t205 / 0.48e2 - b31 * t214 / 0.36e2) * t21 / 0.7e1 + (a31 * t214 / 0.12e2 - c31 * b31 / 0.12e2) * t30 / 0.6e1 + c31 * a31 * t37 / 0.20e2) + B22 * (-b32 * t241 * t8 / 0.1152e4 + (a32 * t241 / 0.48e2 - b32 * t250 / 0.36e2) * t21 / 0.7e1 + (a32 * t250 / 0.12e2 - c32 * b32 / 0.12e2) * t30 / 0.6e1 + c32 * a32 * t37 / 0.20e2) + B33 * (-b33 * t271 * t8 / 0.1152e4 + (a33 * t271 / 0.48e2 - b33 * t280 / 0.36e2) * t21 / 0.7e1 + (t268 / 0.24e2 + t269 / 0.24e2 - t270 / 0.24e2 + a33 * t280 / 0.12e2) * t30 / 0.6e1 + (0.5e1 / 0.12e2 * t277 + t278 / 0.6e1 + t279 / 0.6e1) * t37 / 0.5e1 - c33 * t7 / 0.8e1);

elseif calc==18
	%Maple generated code: E*(diag(sig^2))*E'
	t1 = b11 * b11;
	t2 = T * T;
	t3 = t2 * t2;
	t4 = t3 * T;
	t10 = a11 * a11;
	t12 = t2 * T;
	t18 = b12 * b12;
	t24 = a12 * a12;
	t29 = b13 * b13;
	t35 = a13 * a13;
	t88 = B11 * (b11 * b21 * t4 / 0.20e2 + (-a11 * b21 - b11 * a21) * t3 / 0.8e1 + (b21 / 0.2e1 + a11 * a21) * t12 / 0.3e1 - t2 * a21 / 0.2e1) + B22 * (b12 * b22 * t4 / 0.20e2 + (-a12 * b22 - b12 * a22) * t3 / 0.8e1 + (a12 * a22 + b12 / 0.2e1) * t12 / 0.3e1 - t2 * a12 / 0.2e1) + B33 * (b13 * b23 * t4 / 0.20e2 + (-a13 * b23 - b13 * a23) * t3 / 0.8e1 + a13 * a23 * t12 / 0.3e1);
	t136 = B11 * (b11 * b31 * t4 / 0.20e2 + (-a11 * b31 - b11 * a31) * t3 / 0.8e1 + (b31 / 0.2e1 + a11 * a31) * t12 / 0.3e1 - t2 * a31 / 0.2e1) + B22 * (b12 * b32 * t4 / 0.20e2 + (-a12 * b32 - b12 * a32) * t3 / 0.8e1 + a12 * a32 * t12 / 0.3e1) + B33 * (b13 * b33 * t4 / 0.20e2 + (-a13 * b33 - b13 * a33) * t3 / 0.8e1 + (a13 * a33 + b13 / 0.2e1) * t12 / 0.3e1 - t2 * a13 / 0.2e1);
	t137 = b21 * b21;
	t143 = a21 * a21;
	t148 = b22 * b22;
	t154 = a22 * a22;
	t161 = b23 * b23;
	t167 = a23 * a23;
	t220 = B11 * (b21 * b31 * t4 / 0.20e2 + (-a21 * b31 - b21 * a31) * t3 / 0.8e1 + a21 * a31 * t12 / 0.3e1) + B22 * (b22 * b32 * t4 / 0.20e2 + (-a22 * b32 - b22 * a32) * t3 / 0.8e1 + (b32 / 0.2e1 + a22 * a32) * t12 / 0.3e1 - t2 * a32 / 0.2e1) + B33 * (b23 * b33 * t4 / 0.20e2 + (-a23 * b33 - b23 * a33) * t3 / 0.8e1 + (a23 * a33 + b23 / 0.2e1) * t12 / 0.3e1 - t2 * a23 / 0.2e1);
	t221 = b31 * b31;
	t227 = a31 * a31;
	t232 = b32 * b32;
	t238 = a32 * a32;
	t243 = b33 * b33;
	t249 = a33 * a33;
	X(1,1) = B11 * (T + t1 * t4 / 0.20e2 - a11 * b11 * t3 / 0.4e1 + (b11 + t10) * t12 / 0.3e1 - t2 * a11) + B22 * (t18 * t4 / 0.20e2 - a12 * b12 * t3 / 0.4e1 + t24 * t12 / 0.3e1) + B33 * (t29 * t4 / 0.20e2 - a13 * b13 * t3 / 0.4e1 + t35 * t12 / 0.3e1);
	X(2,3) = t88;
	X(1,3) = t136;
	X(2,1) = t88;
	X(2,2) = B11 * (t137 * t4 / 0.20e2 - a21 * b21 * t3 / 0.4e1 + t143 * t12 / 0.3e1) + B22 * (T + t148 * t4 / 0.20e2 - a22 * b22 * t3 / 0.4e1 + (b22 + t154) * t12 / 0.3e1 - t2 * a22) + B33 * (t161 * t4 / 0.20e2 - a23 * b23 * t3 / 0.4e1 + t167 * t12 / 0.3e1);
	X(2,3) = t220;
	X(3,1) = t136;
	X(3,2) = t220;
	X(3,3) = B11 * (t221 * t4 / 0.20e2 - a31 * b31 * t3 / 0.4e1 + t227 * t12 / 0.3e1) + B22 * (t232 * t4 / 0.20e2 - a32 * b32 * t3 / 0.4e1 + t238 * t12 / 0.3e1) + B33 * (T + t243 * t4 / 0.20e2 - a33 * b33 * t3 / 0.4e1 + (b33 + t249) * t12 / 0.3e1 - t2 * a33);

elseif calc==19
	%Maple generated code: F*(diag(sig^2))*F'
	t1 = b11 * b11;
	t2 = T * T;
	t3 = t2 * T;
	t4 = t2 * t2;
	t5 = t4 * t3;
	t9 = t4 * t2;
	t13 = a11 * a11;
	t16 = t4 * T;
	t21 = t3 / 0.3e1;
	t24 = b12 * b12;
	t30 = a12 * a12;
	t35 = b13 * b13;
	t41 = a13 * a13;
	t96 = B11 * (b11 * b21 * t5 / 0.252e3 + (-a11 * b21 - b11 * a21) * t9 / 0.72e2 + (b21 / 0.6e1 + a11 * a21 / 0.4e1) * t16 / 0.5e1 - t4 * a21 / 0.8e1) + B22 * (b12 * b22 * t5 / 0.252e3 + (-a12 * b22 - b12 * a22) * t9 / 0.72e2 + (a12 * a22 / 0.4e1 + b12 / 0.6e1) * t16 / 0.5e1 - t4 * a12 / 0.8e1) + B33 * (b13 * b23 * t5 / 0.252e3 + (-a13 * b23 - b13 * a23) * t9 / 0.72e2 + a13 * a23 * t16 / 0.20e2);
	t146 = B11 * (b11 * b31 * t5 / 0.252e3 + (-a11 * b31 - b11 * a31) * t9 / 0.72e2 + (b31 / 0.6e1 + a11 * a31 / 0.4e1) * t16 / 0.5e1 - t4 * a31 / 0.8e1) + B22 * (b12 * b32 * t5 / 0.252e3 + (-a12 * b32 - b12 * a32) * t9 / 0.72e2 + a12 * a32 * t16 / 0.20e2) + B33 * (b13 * b33 * t5 / 0.252e3 + (-a13 * b33 - b13 * a33) * t9 / 0.72e2 + (a13 * a33 / 0.4e1 + b13 / 0.6e1) * t16 / 0.5e1 - t4 * a13 / 0.8e1);
	t147 = b21 * b21;
	t153 = a21 * a21;
	t158 = b22 * b22;
	t165 = a22 * a22;
	t174 = b23 * b23;
	t180 = a23 * a23;
	t235 = B11 * (b21 * b31 * t5 / 0.252e3 + (-a21 * b31 - b21 * a31) * t9 / 0.72e2 + a21 * a31 * t16 / 0.20e2) + B22 * (b22 * b32 * t5 / 0.252e3 + (-a22 * b32 - b22 * a32) * t9 / 0.72e2 + (b32 / 0.6e1 + a22 * a32 / 0.4e1) * t16 / 0.5e1 - t4 * a32 / 0.8e1) + B33 * (b23 * b33 * t5 / 0.252e3 + (-a23 * b33 - b23 * a33) * t9 / 0.72e2 + (a23 * a33 / 0.4e1 + b23 / 0.6e1) * t16 / 0.5e1 - t4 * a23 / 0.8e1);
	t236 = b31 * b31;
	t242 = a31 * a31;
	t247 = b32 * b32;
	t253 = a32 * a32;
	t258 = b33 * b33;
	t265 = a33 * a33;
	X(1,1) = B11 * (t1 * t5 / 0.252e3 - a11 * b11 * t9 / 0.36e2 + (b11 / 0.3e1 + t13 / 0.4e1) * t16 / 0.5e1 - t4 * a11 / 0.4e1 + t21) + B22 * (t24 * t5 / 0.252e3 - a12 * b12 * t9 / 0.36e2 + t30 * t16 / 0.20e2) + B33 * (t35 * t5 / 0.252e3 - a13 * b13 * t9 / 0.36e2 + t41 * t16 / 0.20e2);
	X(2,3) = t96;
	X(1,3) = t146;
	X(2,1) = t96;
	X(2,2) = B11 * (t147 * t5 / 0.252e3 - a21 * b21 * t9 / 0.36e2 + t153 * t16 / 0.20e2) + B22 * (t158 * t5 / 0.252e3 - a22 * b22 * t9 / 0.36e2 + (b22 / 0.3e1 + t165 / 0.4e1) * t16 / 0.5e1 - t4 * a22 / 0.4e1 + t21) + B33 * (t174 * t5 / 0.252e3 - a23 * b23 * t9 / 0.36e2 + t180 * t16 / 0.20e2);
	X(2,3) = t235;
	X(3,1) = t146;
	X(3,2) = t235;
	X(3,3) = B11 * (t236 * t5 / 0.252e3 - a31 * b31 * t9 / 0.36e2 + t242 * t16 / 0.20e2) + B22 * (t247 * t5 / 0.252e3 - a32 * b32 * t9 / 0.36e2 + t253 * t16 / 0.20e2) + B33 * (t258 * t5 / 0.252e3 - a33 * b33 * t9 / 0.36e2 + (b33 / 0.3e1 + t265 / 0.4e1) * t16 / 0.5e1 - t4 * a33 / 0.4e1 + t21);

elseif calc==20
	%Maple generated code: F*(diag(sig^2))*Id'
	t1 = T * T;
	t2 = t1 / 0.2e1;
	t3 = t1 * T;
	t6 = t1 * t1;
	X(1,1) = B11 * (-t2 + t3 * a11 / 0.6e1 - t6 * b11 / 0.24e2);
	X(2,3) = B22 * (t3 * a12 / 0.6e1 - t6 * b12 / 0.24e2);
	X(1,3) = B33 * (t3 * a13 / 0.6e1 - t6 * b13 / 0.24e2);
	X(2,1) = B11 * (t3 * a21 / 0.6e1 - t6 * b21 / 0.24e2);
	X(2,2) = B22 * (-t2 + t3 * a22 / 0.6e1 - t6 * b22 / 0.24e2);
	X(2,3) = B33 * (t3 * a23 / 0.6e1 - t6 * b23 / 0.24e2);
	X(3,1) = B11 * (t3 * a31 / 0.6e1 - t6 * b31 / 0.24e2);
	X(3,2) = B22 * (t3 * a32 / 0.6e1 - t6 * b32 / 0.24e2);
	X(3,3) = B33 * (-t2 + t3 * a33 / 0.6e1 - t6 * b33 / 0.24e2);

elseif calc==21
	%Maple generated code: Id*(diag(sig^2))*B'
	t1 = T * T;
	t2 = t1 * t1;
	t3 = t2 / 0.24e2;
	t4 = t2 * T;
	t7 = t2 * t1;
	t10 = -t3 - t4 * a11 / 0.120e3 + t7 * b11 / 0.720e3;
	t16 = -t4 * a21 / 0.120e3 + t7 * b21 / 0.720e3;
	t22 = -t4 * a31 / 0.120e3 + t7 * b31 / 0.720e3;
	t40 = -t4 * a12 / 0.120e3 + t7 * b12 / 0.720e3;
	t46 = -t3 - t4 * a22 / 0.120e3 + t7 * b22 / 0.720e3;
	t52 = -t4 * a32 / 0.120e3 + t7 * b32 / 0.720e3;
	t70 = -t4 * a13 / 0.120e3 + t7 * b13 / 0.720e3;
	t76 = -t4 * a23 / 0.120e3 + t7 * b23 / 0.720e3;
	t82 = -t3 - t4 * a33 / 0.120e3 + t7 * b33 / 0.720e3;
	X(1,1) = B11 * (c11 * t10 + c12 * t16 + c13 * t22);
	X(2,3) = B11 * (c21 * t10 + c22 * t16 + c23 * t22);
	X(1,3) = B11 * (c31 * t10 + c32 * t16 + c33 * t22);
	X(2,1) = B22 * (c11 * t40 + c12 * t46 + c13 * t52);
	X(2,2) = B22 * (c21 * t40 + c22 * t46 + c23 * t52);
	X(2,3) = B22 * (c31 * t40 + c32 * t46 + c33 * t52);
	X(3,1) = B33 * (c11 * t70 + c12 * t76 + c13 * t82);
	X(3,2) = B33 * (c21 * t70 + c22 * t76 + c23 * t82);
	X(3,3) = B33 * (c31 * t70 + c32 * t76 + c33 * t82);

elseif calc==22
	%Maple generated code: Id*(diag(sig^2))*D'
	t1 = T * T;
	t3 = t1 * T / 0.6e1;
	t4 = t1 * t1;
	t7 = t4 * T;
	t10 = -t3 + t4 * a11 / 0.24e2 + t7 * b11 / 0.120e3;
	t16 = t4 * a21 / 0.24e2 + t7 * b21 / 0.120e3;
	t22 = t4 * a31 / 0.24e2 + t7 * b31 / 0.120e3;
	t40 = t4 * a12 / 0.24e2 + t7 * b12 / 0.120e3;
	t46 = -t3 + t4 * a22 / 0.24e2 + t7 * b22 / 0.120e3;
	t52 = t4 * a32 / 0.24e2 + t7 * b32 / 0.120e3;
	t70 = t4 * a13 / 0.24e2 + t7 * b13 / 0.120e3;
	t76 = t4 * a23 / 0.24e2 + t7 * b23 / 0.120e3;
	t82 = -t3 + t4 * a33 / 0.24e2 + t7 * b33 / 0.120e3;
	X(1,1) = B11 * (-c11 * t10 - c12 * t16 - c13 * t22);
	X(2,3) = B11 * (-c21 * t10 - c22 * t16 - c23 * t22);
	X(1,3) = B11 * (-c31 * t10 - c32 * t16 - c33 * t22);
	X(2,1) = B22 * (-c11 * t40 - c12 * t46 - c13 * t52);
	X(2,2) = B22 * (-c21 * t40 - c22 * t46 - c23 * t52);
	X(2,3) = B22 * (-c31 * t40 - c32 * t46 - c33 * t52);
	X(3,1) = B33 * (-c11 * t70 - c12 * t76 - c13 * t82);
	X(3,2) = B33 * (-c21 * t70 - c22 * t76 - c23 * t82);
	X(3,3) = B33 * (-c31 * t70 - c32 * t76 - c33 * t82);

elseif calc==23
	%Maple generated code: Id*(diag(sig^2))*F'
	t1 = T * T;
	t2 = t1 / 0.2e1;
	t3 = t1 * T;
	t6 = t1 * t1;
	X(1,1) = B11 * (-t2 + t3 * a11 / 0.6e1 - t6 * b11 / 0.24e2);
	X(2,3) = B11 * (t3 * a21 / 0.6e1 - t6 * b21 / 0.24e2);
	X(1,3) = B11 * (t3 * a31 / 0.6e1 - t6 * b31 / 0.24e2);
	X(2,1) = B22 * (t3 * a12 / 0.6e1 - t6 * b12 / 0.24e2);
	X(2,2) = B22 * (-t2 + t3 * a22 / 0.6e1 - t6 * b22 / 0.24e2);
	X(2,3) = B22 * (t3 * a32 / 0.6e1 - t6 * b32 / 0.24e2);
	X(3,1) = B33 * (t3 * a13 / 0.6e1 - t6 * b13 / 0.24e2);
	X(3,2) = B33 * (t3 * a23 / 0.6e1 - t6 * b23 / 0.24e2);
	X(3,3) = B33 * (-t2 + t3 * a33 / 0.6e1 - t6 * b33 / 0.24e2);
end

E=X;
		

